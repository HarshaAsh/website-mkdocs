<!doctype html><html lang=en class=no-js> <head><!-- Code from google optimiser --><script src="https://www.googleoptimize.com/optimize.js?id=OPT-M98W6LW"></script><!-- Code from Mouseflow --><script type=text/javascript>
      window._mfq = window._mfq || [];
      (function() {
        var mf = document.createElement("script");
        mf.type = "text/javascript"; mf.defer = true;
        mf.src = "//cdn.mouseflow.com/projects/7b4494c9-7974-49f0-9777-d14450db37e6.js";
        document.getElementsByTagName("head")[0].appendChild(mf);
      })();
    </script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Harsha's notes on data science"><meta name=author content="Harsha Achyuthuni"><link href=https://www.harshaash.com/R/CART-Classification/ rel=canonical><link rel=icon href=../../assets/images/logo.jpg><meta name=generator content="mkdocs-1.5.0, mkdocs-material-7.2.4"><title>CART - Data Science with Harsha</title><link rel=stylesheet href=../../assets/stylesheets/main.f7f47774.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../overrides/assets/stylesheets/user_defined.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-65034507-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#decision-trees class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science with Harsha" class="md-header__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science with Harsha </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CART </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_1> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_3> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_4> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science with Harsha" class="md-nav__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> Data Science with Harsha </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../resume/ class=md-nav__link> Resume </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Blog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Table_of_Contents/ class=md-nav__link> Table of Contents </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Visualization <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Visualization data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Vizualisation%20using%20python%20Part%201/ class=md-nav__link> Vizualizing tabular data (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Visualization%20for%20predictive%20analytics/ class=md-nav__link> Vizualising for predictive analytics (Python) </a> </li> <li class=md-nav__item> <a href=../Univariate-analysis/ class=md-nav__link> Univariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../multivariateAnalysis/ class=md-nav__link> Multivariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../multicollinearity/ class=md-nav__link> Multicollinearity (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Statistics basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Statistics basics" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Statistics basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Probability/ class=md-nav__link> Probability (R) </a> </li> <li class=md-nav__item> <a href=../vectors/ class=md-nav__link> Vectors (R) </a> </li> <li class=md-nav__item> <a href=../matrices/ class=md-nav__link> Matrices (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Hypothesis Testing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hypothesis Testing" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Hypothesis Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../attendance_t_test/ class=md-nav__link> z-test and t-test (R) </a> </li> <li class=md-nav__item> <a href=../anova/ class=md-nav__link> ANOVA Test (R) </a> </li> <li class=md-nav__item> <a href=../chi-sq-goodness-of-fit/ class=md-nav__link> Chi-Square Goodness of fit (R) </a> </li> <li class=md-nav__item> <a href=../chi-sq-test-of-independence/ class=md-nav__link> Chi-Square test of independence (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Factor Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Factor Analysis" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Factor Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Curse-of-Dimensionality/ class=md-nav__link> Curse of dimensionality </a> </li> <li class=md-nav__item> <a href=../EFA/ class=md-nav__link> Exploratory factor analysis (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6 checked> <label class=md-nav__link for=__nav_3_6> Prediction algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prediction algorithms" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Prediction algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6_1 type=checkbox id=__nav_3_6_1 checked> <label class=md-nav__link for=__nav_3_6_1> Classification Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Classification Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_6_1> <span class="md-nav__icon md-icon"></span> Classification Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../logistic-regression/ class=md-nav__link> Logistic Regression (R) </a> </li> <li class=md-nav__item> <a href=../CHAID/ class=md-nav__link> CHAID Decision Trees (R) </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> CART Classification (R) <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> CART Classification (R) </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#decision-trees class=md-nav__link> Decision Trees </a> </li> <li class=md-nav__item> <a href=#cart-classification class=md-nav__link> CART Classification </a> <nav class=md-nav aria-label="CART Classification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-start-with-complete-data class=md-nav__link> Step 1: Start with complete data </a> </li> <li class=md-nav__item> <a href=#step-2-decide-on-a-splitting-criterion class=md-nav__link> Step 2: Decide on a splitting criterion </a> <nav class=md-nav aria-label="Step 2: Decide on a splitting criterion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gini-index class=md-nav__link> Gini Index </a> </li> <li class=md-nav__item> <a href=#entropy class=md-nav__link> Entropy </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-split-the-data-into-two-or-more-subsets-based-on-the-above-metric class=md-nav__link> Step 3. Split the data into two or more subsets based on the above metric </a> <nav class=md-nav aria-label="Step 3. Split the data into two or more subsets based on the above metric"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gender class=md-nav__link> Gender: </a> </li> <li class=md-nav__item> <a href=#passenger-class class=md-nav__link> Passenger class </a> </li> <li class=md-nav__item> <a href=#number-of-siblings class=md-nav__link> Number of siblings </a> </li> <li class=md-nav__item> <a href=#number-of-parentschildren class=md-nav__link> Number of parents/children </a> </li> <li class=md-nav__item> <a href=#embarked-location class=md-nav__link> Embarked location </a> </li> <li class=md-nav__item> <a href=#age class=md-nav__link> Age </a> </li> <li class=md-nav__item> <a href=#fare class=md-nav__link> Fare </a> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> Conclusion </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-4-repeat-step-3-until-stopping-criterion class=md-nav__link> Step 4: Repeat step 3 until stopping criterion </a> </li> <li class=md-nav__item> <a href=#step-5-making-business-rules class=md-nav__link> Step 5: Making business rules </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6_2 type=checkbox id=__nav_3_6_2> <label class=md-nav__link for=__nav_3_6_2> Regression Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Regression Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_6_2> <span class="md-nav__icon md-icon"></span> Regression Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../part-and-partial-corr/ class=md-nav__link> Part and partial correlation </a> </li> <li class=md-nav__item> <a href=../Linear-regression/ class=md-nav__link> Linear Regression (R) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Preprocessing data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preprocessing data" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Preprocessing data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../KNN_Imputation/ class=md-nav__link> Null Value Imputation (R) </a> </li> <li class=md-nav__item> <a href=../../Python/Machine%20Learning%20Part%201/ class=md-nav__link> Feature engineering (Python) </a> </li> <li class=md-nav__item> <a href=../Handling-Imbalanced-classes/ class=md-nav__link> Handling Imbalanced Classes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Machine Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Machine Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://harshaachyuthuni.shinyapps.io/Machine_Learning/ class=md-nav__link> Interactive Machine Learning (RShiny) </a> </li> <li class=md-nav__item> <a href=../../Python/ML%20using%20scikit-learn/ class=md-nav__link> ML using scikit-learn (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Demonstrating%20online%20learning/ class=md-nav__link> Streaming Machine Learning (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Time Series forecasting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Time Series forecasting" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Time Series forecasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../time-series/ class=md-nav__link> Introduction to stationarity (R) </a> </li> <li class=md-nav__item> <a href=../Stationarity-tests/ class=md-nav__link> Stationary Tests (R) </a> </li> <li class=md-nav__item> <a href=../ARIMA/ class=md-nav__link> ARIMA in R </a> </li> <li class=md-nav__item> <a href=../../Python/ARIMA%20Forecasting/ class=md-nav__link> ARIMA in Python </a> </li> <li class=md-nav__item> <a href=../Seasonal-Time-Series/ class=md-nav__link> Seasonal time series (R) </a> </li> <li class=md-nav__item> <a href=../VAR-models/ class=md-nav__link> VAR Models (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Deep learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deep learning" data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Deep learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/ANN-1/ class=md-nav__link> Perceptron </a> </li> <li class=md-nav__item> <a href=../../Python/Backpropagation/ class=md-nav__link> Backpropagation </a> </li> <li class=md-nav__item> <a href=../../Python/DNN/ class=md-nav__link> Tensorflow and Keras </a> </li> <li class=md-nav__item> <a href=../../Python/Time%20series%20deep%20learning/ class=md-nav__link> Time series (python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_11 type=checkbox id=__nav_3_11> <label class=md-nav__link for=__nav_3_11> Generative AI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Generative AI" data-md-level=2> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> Generative AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/LLM%20Tokenizers/ class=md-nav__link> LLM Tokenizers </a> </li> <li class=md-nav__item> <a href=../../Python/Agentic%20AI/ class=md-nav__link> Agentic AI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_12 type=checkbox id=__nav_3_12> <label class=md-nav__link for=__nav_3_12> Prescriptive Analytics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prescriptive Analytics" data-md-level=2> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Prescriptive Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Linear-programming/ class=md-nav__link> Linear Programming (R) </a> </li> <li class=md-nav__item> <a href=../adoption_of_new_product/ class=md-nav__link> Adoption of new product (R) </a> </li> <li class=md-nav__item> <a href=../../Python/Diffusion%20on%20networks/ class=md-nav__link> Bass Forecasting model (Python) </a> </li> <li class=md-nav__item> <a href=../../Others/AHP/ class=md-nav__link> Analytic Hierarchy Process </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_13 type=checkbox id=__nav_3_13> <label class=md-nav__link for=__nav_3_13> Clustering <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Clustering data-md-level=2> <label class=md-nav__title for=__nav_3_13> <span class="md-nav__icon md-icon"></span> Clustering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../hierarchical_clustering/ class=md-nav__link> Hierarchical Clustering </a> </li> <li class=md-nav__item> <a href=../kMeansClustering/ class=md-nav__link> K-Means Clustering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_14 type=checkbox id=__nav_3_14> <label class=md-nav__link for=__nav_3_14> Reinforcement Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reinforcement Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_14> <span class="md-nav__icon md-icon"></span> Reinforcement Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../CustomerLifetimeValue/ class=md-nav__link> Customer Lifetime Value </a> </li> <li class=md-nav__item> <a href=../recommendation-systems/ class=md-nav__link> Recommendation Systems (R) </a> </li> <li class=md-nav__item> <a href=../../Python/Neural_collaborative_filtering/ class=md-nav__link> Collaborative Filtering (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_15 type=checkbox id=__nav_3_15> <label class=md-nav__link for=__nav_3_15> Networks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networks data-md-level=2> <label class=md-nav__title for=__nav_3_15> <span class="md-nav__icon md-icon"></span> Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Introduction%20to%20Networkx/ class=md-nav__link> Introduction to NetworkX (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Network%20Science/ class=md-nav__link> Network Science (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Network%20centrality/ class=md-nav__link> Network Centrality (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Shortest%20path%20problems/ class=md-nav__link> Shortest path using integer programming (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Network%20Flow%20problems/ class=md-nav__link> Network flow problems (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Community%20detection/ class=md-nav__link> Community detection (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Bipartite%20matching/ class=md-nav__link> Bipartite matching (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_16 type=checkbox id=__nav_3_16> <label class=md-nav__link for=__nav_3_16> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=2> <label class=md-nav__title for=__nav_3_16> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Machine%20learning%20as%20HTTP%20Request/ class=md-nav__link> ML deployment in Flask (Python) </a> </li> <li class=md-nav__item> <a href=../../Python/Saving%20predictions%20in%20database/ class=md-nav__link> Handling databases using python </a> </li> <li class=md-nav__item> <a href=../../Python/ORM/ class=md-nav__link> ORM (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_17 type=checkbox id=__nav_3_17> <label class=md-nav__link for=__nav_3_17> Higher education review <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Higher education review" data-md-level=2> <label class=md-nav__title for=__nav_3_17> <span class="md-nav__icon md-icon"></span> Higher education review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/IIMB%20BAI/ class=md-nav__link> IIMB BAI </a> </li> <li class=md-nav__item> <a href=../../Others/part%20time%20data%20science%20masters/ class=md-nav__link> Part-time DS masters </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_18 type=checkbox id=__nav_3_18> <label class=md-nav__link for=__nav_3_18> External blogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="External blogs" data-md-level=2> <label class=md-nav__title for=__nav_3_18> <span class="md-nav__icon md-icon"></span> External blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Imperial%20College%20London/ class=md-nav__link> Imperial college London </a> </li> <li class=md-nav__item> <a href=../../Others/Rolls%20Royce/ class=md-nav__link> Rolls Royce </a> </li> <li class=md-nav__item> <a href=../../Others/Publications/ class=md-nav__link> Publications/conferences </a> </li> <li class=md-nav__item> <a href=../../Others/Deployed%20apps/ class=md-nav__link> Deployed apps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_19 type=checkbox id=__nav_3_19> <label class=md-nav__link for=__nav_3_19> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=__nav_3_19> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/preventive_maintainence/ class=md-nav__link> Preventive maintainence </a> </li> <li class=md-nav__item> <a href=../../Others/competitor%20intelligence/ class=md-nav__link> Competitor intelligence </a> </li> <li class=md-nav__item> <a href=../../Others/Scarecrow/ class=md-nav__link> Intelligent annotation </a> </li> <li class=md-nav__item> <a href=../../Others/bid%20allocation%20model/ class=md-nav__link> Bid Allocation </a> </li> <li class=md-nav__item> <a href=../../Others/IIMB%20project/ class=md-nav__link> Reward and Recognition contests </a> </li> <li class=md-nav__item> <a href=../../Others/supply%20chain%20analytics/ class=md-nav__link> Supply chain analytics </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#decision-trees class=md-nav__link> Decision Trees </a> </li> <li class=md-nav__item> <a href=#cart-classification class=md-nav__link> CART Classification </a> <nav class=md-nav aria-label="CART Classification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-start-with-complete-data class=md-nav__link> Step 1: Start with complete data </a> </li> <li class=md-nav__item> <a href=#step-2-decide-on-a-splitting-criterion class=md-nav__link> Step 2: Decide on a splitting criterion </a> <nav class=md-nav aria-label="Step 2: Decide on a splitting criterion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gini-index class=md-nav__link> Gini Index </a> </li> <li class=md-nav__item> <a href=#entropy class=md-nav__link> Entropy </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-split-the-data-into-two-or-more-subsets-based-on-the-above-metric class=md-nav__link> Step 3. Split the data into two or more subsets based on the above metric </a> <nav class=md-nav aria-label="Step 3. Split the data into two or more subsets based on the above metric"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gender class=md-nav__link> Gender: </a> </li> <li class=md-nav__item> <a href=#passenger-class class=md-nav__link> Passenger class </a> </li> <li class=md-nav__item> <a href=#number-of-siblings class=md-nav__link> Number of siblings </a> </li> <li class=md-nav__item> <a href=#number-of-parentschildren class=md-nav__link> Number of parents/children </a> </li> <li class=md-nav__item> <a href=#embarked-location class=md-nav__link> Embarked location </a> </li> <li class=md-nav__item> <a href=#age class=md-nav__link> Age </a> </li> <li class=md-nav__item> <a href=#fare class=md-nav__link> Fare </a> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> Conclusion </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-4-repeat-step-3-until-stopping-criterion class=md-nav__link> Step 4: Repeat step 3 until stopping criterion </a> </li> <li class=md-nav__item> <a href=#step-5-making-business-rules class=md-nav__link> Step 5: Making business rules </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>CART Classification (R)</h1> <script type=text/javascript src=https://cdn.mathjax.org/mathjax/latest/MathJax.js>
MathJax.Hub.Config({
 extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
 jax: ["input/TeX", "output/HTML-CSS"],
 tex2jax: {
     inlineMath: [ ['$','$'], ["\\(","\\)"] ],
     displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
 },
 "HTML-CSS": { availableFonts: ["TeX"] }
});
</script> <h2 id=decision-trees>Decision Trees<a class=headerlink href=#decision-trees title="Permanent link">&para;</a></h2> <p>Decision trees are a collection of predictive analytic techniques that use tree-like graphs for predicting the response variable. One such method is CHAID explained in a previous <a href=../CHAID/ >blog</a>. The most popular decision tree method is the CART or the Classification and regression trees. Decision trees partition the data set into mutually exclusive and exhaustive subsets, which results in the splitting of the original data resembling a tree-like structure.</p> <h2 id=cart-classification>CART Classification<a class=headerlink href=#cart-classification title="Permanent link">&para;</a></h2> <p>We can use the CART method for regression and classification. In this blog, I will go through the CART classification in detail using the titanic example. Any decision tree model consists of 5 steps:<br> 1. Start with the complete training data in the root node.<br> 2. Decide on a splitting criterion<br> 3. Split the data into two or more subsets based on the above metric<br> 4. Using independent variables, repeat step 3 for each of the subsets of the data until<br> --(a) All the dependent variables are exhausted, or they are not statistically significant at alpha<br> --(b) We meet the stopping criteria<br> 5. Generate business rules for the terminal nodes (nodes without any branches) of the tree </p> <h3 id=step-1-start-with-complete-data>Step 1: Start with complete data<a class=headerlink href=#step-1-start-with-complete-data title="Permanent link">&para;</a></h3> <p>The data used in this blog is the same as the used in other classification posts, i.e. the Titanic <a href=https://www.kaggle.com/c/titanic/overview>dataset</a> from Kaggle. In this problem, we have to identify what types of people had a higher chance of survival. A sample of the data is shown below. A basic EDA is performed in the blog on <a href=../logistic-regression/ >Logistic regression</a>.</p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Titanic dataset</caption> <thead> <tr> <th style=text-align:left;> Survived </th> <th style=text-align:left;> Pclass </th> <th style=text-align:left;> Sex </th> <th style=text-align:right;> Age </th> <th style=text-align:left;> SibSp </th> <th style=text-align:left;> Parch </th> <th style=text-align:right;> Fare </th> <th style=text-align:left;> Embarked </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> I </td> <td style=text-align:left;> 3 </td> <td style=text-align:left;> female </td> <td style=text-align:right;> 14 </td> <td style=text-align:left;> 1 </td> <td style=text-align:left;> 0 </td> <td style=text-align:right;> 11.2417 </td> <td style=text-align:left;> C </td> </tr> <tr> <td style=text-align:left;> O </td> <td style=text-align:left;> 2 </td> <td style=text-align:left;> male </td> <td style=text-align:right;> 21 </td> <td style=text-align:left;> 1 </td> <td style=text-align:left;> 0 </td> <td style=text-align:right;> 11.5000 </td> <td style=text-align:left;> S </td> </tr> <tr> <td style=text-align:left;> I </td> <td style=text-align:left;> 2 </td> <td style=text-align:left;> female </td> <td style=text-align:right;> 24 </td> <td style=text-align:left;> 0 </td> <td style=text-align:left;> 2 </td> <td style=text-align:right;> 14.5000 </td> <td style=text-align:left;> S </td> </tr> <tr> <td style=text-align:left;> I </td> <td style=text-align:left;> 2 </td> <td style=text-align:left;> female </td> <td style=text-align:right;> 29 </td> <td style=text-align:left;> 0 </td> <td style=text-align:left;> 0 </td> <td style=text-align:right;> 10.5000 </td> <td style=text-align:left;> S </td> </tr> <tr> <td style=text-align:left;> O </td> <td style=text-align:left;> 1 </td> <td style=text-align:left;> male </td> <td style=text-align:right;> 27 </td> <td style=text-align:left;> 0 </td> <td style=text-align:left;> 2 </td> <td style=text-align:right;> 211.5000 </td> <td style=text-align:left;> C </td> </tr> </tbody> </table></div> <h3 id=step-2-decide-on-a-splitting-criterion>Step 2: Decide on a splitting criterion<a class=headerlink href=#step-2-decide-on-a-splitting-criterion title="Permanent link">&para;</a></h3> <p>In CHAID bases classification, we used p-value from hypothesis tests as the splitting criterion. In CART, we will use impurity metrics like Gini Index and Entropy. </p> <h4 id=gini-index>Gini Index<a class=headerlink href=#gini-index title="Permanent link">&para;</a></h4> <p>It is defined mathematically as: $$ Gini\,Index = \sum_{i=1}^k \sum_{j=1,i\neq 1}^k P(C_i|t)\times P(C_j|t)$$ where <span class=arithmatex>\(P(C_i|t)\)</span> = Proportion of observations belonging to class <span class=arithmatex>\(C_i\)</span> in node t. For a binary classification, </p> <div class=arithmatex>\[ Gini\,Index = 1 - \sum_{i=1}^k P(C_i|t)^2\]</div> <p>Gini Index is a measure of total variance across the classes. It has a small value if all the <span class=arithmatex>\(P(C_i|t)\)</span> are close to zero or one. For this reason, the Gini index is a measure of node purity. A small value indicates that a node contains observations from a single class predominantly.</p> <h4 id=entropy>Entropy<a class=headerlink href=#entropy title="Permanent link">&para;</a></h4> <p>An alternative to the Gini index is entropy, given by entropy: $$ Entropy = - \sum_{i=1}^k P(C_i|t)\times log[P(C_i|t]$$ Like the Gini index, the entropy is a small value if the node is pure. The Gini index and the entropy are quite similar numerically.</p> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-1-1.png><!-- --></p> <p>For this blog, I want to consider the Gini index as my impurity measure. The aim is to minimise the Gini Index as much as possible. </p> <h3 id=step-3-split-the-data-into-two-or-more-subsets-based-on-the-above-metric>Step 3. Split the data into two or more subsets based on the above metric<a class=headerlink href=#step-3-split-the-data-into-two-or-more-subsets-based-on-the-above-metric title="Permanent link">&para;</a></h3> <p>The Gini impurity in the base node (complete data) is </p> <div class=highlight><pre><span></span><code>## [1] 0.472365
</code></pre></div> <p>The impurity of the overall data is 0.47. Let us look at the purity if we split the data based on various features. </p> <h4 id=gender>Gender:<a class=headerlink href=#gender title="Permanent link">&para;</a></h4> <p>If we split based on gender, the male and female branches individually have lower impurity (Gini index) than the base node. I have built the decision tree as the total weighted Gini index after splitting is lesser than the Gini index of the overall data. </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Gender</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> female </td> <td style=text-align:right;> 231 </td> <td style=text-align:right;> 81 </td> <td style=text-align:right;> 0.3509561 </td> <td style=text-align:right;> 0.3844305 </td> </tr> <tr> <td style=text-align:left;> male </td> <td style=text-align:right;> 109 </td> <td style=text-align:right;> 468 </td> <td style=text-align:right;> 0.6490439 </td> <td style=text-align:right;> 0.3064437 </td> </tr> </tbody> </table></div> <div class=highlight><pre><span></span><code>## [1] &quot;The total weighted impurity after the split is: 0.3338&quot;
</code></pre></div> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-3-1.png><!-- --></p> <h4 id=passenger-class>Passenger class<a class=headerlink href=#passenger-class title="Permanent link">&para;</a></h4> <p>Similarly, for passenger class, the three categories (if we split into three branches) have an impurity as follows: </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Passenger Class</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> 1 </td> <td style=text-align:right;> 134 </td> <td style=text-align:right;> 80 </td> <td style=text-align:right;> 0.2407199 </td> <td style=text-align:right;> 0.4681632 </td> </tr> <tr> <td style=text-align:left;> 2 </td> <td style=text-align:right;> 87 </td> <td style=text-align:right;> 97 </td> <td style=text-align:right;> 0.2069741 </td> <td style=text-align:right;> 0.4985232 </td> </tr> <tr> <td style=text-align:left;> 3 </td> <td style=text-align:right;> 119 </td> <td style=text-align:right;> 372 </td> <td style=text-align:right;> 0.5523060 </td> <td style=text-align:right;> 0.3672459 </td> </tr> </tbody> </table></div> <p>In CART, we can split the data into two branches only. By combining passenger class 1 and passenger class 2 into one category, we will have the below Gini impurities. I have built the decision tree as the total weighted Gini index after splitting is lesser than the Gini index of the overall data. </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Passenger Class</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> 3rd Class </td> <td style=text-align:right;> 119 </td> <td style=text-align:right;> 372 </td> <td style=text-align:right;> 0.552306 </td> <td style=text-align:right;> 0.3672459 </td> </tr> <tr> <td style=text-align:left;> First and second Class </td> <td style=text-align:right;> 221 </td> <td style=text-align:right;> 177 </td> <td style=text-align:right;> 0.447694 </td> <td style=text-align:right;> 0.4938890 </td> </tr> </tbody> </table></div> <div class=highlight><pre><span></span><code>## [1] &quot;The total weighted impurity after the split is: 0.423943259996532&quot;
</code></pre></div> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-5-1.png><!-- --></p> <h4 id=number-of-siblings>Number of siblings<a class=headerlink href=#number-of-siblings title="Permanent link">&para;</a></h4> <p>The number of siblings is a categorical variable in this problem as the probability of survival is not linearly dependent on the number of siblings. According to intuition, people with one or two siblings will have a higher rate of survival as they will take care of each other. The impurity for each class is: </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>No of siblings</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> 0 </td> <td style=text-align:right;> 208 </td> <td style=text-align:right;> 398 </td> <td style=text-align:right;> 0.6816648 </td> <td style=text-align:right;> 0.4508490 </td> </tr> <tr> <td style=text-align:left;> 1 </td> <td style=text-align:right;> 112 </td> <td style=text-align:right;> 97 </td> <td style=text-align:right;> 0.2350956 </td> <td style=text-align:right;> 0.4974245 </td> </tr> <tr> <td style=text-align:left;> 2 </td> <td style=text-align:right;> 13 </td> <td style=text-align:right;> 15 </td> <td style=text-align:right;> 0.0314961 </td> <td style=text-align:right;> 0.4974490 </td> </tr> <tr> <td style=text-align:left;> 3 </td> <td style=text-align:right;> 4 </td> <td style=text-align:right;> 12 </td> <td style=text-align:right;> 0.0179978 </td> <td style=text-align:right;> 0.3750000 </td> </tr> <tr> <td style=text-align:left;> 4 </td> <td style=text-align:right;> 3 </td> <td style=text-align:right;> 15 </td> <td style=text-align:right;> 0.0202475 </td> <td style=text-align:right;> 0.2777778 </td> </tr> <tr> <td style=text-align:left;> 5 </td> <td style=text-align:right;> 0 </td> <td style=text-align:right;> 5 </td> <td style=text-align:right;> 0.0056243 </td> <td style=text-align:right;> 0.0000000 </td> </tr> <tr> <td style=text-align:left;> 8 </td> <td style=text-align:right;> 0 </td> <td style=text-align:right;> 7 </td> <td style=text-align:right;> 0.0078740 </td> <td style=text-align:right;> 0.0000000 </td> </tr> </tbody> </table></div> <p>By combining the number of siblings of 1 and 2 into one category and all others into another group, we will have the following Gini index: </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>No of siblings</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> One or two siblings </td> <td style=text-align:right;> 125 </td> <td style=text-align:right;> 112 </td> <td style=text-align:right;> 0.2665917 </td> <td style=text-align:right;> 0.4984956 </td> </tr> <tr> <td style=text-align:left;> others </td> <td style=text-align:right;> 215 </td> <td style=text-align:right;> 437 </td> <td style=text-align:right;> 0.7334083 </td> <td style=text-align:right;> 0.4420330 </td> </tr> </tbody> </table></div> <div class=highlight><pre><span></span><code>## [1] &quot;The total weighted impurity after the split is: 0.457085468377958&quot;
</code></pre></div> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-7-1.png><!-- --></p> <h4 id=number-of-parentschildren>Number of parents/children<a class=headerlink href=#number-of-parentschildren title="Permanent link">&para;</a></h4> <p>Just like the number of siblings, the number of parents/children of a person is also a categorical variable. The Gini index among the categories are: </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Parch</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> 0 </td> <td style=text-align:right;> 231 </td> <td style=text-align:right;> 445 </td> <td style=text-align:right;> 0.7604049 </td> <td style=text-align:right;> 0.4498923 </td> </tr> <tr> <td style=text-align:left;> 1 </td> <td style=text-align:right;> 65 </td> <td style=text-align:right;> 53 </td> <td style=text-align:right;> 0.1327334 </td> <td style=text-align:right;> 0.4948291 </td> </tr> <tr> <td style=text-align:left;> 2 </td> <td style=text-align:right;> 40 </td> <td style=text-align:right;> 40 </td> <td style=text-align:right;> 0.0899888 </td> <td style=text-align:right;> 0.5000000 </td> </tr> <tr> <td style=text-align:left;> 3 </td> <td style=text-align:right;> 3 </td> <td style=text-align:right;> 2 </td> <td style=text-align:right;> 0.0056243 </td> <td style=text-align:right;> 0.4800000 </td> </tr> <tr> <td style=text-align:left;> 4 </td> <td style=text-align:right;> 0 </td> <td style=text-align:right;> 4 </td> <td style=text-align:right;> 0.0044994 </td> <td style=text-align:right;> 0.0000000 </td> </tr> <tr> <td style=text-align:left;> 5 </td> <td style=text-align:right;> 1 </td> <td style=text-align:right;> 4 </td> <td style=text-align:right;> 0.0056243 </td> <td style=text-align:right;> 0.3200000 </td> </tr> <tr> <td style=text-align:left;> 6 </td> <td style=text-align:right;> 0 </td> <td style=text-align:right;> 1 </td> <td style=text-align:right;> 0.0011249 </td> <td style=text-align:right;> 0.0000000 </td> </tr> </tbody> </table></div> <p>By combining the number of parents/siblings of 1, 2 and 3 into one group and others into another group, we will have the following impurity:</p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Parch</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> 1,2&amp;3 </td> <td style=text-align:right;> 108 </td> <td style=text-align:right;> 95 </td> <td style=text-align:right;> 0.2283465 </td> <td style=text-align:right;> 0.4979495 </td> </tr> <tr> <td style=text-align:left;> others </td> <td style=text-align:right;> 232 </td> <td style=text-align:right;> 454 </td> <td style=text-align:right;> 0.7716535 </td> <td style=text-align:right;> 0.4476366 </td> </tr> </tbody> </table></div> <div class=highlight><pre><span></span><code>## [1] &quot;The total weighted impurity after the split is: 0.459125378001722&quot;
</code></pre></div> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-9-1.png><!-- --></p> <h4 id=embarked-location>Embarked location<a class=headerlink href=#embarked-location title="Permanent link">&para;</a></h4> <p>There are three locations where the passengers have embarked. The Gini index within each of the location is: </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Embarked location</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> C </td> <td style=text-align:right;> 93 </td> <td style=text-align:right;> 75 </td> <td style=text-align:right;> 0.1889764 </td> <td style=text-align:right;> 0.4942602 </td> </tr> <tr> <td style=text-align:left;> Q </td> <td style=text-align:right;> 30 </td> <td style=text-align:right;> 47 </td> <td style=text-align:right;> 0.0866142 </td> <td style=text-align:right;> 0.4756283 </td> </tr> <tr> <td style=text-align:left;> S </td> <td style=text-align:right;> 217 </td> <td style=text-align:right;> 427 </td> <td style=text-align:right;> 0.7244094 </td> <td style=text-align:right;> 0.4468336 </td> </tr> </tbody> </table></div> <p>Combining Q and S into one category, we have:</p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Embarked location</caption> <thead> <tr> <th style=text-align:left;> Var1 </th> <th style=text-align:right;> I </th> <th style=text-align:right;> O </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> C </td> <td style=text-align:right;> 93 </td> <td style=text-align:right;> 75 </td> <td style=text-align:right;> 0.1889764 </td> <td style=text-align:right;> 0.4942602 </td> </tr> <tr> <td style=text-align:left;> Q&amp;S </td> <td style=text-align:right;> 247 </td> <td style=text-align:right;> 474 </td> <td style=text-align:right;> 0.8110236 </td> <td style=text-align:right;> 0.4504377 </td> </tr> </tbody> </table></div> <div class=highlight><pre><span></span><code>## [1] &quot;The total weighted impurity after the split is: 0.458719142423424&quot;
</code></pre></div> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-11-1.png><!-- --></p> <h4 id=age>Age<a class=headerlink href=#age title="Permanent link">&para;</a></h4> <p>Age is a continuous variable, so we have to find the ideal age to split the data along with the impurity metrics. To find the ideal cutoff, I have plotted the weighted gini index for split based on different ages. <img alt src=../CART-Classification_files/figure-html/unnamed-chunk-12-1.png><!-- --></p> <p>We can observe the minimum Gini index when the data is split at Age=7 years. </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Age</caption> <thead> <tr> <th style=text-align:left;> Age_class </th> <th style=text-align:right;> survived_prob </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> &lt;7 </td> <td style=text-align:right;> 0.6470588 </td> <td style=text-align:right;> 0.0573678 </td> <td style=text-align:right;> 0.4567474 </td> </tr> <tr> <td style=text-align:left;> &gt;=7 </td> <td style=text-align:right;> 0.3663484 </td> <td style=text-align:right;> 0.9426322 </td> <td style=text-align:right;> 0.4642745 </td> </tr> </tbody> </table></div> <div class=highlight><pre><span></span><code>## [1] &quot;The total weighted impurity after the split is: 0.46&quot;
</code></pre></div> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-13-1.png><!-- --></p> <h4 id=fare>Fare<a class=headerlink href=#fare title="Permanent link">&para;</a></h4> <p>Similar to age, fare is a continuous variable and we have to find the optimal fare to split first.<br> <img alt src=../CART-Classification_files/figure-html/unnamed-chunk-14-1.png><!-- --></p> <p>The optimal fare is 11. The impurity metrics for this split are: </p> <div style="border: 1px solid #ddd; padding: 5px; "><table class=table style="margin-left: auto; margin-right: auto;"> <caption>Fare</caption> <thead> <tr> <th style=text-align:left;> Fare_class </th> <th style=text-align:right;> survived_prob </th> <th style=text-align:right;> proportion.of.obs </th> <th style=text-align:right;> child.gini.index </th> </tr> </thead> <tbody> <tr> <td style=text-align:left;> &lt;=11 </td> <td style=text-align:right;> 0.2087912 </td> <td style=text-align:right;> 0.4094488 </td> <td style=text-align:right;> 0.3303949 </td> </tr> <tr> <td style=text-align:left;> &gt;11 </td> <td style=text-align:right;> 0.5028571 </td> <td style=text-align:right;> 0.5905512 </td> <td style=text-align:right;> 0.4999837 </td> </tr> </tbody> </table></div> <h4 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h4> <p>Among all the factors above, Gender has the least Gini Index of 0.3338. So the initial split of the data would be on Gender. </p> <h3 id=step-4-repeat-step-3-until-stopping-criterion>Step 4: Repeat step 3 until stopping criterion<a class=headerlink href=#step-4-repeat-step-3-until-stopping-criterion title="Permanent link">&para;</a></h3> <p>After splitting the data based on gender, we will get two data sets. We should perform a similar analysis to step 2 to split the data further, and so on. The splitting should stop when we meet the stopping criterion. Different stopping criterion for CART classification trees are: <br> 1. The number of cases in the node is less than some pre-specified limit. <br> 2. The purity of the node is more than some pre-specified threshold. <br> 3. Depth of the node is more than some pre-specified threshold. <br> 4. Predictor values for all records are identical </p> <p>In this blog, I want to give a maximum depth of trees as 3. In the machine learning blogs, I will go deeper into how to select ideal stopping criterion. For max depth=3, we get the following decision tree: </p> <p><img alt src=../CART-Classification_files/figure-html/unnamed-chunk-16-1.png><!-- --></p> <h3 id=step-5-making-business-rules>Step 5: Making business rules<a class=headerlink href=#step-5-making-business-rules title="Permanent link">&para;</a></h3> <p>From the above tree, I can see generate the following rules:<br> 1. A female passenger has a higher probability of surviving unless she is travelling in third class with a fare less than 23. <br> 2. A male passenger has a lower likelihood of surviving unless he is a child of age less than six years and with up to two siblings. </p> <p>Using this decision tree, we can observe how sociological factors like gender, age and monetary status affected the decisions on who would get into a lifeboat at a crucial time during the titanic disaster. </p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <ol> <li><a href=https://www.wileyindia.com/business-analytics-the-science-of-data-driven-decision-making.html>Business Analytics: The Science of Data-Driven Decision Making - Dinesh Kumar</a> </li> <li><a href=https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/ >Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2<sup>nd</sup> Edition</a> </li> <li><a href=http://faculty.marshall.usc.edu/gareth-james/ISL/ >An Introduction to Statistical Learning: With Applications in R</a> </li> </ol> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../CHAID/ class="md-footer__link md-footer__link--prev" aria-label="Previous: CHAID Decision Trees (R)" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> CHAID Decision Trees (R) </div> </div> </a> <a href=../part-and-partial-corr/ class="md-footer__link md-footer__link--next" aria-label="Next: Part and partial correlation" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Part and partial correlation </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> <img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/88x31.png> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/HarshaAsh target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/sri-harsha-achyuthuni/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.instagram.com/harshaash_com/ target=_blank rel=noopener title=www.instagram.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=https://www.facebook.com/sri.harsha.achyuthuni/ target=_blank rel=noopener title=www.facebook.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "header.autohide", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56838a2c.min.js></script> </body> </html>