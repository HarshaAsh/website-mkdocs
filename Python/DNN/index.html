<!doctype html><html lang=en class=no-js> <head><script>
      (function () {
        var adsLoaded = false;

        function loadAds() {
          if (adsLoaded) return;
          adsLoaded = true;

          var ads = document.createElement("script");
          ads.async = true;
          ads.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8786690539845043";
          ads.crossOrigin = "anonymous";
          document.head.appendChild(ads);

          var amp = document.createElement("script");
          amp.async = true;
          amp.setAttribute("custom-element", "amp-auto-ads");
          amp.src = "https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js";
          document.head.appendChild(amp);

          var autoAds = document.createElement("amp-auto-ads");
          autoAds.setAttribute("type", "adsense");
          autoAds.setAttribute("data-ad-client", "ca-pub-8786690539845043");
          document.body.appendChild(autoAds);
        }

        function onFirstInteraction() {
          loadAds();
          removeListeners();
        }

        function removeListeners() {
          window.removeEventListener("scroll", onFirstInteraction, { passive: true });
          window.removeEventListener("mousemove", onFirstInteraction, { passive: true });
          window.removeEventListener("touchstart", onFirstInteraction, { passive: true });
          window.removeEventListener("keydown", onFirstInteraction, { passive: true });
        }

        window.addEventListener("scroll", onFirstInteraction, { passive: true });
        window.addEventListener("mousemove", onFirstInteraction, { passive: true });
        window.addEventListener("touchstart", onFirstInteraction, { passive: true });
        window.addEventListener("keydown", onFirstInteraction, { passive: true });

        window.addEventListener("load", function () {
          setTimeout(loadAds, 5000);
        }, { once: true });
      })();
    </script><script>
      (function () {
        function deferThirdParties() {
          var optimize = document.createElement("script");
          optimize.src = "https://www.googleoptimize.com/optimize.js?id=OPT-M98W6LW";
          optimize.async = true;
          document.head.appendChild(optimize);

          window._mfq = window._mfq || [];
          var mf = document.createElement("script");
          mf.type = "text/javascript";
          mf.defer = true;
          mf.src = "//cdn.mouseflow.com/projects/7b4494c9-7974-49f0-9777-d14450db37e6.js";
          document.head.appendChild(mf);
        }

        if (document.readyState === "complete") {
          deferThirdParties();
        } else {
          window.addEventListener("load", deferThirdParties, { once: true });
        }
      })();
    </script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Harsha's notes on data science"><meta name=author content="Harsha Achyuthuni"><link href=https://www.harshaash.com/Python/DNN/ rel=canonical><link rel=icon href=../../assets/images/logo.jpg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-7.2.4"><title>Tensorflow and Keras - Data Science with Harsha</title><link rel=preload href=../../assets/stylesheets/main.f7f47774.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=../../assets/stylesheets/main.f7f47774.min.css></noscript><link rel=preload href=../../assets/stylesheets/palette.3f5d1f46.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css></noscript><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"></noscript><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=preload href=../../overrides/assets/stylesheets/user_defined.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=../../overrides/assets/stylesheets/user_defined.css></noscript><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-65034507-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer style="margin-bottom: 0;"></label> <div data-md-component=skip> <a href=#introduction class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header style="background-color: navy;" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science with Harsha" class="md-header__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science with Harsha </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Tensorflow and Keras </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_1> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_3> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_4> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <a href=../../contact title="Contact Me" class=md-header__button aria-label="Contact Me" style="display: inline-flex; align-items: center; gap: 0.3rem; white-space: nowrap;"> <span class=md-icon style="display: inline-flex;"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"/></svg> </span> <span style="font-size: 0.8rem;">Contact Me</span> </a> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science with Harsha" class="md-nav__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> Data Science with Harsha </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../resume/ class=md-nav__link> Resume </a> </li> <li class=md-nav__item> <a href=../../learn/ class=md-nav__link> Learn </a> </li> <li class=md-nav__item> <a href=../../contact/ class=md-nav__link> Contact </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Blog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Table_of_Contents/ class=md-nav__link> Table of Contents </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2> Visualization <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Visualization data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Vizualisation%20using%20python%20Part%201/ class=md-nav__link> Vizualizing tabular data (Python) </a> </li> <li class=md-nav__item> <a href=../Visualization%20for%20predictive%20analytics/ class=md-nav__link> Vizualising for predictive analytics (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Univariate-analysis/ class=md-nav__link> Univariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multivariateAnalysis/ class=md-nav__link> Multivariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multicollinearity/ class=md-nav__link> Multicollinearity (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_3 type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3> Statistics basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Statistics basics" data-md-level=2> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Statistics basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Statistics%20basics/ class=md-nav__link> Statistics Basics (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Probability/ class=md-nav__link> Probability (R) </a> </li> <li class=md-nav__item> <a href=../../R/vectors/ class=md-nav__link> Vectors (R) </a> </li> <li class=md-nav__item> <a href=../../R/matrices/ class=md-nav__link> Matrices (R) </a> </li> <li class=md-nav__item> <a href=../Call%20center%20distributions/ class=md-nav__link> Call center distributions (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_4 type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4> Hypothesis Testing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hypothesis Testing" data-md-level=2> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Hypothesis Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/attendance_t_test/ class=md-nav__link> z-test and t-test (R) </a> </li> <li class=md-nav__item> <a href=../../R/anova/ class=md-nav__link> ANOVA Test (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-goodness-of-fit/ class=md-nav__link> Chi-Square Goodness of fit (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-test-of-independence/ class=md-nav__link> Chi-Square test of independence (R) </a> </li> <li class=md-nav__item> <a href=../Hypothesis_Testing_Python/ class=md-nav__link> Hypothesis testing using Python </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_5 type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5> Factor Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Factor Analysis" data-md-level=2> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Factor Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Curse-of-Dimensionality/ class=md-nav__link> Curse of dimensionality </a> </li> <li class=md-nav__item> <a href=../../R/EFA/ class=md-nav__link> Exploratory factor analysis (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_6 type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6> Preprocessing data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preprocessing data" data-md-level=2> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> Preprocessing data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/KNN_Imputation/ class=md-nav__link> Null Value Imputation (R) </a> </li> <li class=md-nav__item> <a href=../Machine%20Learning%20Part%201/ class=md-nav__link> Feature engineering (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Handling-Imbalanced-classes/ class=md-nav__link> Handling Imbalanced Classes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_7 type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7> Prediction algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prediction algorithms" data-md-level=2> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> Prediction algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_7_1 type=checkbox id=__nav_5_7_1> <label class=md-nav__link for=__nav_5_7_1> Classification Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Classification Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_5_7_1> <span class="md-nav__icon md-icon"></span> Classification Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/logistic-regression/ class=md-nav__link> Logistic Regression (R) </a> </li> <li class=md-nav__item> <a href=../../R/CHAID/ class=md-nav__link> CHAID Decision Trees (R) </a> </li> <li class=md-nav__item> <a href=../../R/CART-Classification/ class=md-nav__link> CART Classification (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_7_2 type=checkbox id=__nav_5_7_2> <label class=md-nav__link for=__nav_5_7_2> Regression Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Regression Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_5_7_2> <span class="md-nav__icon md-icon"></span> Regression Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/part-and-partial-corr/ class=md-nav__link> Part and partial correlation </a> </li> <li class=md-nav__item> <a href=../../R/Linear-regression/ class=md-nav__link> Linear Regression (R) </a> </li> <li class=md-nav__item> <a href=../Linear%20regression%20usecase%20mpg%20prediction/ class=md-nav__link> Lasso and Ridge regression (Python) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_8 type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8> Machine Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Machine Learning" data-md-level=2> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://harshaachyuthuni.shinyapps.io/Machine_Learning/ class=md-nav__link> Interactive Machine Learning (RShiny) </a> </li> <li class=md-nav__item> <a href=../ML%20using%20scikit-learn/ class=md-nav__link> Multi models (Python) </a> </li> <li class=md-nav__item> <a href=../Explainable%20models%20using%20Heart%20Failure/ class=md-nav__link> Explainable ML (Python) </a> </li> <li class=md-nav__item> <a href=../Demonstrating%20online%20learning/ class=md-nav__link> Streaming Machine Learning (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_9 type=checkbox id=__nav_5_9> <label class=md-nav__link for=__nav_5_9> Time Series forecasting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Time Series forecasting" data-md-level=2> <label class=md-nav__title for=__nav_5_9> <span class="md-nav__icon md-icon"></span> Time Series forecasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/time-series/ class=md-nav__link> Introduction to stationarity (R) </a> </li> <li class=md-nav__item> <a href=../../R/Stationarity-tests/ class=md-nav__link> Stationary Tests (R) </a> </li> <li class=md-nav__item> <a href=../../R/ARIMA/ class=md-nav__link> ARIMA in R </a> </li> <li class=md-nav__item> <a href=../ARIMA%20Forecasting/ class=md-nav__link> ARIMA in Python </a> </li> <li class=md-nav__item> <a href=../../R/Seasonal-Time-Series/ class=md-nav__link> Seasonal time series (R) </a> </li> <li class=md-nav__item> <a href=../../R/VAR-models/ class=md-nav__link> VAR Models (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_10 type=checkbox id=__nav_5_10 checked> <label class=md-nav__link for=__nav_5_10> Deep learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deep learning" data-md-level=2> <label class=md-nav__title for=__nav_5_10> <span class="md-nav__icon md-icon"></span> Deep learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ANN-1/ class=md-nav__link> Perceptron </a> </li> <li class=md-nav__item> <a href=../Backpropagation/ class=md-nav__link> Backpropagation </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Tensorflow and Keras <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Tensorflow and Keras </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tensorflow-and-keras class=md-nav__link> TensorFlow and Keras </a> </li> <li class=md-nav__item> <a href=#data class=md-nav__link> Data </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sequential-api class=md-nav__link> Sequential API </a> <nav class=md-nav aria-label="Sequential API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#number-of-parameters class=md-nav__link> Number of parameters </a> </li> <li class=md-nav__item> <a href=#dense-layer class=md-nav__link> Dense layer </a> </li> <li class=md-nav__item> <a href=#dropout class=md-nav__link> Dropout </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vanishing-gradientsexploding-gradients-problem class=md-nav__link> Vanishing gradients/exploding gradients problem </a> </li> <li class=md-nav__item> <a href=#fine-tuning-neural-network-hyperparameters class=md-nav__link> Fine-tuning neural network hyperparameters </a> <nav class=md-nav aria-label="Fine-tuning neural network hyperparameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#number-of-hidden-layers class=md-nav__link> Number of hidden layers </a> </li> <li class=md-nav__item> <a href=#number-of-neurons-per-hidden-layer class=md-nav__link> Number of neurons per hidden layer </a> </li> <li class=md-nav__item> <a href=#batch-size class=md-nav__link> Batch size </a> </li> <li class=md-nav__item> <a href=#activation-function class=md-nav__link> Activation function </a> <nav class=md-nav aria-label="Activation function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#leaky-relu class=md-nav__link> Leaky Relu </a> </li> <li class=md-nav__item> <a href=#selu class=md-nav__link> SELU </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#optimizer class=md-nav__link> Optimizer </a> </li> <li class=md-nav__item> <a href=#batch-normalisation class=md-nav__link> Batch normalisation </a> </li> <li class=md-nav__item> <a href=#weight-initialisation class=md-nav__link> Weight initialisation </a> </li> <li class=md-nav__item> <a href=#gradient-clipping class=md-nav__link> Gradient clipping </a> </li> <li class=md-nav__item> <a href=#regularization-l1-and-l2 class=md-nav__link> Regularization (l1 and l2) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#training-the-best-model class=md-nav__link> Training the best model </a> <nav class=md-nav aria-label="Training the best model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#learning-rate-scheduling class=md-nav__link> Learning rate scheduling </a> </li> <li class=md-nav__item> <a href=#early-stopping-and-model-checkpoints class=md-nav__link> Early stopping and model checkpoints </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Time%20series%20deep%20learning/ class=md-nav__link> Time series (python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_11 type=checkbox id=__nav_5_11> <label class=md-nav__link for=__nav_5_11> Generative AI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Generative AI" data-md-level=2> <label class=md-nav__title for=__nav_5_11> <span class="md-nav__icon md-icon"></span> Generative AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../LLM%20Tokenizers/ class=md-nav__link> LLM Tokenizers </a> </li> <li class=md-nav__item> <a href=../prompt_engineering_techniques/ class=md-nav__link> Prompt Engineering </a> </li> <li class=md-nav__item> <a href=../Agentic%20AI/ class=md-nav__link> Agentic AI </a> </li> <li class=md-nav__item> <a href=../RAG/ class=md-nav__link> RAG </a> </li> <li class=md-nav__item> <a href=../Blog%20validation/ class=md-nav__link> LangGraphs </a> </li> <li class=md-nav__item> <a href=../CrewAI/ class=md-nav__link> CrewAI </a> </li> <li class=md-nav__item> <a href=../../Others/yashoda_presentation/ class=md-nav__link> AI in Healthcare </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_12 type=checkbox id=__nav_5_12> <label class=md-nav__link for=__nav_5_12> Prescriptive Analytics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prescriptive Analytics" data-md-level=2> <label class=md-nav__title for=__nav_5_12> <span class="md-nav__icon md-icon"></span> Prescriptive Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Linear-programming/ class=md-nav__link> Linear Programming (R) </a> </li> <li class=md-nav__item> <a href=../../Others/integer_programming_blog/ class=md-nav__link> Integer Programming tricks </a> </li> <li class=md-nav__item> <a href=../inventory_optimization_eoq_ortools/ class=md-nav__link> Inventory Optimisation (Python) </a> </li> <li class=md-nav__item> <a href=../../R/adoption_of_new_product/ class=md-nav__link> Adoption of new product (R) </a> </li> <li class=md-nav__item> <a href=../Diffusion%20on%20networks/ class=md-nav__link> Bass Forecasting model (Python) </a> </li> <li class=md-nav__item> <a href=../../Others/AHP/ class=md-nav__link> Analytic Hierarchy Process </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_13 type=checkbox id=__nav_5_13> <label class=md-nav__link for=__nav_5_13> Clustering <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Clustering data-md-level=2> <label class=md-nav__title for=__nav_5_13> <span class="md-nav__icon md-icon"></span> Clustering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/hierarchical_clustering/ class=md-nav__link> Hierarchical Clustering </a> </li> <li class=md-nav__item> <a href=../../R/kMeansClustering/ class=md-nav__link> K-Means Clustering </a> </li> <li class=md-nav__item> <a href=../train_delays/ class=md-nav__link> DBSCAN Clustering (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_14 type=checkbox id=__nav_5_14> <label class=md-nav__link for=__nav_5_14> Reinforcement Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reinforcement Learning" data-md-level=2> <label class=md-nav__title for=__nav_5_14> <span class="md-nav__icon md-icon"></span> Reinforcement Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/CustomerLifetimeValue/ class=md-nav__link> Customer Lifetime Value </a> </li> <li class=md-nav__item> <a href=../../R/recommendation-systems/ class=md-nav__link> Recommendation Systems (R) </a> </li> <li class=md-nav__item> <a href=../Neural_collaborative_filtering/ class=md-nav__link> Collaborative Filtering (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_15 type=checkbox id=__nav_5_15> <label class=md-nav__link for=__nav_5_15> Networks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networks data-md-level=2> <label class=md-nav__title for=__nav_5_15> <span class="md-nav__icon md-icon"></span> Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Introduction%20to%20Networkx/ class=md-nav__link> Introduction to NetworkX (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Science/ class=md-nav__link> Network Science (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20centrality/ class=md-nav__link> Network Centrality (Python) </a> </li> <li class=md-nav__item> <a href=../Shortest%20path%20problems/ class=md-nav__link> Shortest path using integer programming (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Flow%20problems/ class=md-nav__link> Network flow problems (Python) </a> </li> <li class=md-nav__item> <a href=../Community%20detection/ class=md-nav__link> Community detection (Python) </a> </li> <li class=md-nav__item> <a href=../Bipartite%20matching/ class=md-nav__link> Bipartite matching (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_16 type=checkbox id=__nav_5_16> <label class=md-nav__link for=__nav_5_16> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=2> <label class=md-nav__title for=__nav_5_16> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Machine%20learning%20as%20HTTP%20Request/ class=md-nav__link> ML deployment in Flask (Python) </a> </li> <li class=md-nav__item> <a href=../Saving%20predictions%20in%20database/ class=md-nav__link> Handling databases using python </a> </li> <li class=md-nav__item> <a href=../ORM/ class=md-nav__link> ORM (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_17 type=checkbox id=__nav_5_17> <label class=md-nav__link for=__nav_5_17> Career lessons <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Career lessons" data-md-level=2> <label class=md-nav__title for=__nav_5_17> <span class="md-nav__icon md-icon"></span> Career lessons </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/learnings/ class=md-nav__link> Learnings from failures </a> </li> <li class=md-nav__item> <a href=../../Others/podcast/ class=md-nav__link> Making ML Consumable </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_18 type=checkbox id=__nav_5_18> <label class=md-nav__link for=__nav_5_18> Higher education review <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Higher education review" data-md-level=2> <label class=md-nav__title for=__nav_5_18> <span class="md-nav__icon md-icon"></span> Higher education review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/IIMB%20BAI/ class=md-nav__link> IIMB BAI </a> </li> <li class=md-nav__item> <a href=../../Others/part%20time%20data%20science%20masters/ class=md-nav__link> Part-time DS masters </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_19 type=checkbox id=__nav_5_19> <label class=md-nav__link for=__nav_5_19> External blogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="External blogs" data-md-level=2> <label class=md-nav__title for=__nav_5_19> <span class="md-nav__icon md-icon"></span> External blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Imperial%20College%20London/ class=md-nav__link> Imperial college London </a> </li> <li class=md-nav__item> <a href=../../Others/Publications/ class=md-nav__link> Publications/conferences </a> </li> <li class=md-nav__item> <a href=../../Others/Deployed%20apps/ class=md-nav__link> Deployed apps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_20 type=checkbox id=__nav_5_20> <label class=md-nav__link for=__nav_5_20> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=__nav_5_20> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/preventive_maintainence/ class=md-nav__link> Preventive maintainence </a> </li> <li class=md-nav__item> <a href=../../Others/Contract%20Intelligence%20tool/ class=md-nav__link> Contract Intelligence </a> </li> <li class=md-nav__item> <a href=../../Others/competitor%20intelligence/ class=md-nav__link> Competitor intelligence </a> </li> <li class=md-nav__item> <a href=../../Others/quiz%20generation/ class=md-nav__link> Quiz Generation </a> </li> <li class=md-nav__item> <a href=../../Others/Scarecrow/ class=md-nav__link> Intelligent annotation </a> </li> <li class=md-nav__item> <a href=../../Others/Demand%20Forecasting/ class=md-nav__link> Demand Forecasting </a> </li> <li class=md-nav__item> <a href=../../Others/bid%20allocation%20model/ class=md-nav__link> Bid Allocation </a> </li> <li class=md-nav__item> <a href=../../Others/IIMB%20project/ class=md-nav__link> Reward and Recognition contests </a> </li> <li class=md-nav__item> <a href=../../Others/supply%20chain%20analytics/ class=md-nav__link> Supply chain analytics </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tensorflow-and-keras class=md-nav__link> TensorFlow and Keras </a> </li> <li class=md-nav__item> <a href=#data class=md-nav__link> Data </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sequential-api class=md-nav__link> Sequential API </a> <nav class=md-nav aria-label="Sequential API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#number-of-parameters class=md-nav__link> Number of parameters </a> </li> <li class=md-nav__item> <a href=#dense-layer class=md-nav__link> Dense layer </a> </li> <li class=md-nav__item> <a href=#dropout class=md-nav__link> Dropout </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vanishing-gradientsexploding-gradients-problem class=md-nav__link> Vanishing gradients/exploding gradients problem </a> </li> <li class=md-nav__item> <a href=#fine-tuning-neural-network-hyperparameters class=md-nav__link> Fine-tuning neural network hyperparameters </a> <nav class=md-nav aria-label="Fine-tuning neural network hyperparameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#number-of-hidden-layers class=md-nav__link> Number of hidden layers </a> </li> <li class=md-nav__item> <a href=#number-of-neurons-per-hidden-layer class=md-nav__link> Number of neurons per hidden layer </a> </li> <li class=md-nav__item> <a href=#batch-size class=md-nav__link> Batch size </a> </li> <li class=md-nav__item> <a href=#activation-function class=md-nav__link> Activation function </a> <nav class=md-nav aria-label="Activation function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#leaky-relu class=md-nav__link> Leaky Relu </a> </li> <li class=md-nav__item> <a href=#selu class=md-nav__link> SELU </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#optimizer class=md-nav__link> Optimizer </a> </li> <li class=md-nav__item> <a href=#batch-normalisation class=md-nav__link> Batch normalisation </a> </li> <li class=md-nav__item> <a href=#weight-initialisation class=md-nav__link> Weight initialisation </a> </li> <li class=md-nav__item> <a href=#gradient-clipping class=md-nav__link> Gradient clipping </a> </li> <li class=md-nav__item> <a href=#regularization-l1-and-l2 class=md-nav__link> Regularization (l1 and l2) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#training-the-best-model class=md-nav__link> Training the best model </a> <nav class=md-nav aria-label="Training the best model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#learning-rate-scheduling class=md-nav__link> Learning rate scheduling </a> </li> <li class=md-nav__item> <a href=#early-stopping-and-model-checkpoints class=md-nav__link> Early stopping and model checkpoints </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Tensorflow and Keras</h1> <p><meta name=description content="Deep Learning with TensorFlow and Keras. Build production-ready deep neural networks using TensorFlow and Keras."></p> <script type=text/javascript src=https://cdn.mathjax.org/mathjax/latest/MathJax.js>
MathJax.Hub.Config({
 extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
 jax: ["input/TeX", "output/HTML-CSS"],
 tex2jax: {
     inlineMath: [ ['$','$'], ["\\(","\\)"] ],
     displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
 },
 "HTML-CSS": { availableFonts: ["TeX"] }
});
</script> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>In the first two blogs, we covered <a href=../ANN-1/ >perceptron</a> and <a href=../Backpropagation/ >backpropagation</a>. We have also worked on the <a href=../Machine%20Learning%20Part%201/ >absenteeism categorization problem</a> in <a href=../Machine%20Learning%20Part%201/ >feature engineering</a> and <a href=../ML%20using%20scikit-learn/ >machine learning</a>. In this blog, we will build a basic neural network with Tensorflow and Keras to predict who will be absent in the future.</p> <h3 id=tensorflow-and-keras>TensorFlow and Keras<a class=headerlink href=#tensorflow-and-keras title="Permanent link">&para;</a></h3> <p>TensorFlow is a robust, open-source library for numerical computation and large-scale machine learning. Keras, on the other hand, is a high-level neural network API built on top of TensorFlow. Keras helps in building, training, executing, and evaluating all kinds of neural networks.</p> <h3 id=data>Data<a class=headerlink href=#data title="Permanent link">&para;</a></h3> <p>Organizations face a significant challenge in motivating their employees. This is the continuation of a blog series in which we used several <a href=../Machine%20Learning%20Part%201/ >feature engineering strategies</a> to create a comprehensive dataset and then predicted who would be absent using <a href=../ML%20using%20scikit-learn/ >machine learning and Scikit-Learn</a>. In this blog, we will use this information to predict employee absenteeism. The purpose is to identify those who are likely to be absent in the near future.</p> <p>As a first step, load and examine the data.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;/content/gdrive/MyDrive/data_after_feature_engg.csv&#39;</span><span class=p>)</span>
<span class=n>df</span>
</code></pre></div> <table border=1 class="dataframe table"> <thead> <tr style="text-align: right;"> <th></th> <th>Unnamed: 0</th> <th>employee</th> <th>date</th> <th>last_likes</th> <th>last_dislikes</th> <th>feedbackType</th> <th>likes_till_date</th> <th>dislikes_till_date</th> <th>last_2_likes</th> <th>last_2_dislikes</th> <th>...</th> <th>employee_joined_after_jun17</th> <th>countdown_to_last_day</th> <th>reason</th> <th>on_leave</th> <th>no_leaves_till_date</th> <th>last_2_days_leaves</th> <th>previous_day_leave</th> <th>weekday</th> <th>month</th> <th>week</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>23729</td> <td>17r</td> <td>2018-05-29</td> <td>0.0</td> <td>0.0</td> <td>0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>...</td> <td>1.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Tuesday</td> <td>May</td> <td>1</td> </tr> <tr> <th>1</th> <td>23730</td> <td>17r</td> <td>2018-05-30</td> <td>0.0</td> <td>0.0</td> <td>0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>...</td> <td>1.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Wednesday</td> <td>May</td> <td>2</td> </tr> <tr> <th>2</th> <td>23731</td> <td>17r</td> <td>2018-05-31</td> <td>0.0</td> <td>0.0</td> <td>0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>...</td> <td>1.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Thursday</td> <td>May</td> <td>3</td> </tr> <tr> <th>3</th> <td>23732</td> <td>17r</td> <td>2018-06-01</td> <td>0.0</td> <td>0.0</td> <td>0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>...</td> <td>1.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Friday</td> <td>Jun</td> <td>1</td> </tr> <tr> <th>4</th> <td>23733</td> <td>17r</td> <td>2018-06-02</td> <td>0.0</td> <td>0.0</td> <td>0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>...</td> <td>1.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Saturday</td> <td>Jun</td> <td>2</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>33446</th> <td>32232</td> <td>zGB</td> <td>2019-03-07</td> <td>24.0</td> <td>8.0</td> <td>OTHER</td> <td>24.0</td> <td>8.0</td> <td>24.0</td> <td>8.0</td> <td>...</td> <td>0.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Thursday</td> <td>Mar</td> <td>0</td> </tr> <tr> <th>33447</th> <td>32233</td> <td>zGB</td> <td>2019-03-08</td> <td>24.0</td> <td>8.0</td> <td>OTHER</td> <td>24.0</td> <td>8.0</td> <td>24.0</td> <td>8.0</td> <td>...</td> <td>0.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Friday</td> <td>Mar</td> <td>1</td> </tr> <tr> <th>33448</th> <td>32234</td> <td>zGB</td> <td>2019-03-09</td> <td>24.0</td> <td>8.0</td> <td>OTHER</td> <td>24.0</td> <td>8.0</td> <td>24.0</td> <td>8.0</td> <td>...</td> <td>0.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Saturday</td> <td>Mar</td> <td>2</td> </tr> <tr> <th>33449</th> <td>32235</td> <td>zGB</td> <td>2019-03-10</td> <td>24.0</td> <td>8.0</td> <td>OTHER</td> <td>24.0</td> <td>8.0</td> <td>24.0</td> <td>8.0</td> <td>...</td> <td>0.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Sunday</td> <td>Mar</td> <td>3</td> </tr> <tr> <th>33450</th> <td>32236</td> <td>zGB</td> <td>2019-03-11</td> <td>24.0</td> <td>8.0</td> <td>OTHER</td> <td>24.0</td> <td>8.0</td> <td>24.0</td> <td>8.0</td> <td>...</td> <td>0.0</td> <td>999</td> <td>NaN</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>Monday</td> <td>Mar</td> <td>4</td> </tr> </tbody> </table> <p>33451 rows Ã— 31 columns</p> <p>In the previous blog, we created the key features required for this binary classification task. All of these variables are listed in <em>indep_vars</em>.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>GridSearchCV</span>
<span class=n>indep_vars</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;last_likes&#39;</span><span class=p>,</span> <span class=s1>&#39;last_dislikes&#39;</span><span class=p>,</span> <span class=s1>&#39;feedbackType&#39;</span><span class=p>,</span>
     <span class=s1>&#39;likes_till_date&#39;</span><span class=p>,</span> <span class=s1>&#39;dislikes_till_date&#39;</span><span class=p>,</span> <span class=s1>&#39;last_2_likes&#39;</span><span class=p>,</span> <span class=s1>&#39;last_2_dislikes&#39;</span><span class=p>,</span>
     <span class=s1>&#39;days_since_last_comment&#39;</span><span class=p>,</span> <span class=s1>&#39;last_vote&#39;</span><span class=p>,</span> <span class=s1>&#39;timezone&#39;</span><span class=p>,</span> <span class=s1>&#39;stillExists&#39;</span><span class=p>,</span>
       <span class=s1>&#39;no_of_days_since_first_vote&#39;</span><span class=p>,</span> <span class=s1>&#39;no_of_votes_till_date&#39;</span><span class=p>,</span>
       <span class=s1>&#39;perc_days_voted&#39;</span><span class=p>,</span> <span class=s1>&#39;avg_vote_till_date&#39;</span><span class=p>,</span> <span class=s1>&#39;avg_vote&#39;</span><span class=p>,</span> <span class=s1>&#39;last_2_votes_avg&#39;</span><span class=p>,</span>
       <span class=s1>&#39;days_since_last_vote&#39;</span><span class=p>,</span> <span class=s1>&#39;employee_joined_after_jun17&#39;</span><span class=p>,</span> <span class=s1>&#39;countdown_to_last_day&#39;</span><span class=p>,</span>
        <span class=s1>&#39;no_leaves_till_date&#39;</span><span class=p>,</span> <span class=s1>&#39;weekday&#39;</span><span class=p>,</span> <span class=s1>&#39;month&#39;</span><span class=p>]</span>
<span class=n>data_targets</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;on_leave&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;int&#39;</span><span class=p>)</span>
<span class=n>data_features</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>indep_vars</span><span class=p>],</span> <span class=n>prefix</span> <span class=o>=</span> <span class=s2>&quot;_&quot;</span><span class=p>,</span> <span class=n>drop_first</span><span class=o>=</span> <span class=kc>True</span><span class=p>)</span>

<span class=n>x_train</span><span class=p>,</span> <span class=n>x_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>data_features</span><span class=p>,</span> <span class=n>data_targets</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>.30</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>35</span><span class=p>,</span> \
                                                    <span class=n>stratify</span><span class=o>=</span><span class=n>data_targets</span><span class=p>)</span>
</code></pre></div> <p>We then scale every independent variable. This promotes faster convergence, reduces the vanishing gradient problem, and increases stability. We will look into these concerns later.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=n>sc</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
<span class=n>x_train</span> <span class=o>=</span> <span class=n>sc</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>x_train</span><span class=p>)</span>
<span class=n>x_test</span> <span class=o>=</span> <span class=n>sc</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>x_test</span><span class=p>)</span>

<span class=n>input_length</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>x_train</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</code></pre></div> <h2 id=sequential-api>Sequential API<a class=headerlink href=#sequential-api title="Permanent link">&para;</a></h2> <p>Keras provides two basic approaches: a sequential model API and a functional model API. The sequential model API works well for the majority of basic neural networks. Let us build a simple neural network with one input layer, three hidden layers, and one output layer. The hidden layers use the ReLU activation function, whereas the output layer uses the sigmoid activation function.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>tensorflow</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>tf</span>
<span class=kn>from</span><span class=w> </span><span class=nn>tensorflow</span><span class=w> </span><span class=kn>import</span> <span class=n>keras</span>
<span class=kn>from</span><span class=w> </span><span class=nn>keras.models</span><span class=w> </span><span class=kn>import</span> <span class=n>Sequential</span>
<span class=kn>from</span><span class=w> </span><span class=nn>keras.layers</span><span class=w> </span><span class=kn>import</span> <span class=n>Dense</span><span class=p>,</span> <span class=n>Dropout</span><span class=p>,</span> <span class=n>InputLayer</span>
<span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>([</span>
    <span class=n>InputLayer</span><span class=p>(</span><span class=n>input_shape</span> <span class=o>=</span> <span class=p>[</span><span class=n>input_length</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;Input_layer&#39;</span><span class=p>),</span>
    <span class=n>Dense</span><span class=p>(</span><span class=mi>40</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;relu&quot;</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Hidden_layer_1&#39;</span><span class=p>),</span>
    <span class=n>Dropout</span><span class=p>(</span><span class=n>rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;Dropout_layer_1&#39;</span><span class=p>),</span>
    <span class=n>Dense</span><span class=p>(</span><span class=mi>40</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;relu&quot;</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Hidden_layer_2&#39;</span><span class=p>),</span>
    <span class=n>Dropout</span><span class=p>(</span><span class=n>rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;Dropout_layer_2&#39;</span><span class=p>),</span>
    <span class=n>Dense</span><span class=p>(</span><span class=mi>40</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;relu&quot;</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Hidden_layer_3&#39;</span><span class=p>),</span>
    <span class=n>Dropout</span><span class=p>(</span><span class=n>rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;Dropout_layer_3&#39;</span><span class=p>),</span>
    <span class=n>Dense</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;sigmoid&quot;</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Output_layer&#39;</span><span class=p>)</span>
<span class=p>])</span>
</code></pre></div> <p>The hidden layers each have 40 neurons while the output layer has 1 neuron. The output layer represents the likelihood of being absent. </p> <h3 id=number-of-parameters>Number of parameters<a class=headerlink href=#number-of-parameters title="Permanent link">&para;</a></h3> <p>In this simple network, the number of parameters in each layer is the same as the number of connections. In any layer, $$ Number\,of\,connections = (input_length+1)\times(output_length) $$ <span class=arithmatex>\(Number\,of\,input\,neurons = input\_neurons+bias\_neuron = input\_length+1\)</span><br> 1. Hidden_layer_1: (43+1)x(40) = 1760<br> 2. Hidden_layer_2: (40+1)x(40) = 1640<br> 3. Hidden_layer_3: (40+1)x(40) = 1640<br> 4. Output_layer: (40+1)x(1) = 41 </p> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</code></pre></div> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ<span style="font-weight: bold"> Layer (type)                         </span>â”ƒ<span style="font-weight: bold"> Output Shape                </span>â”ƒ<span style="font-weight: bold">         Param # </span>â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ Hidden_layer_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)               â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>)                  â”‚           <span style="color: #00af00; text-decoration-color: #00af00">1,760</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dropout_layer_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)            â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>)                  â”‚               <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Hidden_layer_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)               â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>)                  â”‚           <span style="color: #00af00; text-decoration-color: #00af00">1,640</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dropout_layer_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)            â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>)                  â”‚               <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Hidden_layer_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)               â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>)                  â”‚           <span style="color: #00af00; text-decoration-color: #00af00">1,640</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dropout_layer_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)            â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>)                  â”‚               <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Output_layer (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)                   â”‚              <span style="color: #00af00; text-decoration-color: #00af00">41</span> â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">5,081</span> (19.85 KB)
</pre> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">5,081</span> (19.85 KB)
</pre> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre> <h3 id=dense-layer>Dense layer<a class=headerlink href=#dense-layer title="Permanent link">&para;</a></h3> <p>A dense layer is a fully connected layer of neurons that receives input from every neuron in the previous layer. </p> <h3 id=dropout>Dropout<a class=headerlink href=#dropout title="Permanent link">&para;</a></h3> <p>Dropout is the most popular form of regularization technique in which certain nodes are ignored at random during training. Adding dropout layer improves accuracy by 1-2% on average. In a dropout layer, at any training step, every neuron in the previous layer has a probability (equal to the rate) of dropping out. This dropped-out node may be active in the following step/epoch. Dropouts are said to improve the resilience of the network.</p> <div class=highlight><pre><span></span><code><span class=n>accuracy_metrics</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s2>&quot;accuracy&quot;</span><span class=p>,</span> <span class=s2>&quot;Recall&quot;</span><span class=p>,</span> <span class=s2>&quot;Precision&quot;</span><span class=p>,</span>
    <span class=n>keras</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>FalseNegatives</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;fn&quot;</span><span class=p>),</span>
    <span class=n>keras</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>FalsePositives</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;fp&quot;</span><span class=p>),</span>
    <span class=n>keras</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>TrueNegatives</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;tn&quot;</span><span class=p>),</span>
    <span class=n>keras</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>TruePositives</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;tp&quot;</span><span class=p>)</span>
<span class=p>]</span>
<span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>loss</span><span class=o>=</span><span class=s2>&quot;binary_crossentropy&quot;</span><span class=p>,</span>  <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;sgd&quot;</span><span class=p>,</span>  <span class=n>metrics</span><span class=o>=</span><span class=n>accuracy_metrics</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>x_train</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;float32&#39;</span><span class=p>)</span>
<span class=n>x_test</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>x_test</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;float32&#39;</span><span class=p>)</span>
<span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>y_train</span><span class=p>)</span>
<span class=n>y_test</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>y_test</span><span class=p>)</span>
</code></pre></div> <p>There is a huge imbalance in the data. To balance the data, we are giving weights inversely proportional to the class frequency.</p> <div class=highlight><pre><span></span><code><span class=n>class_weights</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>:</span><span class=nb>len</span><span class=p>(</span><span class=n>y_train</span><span class=p>)</span><span class=o>/</span><span class=nb>sum</span><span class=p>(</span><span class=n>y_train</span><span class=o>==</span><span class=mi>0</span><span class=p>),</span> <span class=mi>1</span><span class=p>:</span><span class=nb>len</span><span class=p>(</span><span class=n>y_train</span><span class=p>)</span><span class=o>/</span><span class=nb>sum</span><span class=p>(</span><span class=n>y_train</span><span class=o>==</span><span class=mi>1</span><span class=p>)}</span>
<span class=n>class_weights</span>
</code></pre></div> <div class=highlight><pre><span></span><code>{0: 1.0510368973875572, 1: 20.593667546174142}
</code></pre></div> <p>Fitting the model for 100 epochs</p> <div class=highlight><pre><span></span><code><span class=n>history</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>class_weight</span> <span class=o>=</span> <span class=n>class_weights</span><span class=p>,</span>
                    <span class=n>validation_data</span><span class=o>=</span><span class=p>(</span><span class=n>x_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>))</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Epoch 1/100
[1m732/732[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m28s[0m 19ms/step - Precision: 0.1112 - Recall: 0.8066 - accuracy: 0.6257 - fn: 99.5225 - fp: 3282.3589 - loss: 1.0544 - tn: 7889.6426 - tp: 472.4079 - val_Precision: 0.3554 - val_Recall: 0.9713 - val_accuracy: 0.9131 - val_fn: 14.0000 - val_fp: 858.0000 - val_loss: 0.1859 - val_tn: 8691.0000 - val_tp: 473.0000
Epoch 2/100
[1m732/732[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m20s[0m 3ms/step - Precision: 0.3235 - Recall: 0.9479 - accuracy: 0.9039 - fn: 25.8117 - fp: 1097.6139 - loss: 0.3903 - tn: 10080.3906 - tp: 540.1160 - val_Precision: 0.3596 - val_Recall: 0.9754 - val_accuracy: 0.9145 - val_fn: 12.0000 - val_fp: 846.0000 - val_loss: 0.1720 - val_tn: 8703.0000 - val_tp: 475.0000  
...  
Epoch 99/100
[1m732/732[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m2s[0m 3ms/step - Precision: 0.7615 - Recall: 0.9984 - accuracy: 0.9843 - fn: 1.4175 - fp: 175.1992 - loss: 0.0620 - tn: 10987.0146 - tp: 580.3001 - val_Precision: 0.7193 - val_Recall: 0.9733 - val_accuracy: 0.9803 - val_fn: 13.0000 - val_fp: 185.0000 - val_loss: 0.0606 - val_tn: 9364.0000 - val_tp: 474.0000
Epoch 100/100
[1m732/732[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m3s[0m 5ms/step - Precision: 0.7601 - Recall: 0.9945 - accuracy: 0.9838 - fn: 2.8240 - fp: 191.1937 - loss: 0.0642 - tn: 10956.5742 - tp: 593.3397 - val_Precision: 0.7302 - val_Recall: 0.9671 - val_accuracy: 0.9811 - val_fn: 16.0000 - val_fp: 174.0000 - val_loss: 0.0541 - val_tn: 9375.0000 - val_tp: 471.0000
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>loss_</span><span class=p>,</span> <span class=n>accuracy_</span><span class=p>,</span> <span class=n>recall_</span><span class=p>,</span> <span class=n>precision_</span><span class=p>,</span> <span class=n>fn_</span><span class=p>,</span> <span class=n>fp_</span><span class=p>,</span> <span class=n>tn_</span><span class=p>,</span> <span class=n>tp_</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>x_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;The accuracy metrics on the training data are: loss:&#39;</span><span class=p>,</span> <span class=nb>round</span><span class=p>(</span><span class=n>loss_</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=s1>&#39; accuracy:&#39;</span><span class=p>,</span> <span class=nb>round</span><span class=p>(</span><span class=n>accuracy_</span><span class=p>,</span><span class=mi>3</span><span class=p>),</span>
     <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Precision:&quot;</span><span class=p>,</span> <span class=nb>round</span><span class=p>(</span><span class=n>precision_</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span> <span class=s1>&#39; Recall:&#39;</span><span class=p>,</span> <span class=nb>round</span><span class=p>(</span><span class=n>recall_</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span>
     <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Confusion matrix</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span>
     <span class=n>tp_</span><span class=p>,</span> <span class=s2>&quot;</span><span class=se>\t</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>tn_</span><span class=p>,</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>fp_</span><span class=p>,</span> <span class=s2>&quot;</span><span class=se>\t</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>fn_</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[1m314/314[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 2ms/step - Precision: 0.7230 - Recall: 0.9664 - accuracy: 0.9813 - fn: 8.0000 - fp: 85.9492 - loss: 0.0489 - tn: 4730.8032 - tp: 231.0698
The accuracy metrics on the training data are: loss: 0.0541  accuracy: 0.981 
Precision: 0.73  Recall: 0.97 
Confusion matrix
 471.0   9375.0 
 174.0   16.0
</code></pre></div> <p>The learning curves with the train and test accuracy, precision, and recall are plotted below.</p> <div class=highlight><pre><span></span><code><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>history</span><span class=o>.</span><span class=n>history</span><span class=p>)[[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;Precision&#39;</span><span class=p>,</span> <span class=s1>&#39;Recall&#39;</span><span class=p>,</span> <span class=s1>&#39;val_accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;val_Precision&#39;</span><span class=p>,</span> <span class=s1>&#39;val_Recall&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
<span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;Epochs&quot;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Accuracy&quot;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&quot;Learning curves&quot;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><img alt=png src=output_20_0.png></p> <p>The accuracy metrics of the model on the train data are as follows:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>confusion_matrix</span>
<span class=n>y_test_pred</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_test</span><span class=p>)</span><span class=o>&lt;</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_test_pred</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;confusion matrix&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_test_pred</span><span class=p>))</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[1m314/314[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 2ms/step
              precision    recall  f1-score   support

           0       1.00      0.98      0.99      9549
           1       0.73      0.97      0.83       487

    accuracy                           0.98     10036
   macro avg       0.86      0.97      0.91     10036
weighted avg       0.99      0.98      0.98     10036

confusion matrix
[[9375  174]
 [  16  471]]
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>keras</span><span class=o>.</span><span class=n>utils</span><span class=o>.</span><span class=n>plot_model</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=s2>&quot;absenteeism.png&quot;</span><span class=p>,</span> <span class=n>show_shapes</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><img alt=png src=output_23_0.png></p> <p>The training accuracy is</p> <div class=highlight><pre><span></span><code><span class=n>y_train_pred</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_train</span><span class=p>)</span><span class=o>&lt;</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_train</span><span class=p>,</span> <span class=n>y_train_pred</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Confusion metrix&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_train</span><span class=p>,</span> <span class=n>y_train_pred</span><span class=p>))</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[1m732/732[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m2s[0m 3ms/step
              precision    recall  f1-score   support

           0       1.00      0.98      0.99     22278
           1       0.77      1.00      0.87      1137

    accuracy                           0.99     23415
   macro avg       0.88      0.99      0.93     23415
weighted avg       0.99      0.99      0.99     23415

Confusion metrix
[[21933   345]
 [    0  1137]]
</code></pre></div> <p>Saving the model</p> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&quot;my_keras_model.keras&quot;</span><span class=p>)</span>
<span class=n>model</span><span class=o>.</span><span class=n>save_weights</span><span class=p>(</span><span class=s2>&quot;my_keras_weights.weights.h5&quot;</span><span class=p>)</span>
</code></pre></div> <p>The accuracy of this initial model is very good and is very similar to the accuracy in the machine learning blog. But still, can we improve on this accuracy? Let's look at some ways we can improve any neural network model.</p> <h2 id=vanishing-gradientsexploding-gradients-problem>Vanishing gradients/exploding gradients problem<a class=headerlink href=#vanishing-gradientsexploding-gradients-problem title="Permanent link">&para;</a></h2> <p>The backpropagation algorithm works by propagating the error gradient from the outer layer to the lower layers. Sometimes the gradients in the lower layers get smaller and smaller or larger and larger when flowing in DNN during training. This makes the lower layers hard to train.</p> <p>In the logistic activation function, for example, if the inputs become extremely large or extremely small, the function saturates at 1 or 0 with a derivative close to 0. This means there will be no gradient to propagate back to the lower layers.</p> <p>To reduce unstable gradients, the variance of the outputs of each layer should be equal to the variance of its inputs (the gradients should also have equal variance) after the forward and backward passes.</p> <p>Fine-tuning can not only help us find the best parameters but can also help us prevent vanishing or exploding gradients.</p> <h2 id=fine-tuning-neural-network-hyperparameters>Fine-tuning neural network hyperparameters<a class=headerlink href=#fine-tuning-neural-network-hyperparameters title="Permanent link">&para;</a></h2> <p>There are multiple hyperparameters in a neural network that can be tweaked, like network architecture, number of hidden layers, number of neurons in each layer, type of activation function, and more. Many libraries can be used to handle these, like <em>hyperopt</em>, <em>hyperas</em>, <em>keras tuner</em>, <em>scikit optimise</em>, <em>spearmint</em>, <em>hyperband</em>, etc. The first step is to create a function that can build and compile a Keras model.</p> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>build_model</span><span class=p>(</span><span class=n>n_hidden</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_neurons</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.001</span><span class=p>,</span> <span class=n>hidden_layer_activation</span> <span class=o>=</span> <span class=s1>&#39;relu&#39;</span><span class=p>,</span> <span class=n>kernel_initializer</span> <span class=o>=</span> <span class=s1>&#39;he_normal&#39;</span><span class=p>,</span> <span class=n>input_shape</span><span class=o>=</span><span class=p>[</span><span class=n>input_length</span><span class=p>],</span>
                <span class=n>kernel_regularizer</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>kernel_constraint</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dropout_rate</span> <span class=o>=</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;sgd&#39;</span><span class=p>):</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>()</span>
    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>InputLayer</span><span class=p>(</span><span class=n>input_shape</span><span class=o>=</span><span class=n>input_shape</span><span class=p>))</span>
    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>BatchNormalization</span><span class=p>())</span>
    <span class=k>for</span> <span class=n>layer</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_hidden</span><span class=p>):</span>
        <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=n>n_neurons</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=n>hidden_layer_activation</span><span class=p>,</span> <span class=n>kernel_initializer</span><span class=o>=</span><span class=n>kernel_initializer</span><span class=p>,</span>
                                     <span class=n>kernel_regularizer</span><span class=o>=</span><span class=n>kernel_regularizer</span><span class=p>,</span> <span class=n>kernel_constraint</span><span class=o>=</span><span class=n>kernel_constraint</span><span class=p>))</span>
        <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dropout</span><span class=p>(</span><span class=n>rate</span><span class=o>=</span><span class=n>dropout_rate</span><span class=p>))</span>
    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;sigmoid&#39;</span><span class=p>))</span>
    <span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>loss</span><span class=o>=</span><span class=s2>&quot;binary_crossentropy&quot;</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=n>accuracy_metrics</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=n>optimizer</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>optimizer</span><span class=o>.</span><span class=n>learning_rate</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>learning_rate</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>model</span>
</code></pre></div> <p>This function demonstrates some of the popular hyperparameters that can be used. Let's look at each one of them: </p> <h3 id=number-of-hidden-layers>Number of hidden layers<a class=headerlink href=#number-of-hidden-layers title="Permanent link">&para;</a></h3> <p>Theoretically, one hidden layer will be able to model any complex function, but it will require many neurons in that layer and will require exponentially more training parameters when compared to deep networks with a smaller number of neurons in each layer. Hierarchical structures help DNNs converge faster and generalize better on new and unseen datasets. The neurons that are in layers closer to the input layer (low-level layers) model low-level structures and higher-level layers build on these low-level structures to build higher-level structures. </p> <h3 id=number-of-neurons-per-hidden-layer>Number of neurons per hidden layer<a class=headerlink href=#number-of-neurons-per-hidden-layer title="Permanent link">&para;</a></h3> <p>There are two approaches to the number of neurons in a hidden layer. One is to stack them like a pyramid, with more neurons at hidden layers close to the input layers and decreasing them up to the output layer. The other is to have the same number of neurons in all layers. I prefer the second method because it is easier to have a larger number of neurons than needed and then to use early stopping and other regularization techniques to prevent overfitting.</p> <h3 id=batch-size>Batch size<a class=headerlink href=#batch-size title="Permanent link">&para;</a></h3> <p>The batch size should be dependent on the type of GPUs and TPUs that are used. For regular datasets, a batch size of 32 is most optimal. Larger batch sizes have faster training but do not converge faster, while smaller batch sizes converge in a smaller number of epochs, but each epoch takes longer to train.</p> <h3 id=activation-function>Activation function<a class=headerlink href=#activation-function title="Permanent link">&para;</a></h3> <p>For output neurons, the activation functions are as follows:</p> <table> <thead> <tr> <th>Problem Type</th> <th>Output layer activation functions</th> </tr> </thead> <tbody> <tr> <td>Binary classification</td> <td>Logistic</td> </tr> <tr> <td>Multiclass classification</td> <td>Softmax</td> </tr> <tr> <td>Regression</td> <td>None,ReLU/softplus(+vs outputs), logistic/tanh(bounded outputs)</td> </tr> </tbody> </table> <p>For regular DNNs, the activation function for hidden neurons is generally ReLU. ReLU's face issues known as <em>dying RELU</em>, where they output only 0. There are several varieties of ReLU to solve this problem.</p> <h4 id=leaky-relu>Leaky Relu<a class=headerlink href=#leaky-relu title="Permanent link">&para;</a></h4> <p>In Leaky ReLU, a hyperparameter <span class=arithmatex>\(\alpha\)</span> defines the slope of the function for negative values of z. This is called a leak, which prevents ReLUs from dying. $$ LeakyReLU(z) = max(\alpha z, z)$$</p> <h4 id=selu>SELU<a class=headerlink href=#selu title="Permanent link">&para;</a></h4> <p>The scaled Exponential Linear Unit is the best variant of ReLU, where an exponential function is used for negative input values in such a way that the slope at 0 is non-zero.</p> <div class=arithmatex>\[ ELU_{\alpha}(z) =\begin{cases} \alpha(exp(z)-1) &amp; z &lt; 0 \\ z &amp; z \geq 0 \end{cases} \]</div> <p>IIf a deep neural network consists of only SELUs as the activation function in all of the hidden layers, the data will self-normalize. The output of every layer will have a mean of zero and a standard deviation of one. This will reduce the vanishing gradients problem.</p> <h3 id=optimizer>Optimizer<a class=headerlink href=#optimizer title="Permanent link">&para;</a></h3> <p>The optimizer used also changes the speed of training. Apart from gradient descent, another popular optimizer is the Adam optimizer. </p> <h3 id=batch-normalisation>Batch normalisation<a class=headerlink href=#batch-normalisation title="Permanent link">&para;</a></h3> <p>The normalization layer normalizes the input data in such a way that the mean of the input is zero and the standard deviation is one. This can prevent the vanishing gradient issue as it forces the input and output variances to be constant at one. </p> <h3 id=weight-initialisation>Weight initialisation<a class=headerlink href=#weight-initialisation title="Permanent link">&para;</a></h3> <p>Garot and He initialization can be used to initialize the weights in the network in such a way that the vanishing and exploding gradients can be reduced. </p> <table> <thead> <tr> <th>Initialization</th> <th>Activation functions</th> </tr> </thead> <tbody> <tr> <td>Glorot</td> <td>None, Tanh, Logistic, Softmax</td> </tr> <tr> <td>He</td> <td>ReLU and variants</td> </tr> <tr> <td>LeCun</td> <td>SELU</td> </tr> </tbody> </table> <h3 id=gradient-clipping>Gradient clipping<a class=headerlink href=#gradient-clipping title="Permanent link">&para;</a></h3> <p>One way to reduce the vanishing gradient problem is to clip the gradients so that they never exceed a threshold during backpropagation. </p> <h3 id=regularization-l1-and-l2>Regularization (l1 and l2)<a class=headerlink href=#regularization-l1-and-l2 title="Permanent link">&para;</a></h3> <p>L1 regularizations can be applied to the gradients to constrain the weights of the network. L2 regularization can force many weights to be zero, making a sparse network. These can help in regularizing the weights of the network.</p> <p>One of the ways to find the optimized parameters is to use Grid Search CV for a smaller number of epochs and then train the best model until stopping criteria is met.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>scikeras.wrappers</span><span class=w> </span><span class=kn>import</span> <span class=n>KerasClassifier</span>
<span class=n>keras_reg</span> <span class=o>=</span> <span class=n>KerasClassifier</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>build_model</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>25</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomizedSearchCV</span><span class=p>,</span> <span class=n>GridSearchCV</span>

<span class=n>param_distribs</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>&quot;model__n_hidden&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>],</span>
    <span class=s2>&quot;model__n_neurons&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>30</span><span class=p>],</span>
    <span class=s2>&quot;model__learning_rate&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.001</span><span class=p>],</span>
    <span class=s2>&quot;model__hidden_layer_activation&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;relu&#39;</span><span class=p>,</span> <span class=s2>&quot;elu&quot;</span><span class=p>],</span>
    <span class=s2>&quot;model__kernel_initializer&quot;</span><span class=p>:[</span><span class=s2>&quot;he_normal&quot;</span><span class=p>,</span> <span class=s2>&quot;lecun_normal&quot;</span><span class=p>,</span> <span class=n>keras</span><span class=o>.</span><span class=n>initializers</span><span class=o>.</span><span class=n>VarianceScaling</span><span class=p>(</span><span class=n>scale</span><span class=o>=</span><span class=mf>2.</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;fan_avg&#39;</span><span class=p>,</span> <span class=n>distribution</span><span class=o>=</span><span class=s1>&#39;uniform&#39;</span><span class=p>)],</span>
    <span class=s2>&quot;model__kernel_regularizer&quot;</span><span class=p>:[</span><span class=kc>None</span><span class=p>,</span> <span class=n>keras</span><span class=o>.</span><span class=n>regularizers</span><span class=o>.</span><span class=n>l2</span><span class=p>(</span><span class=mf>0.01</span><span class=p>)],</span>
    <span class=s2>&quot;model__kernel_constraint&quot;</span><span class=p>:[</span><span class=kc>None</span><span class=p>,</span> <span class=n>keras</span><span class=o>.</span><span class=n>constraints</span><span class=o>.</span><span class=n>max_norm</span><span class=p>(</span><span class=mf>1.</span><span class=p>)],</span>
    <span class=s2>&quot;model__dropout_rate&quot;</span><span class=p>:[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>],</span>
    <span class=s2>&quot;model__optimizer&quot;</span><span class=p>:[</span><span class=s1>&#39;adam&#39;</span><span class=p>,</span> <span class=s2>&quot;sgd&quot;</span><span class=p>,</span> <span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>clipvalue</span><span class=o>=</span><span class=mf>1.0</span><span class=p>),</span> <span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>clipnorm</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)],</span>
    <span class=s2>&quot;batch_size&quot;</span><span class=p>:[</span><span class=mi>32</span><span class=p>,</span> <span class=mi>1000</span><span class=p>],</span>
    <span class=s2>&quot;epochs&quot;</span><span class=p>:[</span><span class=mi>50</span><span class=p>],</span>
<span class=p>}</span>

<span class=n>rnd_search_cv</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>keras_reg</span><span class=p>,</span> <span class=n>param_distribs</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>validation_data</span><span class=o>=</span><span class=p>(</span><span class=n>x_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>),</span> <span class=n>class_weight</span> <span class=o>=</span> <span class=n>class_weights</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Fitting 5 folds for each of 768 candidates, totalling 3840 fits

Epoch 1/50
19/19 - 13s - 678ms/step - Precision: 0.0542 - Recall: 0.0945 - accuracy: 0.8759 - fn: 986.0000 - fp: 5238.0000 - loss: 1.8458 - tn: 39955.0000 - tp: 1321.0000 - val_Precision: 0.0480 - val_Recall: 0.0554 - val_accuracy: 0.9009 - val_fn: 460.0000 - val_fp: 535.0000 - val_loss: 0.3782 - val_tn: 9014.0000 - val_tp: 27.0000
Epoch 2/50
19/19 - 0s - 10ms/step - Precision: 0.0507 - Recall: 0.1473 - accuracy: 0.8246 - fn: 776.0000 - fp: 2510.0000 - loss: 1.6876 - tn: 15312.0000 - tp: 134.0000 - val_Precision: 0.0590 - val_Recall: 0.1417 - val_accuracy: 0.8486 - val_fn: 418.0000 - val_fp: 1101.0000 - val_loss: 0.4418 - val_tn: 8448.0000 - val_tp: 69.0000
...
Epoch 49/50
19/19 - 0s - 7ms/step - Precision: 0.1297 - Recall: 0.7703 - accuracy: 0.7377 - fn: 209.0000 - fp: 4704.0000 - loss: 1.0418 - tn: 13118.0000 - tp: 701.0000 - val_Precision: 0.1510 - val_Recall: 0.8604 - val_accuracy: 0.7586 - val_fn: 68.0000 - val_fp: 2355.0000 - val_loss: 0.5031 - val_tn: 7194.0000 - val_tp: 419.0000
Epoch 50/50
19/19 - 0s - 6ms/step - Precision: 0.1290 - Recall: 0.7659 - accuracy: 0.7373 - fn: 213.0000 - fp: 4708.0000 - loss: 1.0323 - tn: 13114.0000 - tp: 697.0000 - val_Precision: 0.1520 - val_Recall: 0.8645 - val_accuracy: 0.7594 - val_fn: 66.0000 - val_fp: 2349.0000 - val_loss: 0.4998 - val_tn: 7200.0000 - val_tp: 421.0000
5/5 - 0s - 70ms/step
[CV] END batch_size=1000, epochs=50, model__hidden_layer_activation=relu, model__kernel_regularizer=None, model__n_hidden=3, model__n_neurons=30; total time=  26.2s
Epoch 1/50
...
[CV] END batch_size=1000, epochs=50, model__hidden_layer_activation=relu, model__kernel_regularizer=None, model__n_hidden=3, model__n_neurons=30; total time=  22.0s
Epoch 1/50
...
...
Epoch 49/50
24/24 - 0s - 12ms/step - Precision: 0.1745 - Recall: 0.8751 - accuracy: 0.7929 - fn: 142.0000 - fp: 4708.0000 - loss: 0.7878 - tn: 17570.0000 - tp: 995.0000 - val_Precision: 0.1963 - val_Recall: 0.9671 - val_accuracy: 0.8062 - val_fn: 16.0000 - val_fp: 1929.0000 - val_loss: 0.4336 - val_tn: 7620.0000 - val_tp: 471.0000
Epoch 50/50
24/24 - 0s - 12ms/step - Precision: 0.1766 - Recall: 0.8865 - accuracy: 0.7938 - fn: 129.0000 - fp: 4700.0000 - loss: 0.7704 - tn: 17578.0000 - tp: 1008.0000 - val_Precision: 0.1986 - val_Recall: 0.9671 - val_accuracy: 0.8090 - val_fn: 16.0000 - val_fp: 1901.0000 - val_loss: 0.4287 - val_tn: 7648.0000 - val_tp: 471.0000
</code></pre></div> <style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "â–¸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "â–¾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style> <div id=sk-container-id-1 class=sk-top-container><div class=sk-text-repr-fallback><pre>GridSearchCV(cv=5,
             estimator=KerasClassifier(batch_size=32, epochs=25, model=&lt;function build_model at 0x7b760e5b67a0&gt;, verbose=2),
             param_grid={&#x27;batch_size&#x27;: [1000], &#x27;epochs&#x27;: [50],
                         &#x27;model__hidden_layer_activation&#x27;: [&#x27;relu&#x27;, &#x27;elu&#x27;],
                         &#x27;model__kernel_regularizer&#x27;: [None,
                                                       &lt;keras.src.regularizers.regularizers.L2 object at 0x7b760de7ed40&gt;],
                         &#x27;model__n_hidden&#x27;: [3], &#x27;model__n_neurons&#x27;: [30]},
             verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=sk-container hidden><div class="sk-item sk-dashed-wrapped"><div class=sk-label-container><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-1 type=checkbox><label for=sk-estimator-id-1 class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel=noreferrer target=_blank href=https://scikit-learn.org/1.4/modules/generated/sklearn.model_selection.GridSearchCV.html>?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5,
             estimator=KerasClassifier(batch_size=32, epochs=25, model=&lt;function build_model at 0x7b760e5b67a0&gt;, verbose=2),
             param_grid={&#x27;batch_size&#x27;: [1000], &#x27;epochs&#x27;: [50],
                         &#x27;model__hidden_layer_activation&#x27;: [&#x27;relu&#x27;, &#x27;elu&#x27;],
                         &#x27;model__kernel_regularizer&#x27;: [None,
                                                       &lt;keras.src.regularizers.regularizers.L2 object at 0x7b760de7ed40&gt;],
                         &#x27;model__n_hidden&#x27;: [3], &#x27;model__n_neurons&#x27;: [30]},
             verbose=2)</pre></div> </div></div><div class=sk-parallel><div class=sk-parallel-item><div class=sk-item><div class=sk-label-container><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-2 type=checkbox><label for=sk-estimator-id-2 class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">estimator: KerasClassifier</label><div class="sk-toggleable__content fitted"><pre>KerasClassifier(
    model=&lt;function build_model at 0x7b760e5b67a0&gt;
    build_fn=None
    warm_start=False
    random_state=None
    optimizer=rmsprop
    loss=None
    metrics=None
    batch_size=32
    validation_batch_size=None
    verbose=2
    callbacks=None
    validation_split=0.0
    shuffle=True
    run_eagerly=False
    epochs=25
    class_weight=None
)</pre></div> </div></div><div class=sk-serial><div class=sk-item><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-3 type=checkbox><label for=sk-estimator-id-3 class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">KerasClassifier</label><div class="sk-toggleable__content fitted"><pre>KerasClassifier(
    model=&lt;function build_model at 0x7b760e5b67a0&gt;
    build_fn=None
    warm_start=False
    random_state=None
    optimizer=rmsprop
    loss=None
    metrics=None
    batch_size=32
    validation_batch_size=None
    verbose=2
    callbacks=None
    validation_split=0.0
    shuffle=True
    run_eagerly=False
    epochs=25
    class_weight=None
)</pre></div> </div></div></div></div></div></div></div></div></div> <p>The best model is</p> <div class=highlight><pre><span></span><code><span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>best_estimator_</span>
</code></pre></div> <style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "â–¸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "â–¾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style> <div id=sk-container-id-2 class=sk-top-container><div class=sk-text-repr-fallback><pre>KerasClassifier(
    model=&lt;function build_model at 0x7b760e5b67a0&gt;
    build_fn=None
    warm_start=False
    random_state=None
    optimizer=rmsprop
    loss=None
    metrics=None
    batch_size=1000
    validation_batch_size=None
    verbose=2
    callbacks=None
    validation_split=0.0
    shuffle=True
    run_eagerly=False
    epochs=50
    class_weight=None
    model__hidden_layer_activation=elu
    model__kernel_regularizer=None
    model__n_hidden=3
    model__n_neurons=30
)</pre></div><div class=sk-container hidden><div class=sk-item><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-4 type=checkbox checked><label for=sk-estimator-id-4 class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;KerasClassifier<span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>KerasClassifier(
    model=&lt;function build_model at 0x7b760e5b67a0&gt;
    build_fn=None
    warm_start=False
    random_state=None
    optimizer=rmsprop
    loss=None
    metrics=None
    batch_size=1000
    validation_batch_size=None
    verbose=2
    callbacks=None
    validation_split=0.0
    shuffle=True
    run_eagerly=False
    epochs=50
    class_weight=None
    model__hidden_layer_activation=elu
    model__kernel_regularizer=None
    model__n_hidden=3
    model__n_neurons=30
)</pre></div> </div></div></div></div> <div class=highlight><pre><span></span><code><span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>best_params_</span>
</code></pre></div> <div class=highlight><pre><span></span><code>{&#39;batch_size&#39;: 1000,
 &#39;epochs&#39;: 50,
 &#39;model__hidden_layer_activation&#39;: &#39;elu&#39;,
 &#39;model__kernel_regularizer&#39;: None,
 &#39;model__n_hidden&#39;: 3,
 &#39;model__n_neurons&#39;: 30}
</code></pre></div> <p>Accuracy metrics for the best model are:</p> <div class=highlight><pre><span></span><code><span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>best_score_</span>
</code></pre></div> <div class=highlight><pre><span></span><code>0.792568866111467
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>x_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>11/11 - 0s - 33ms/step
0.8089876444798725
</code></pre></div> <h2 id=training-the-best-model>Training the best model<a class=headerlink href=#training-the-best-model title="Permanent link">&para;</a></h2> <p>Once we find the best hyperparameters, we can use those to further train the model.</p> <h3 id=learning-rate-scheduling>Learning rate scheduling<a class=headerlink href=#learning-rate-scheduling title="Permanent link">&para;</a></h3> <p>A very high learning rate might diverge and never reach optimum while a small learning rate will take a long time to arrive at A very high learning rate might diverge and never reach optimum, while a small learning rate will take a long time to reach optimum. Instead, we can train the model with a large learning rate at first and then gradually cross epochs. <em>Reduce Learning Rate on Plateau</em> is a method where the learning rate is reduced by a factor once the loss function stagnates.</p> <h3 id=early-stopping-and-model-checkpoints>Early stopping and model checkpoints<a class=headerlink href=#early-stopping-and-model-checkpoints title="Permanent link">&para;</a></h3> <p>Model checkpoints and early stopping can be used when training a large number of epochs. Early stopping is a stopping criterion to stop training when the loss metric stagnates. Additionally, model checkpoints can also help in resuming training from the last saved point in case of interruptions or failures during the training process. This ensures that the training progress is not lost and can be continued seamlessly.</p> <div class=highlight><pre><span></span><code><span class=n>lr_scheduler</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>callbacks</span><span class=o>.</span><span class=n>ReduceLROnPlateau</span><span class=p>(</span><span class=n>factor</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> <span class=n>patience</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=n>early_stopping</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>callbacks</span><span class=o>.</span><span class=n>EarlyStopping</span><span class=p>(</span><span class=n>patience</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>min_delta</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=n>checkpoint_cb</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>callbacks</span><span class=o>.</span><span class=n>ModelCheckpoint</span><span class=p>(</span><span class=s2>&quot;my_optimised_keras_model.keras&quot;</span><span class=p>,</span> <span class=n>save_best_only</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>model2</span> <span class=o>=</span> <span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>best_estimator_</span><span class=o>.</span><span class=n>model_</span>
<span class=n>history</span> <span class=o>=</span> <span class=n>model2</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>class_weight</span> <span class=o>=</span> <span class=n>class_weights</span><span class=p>,</span>
                    <span class=n>validation_data</span><span class=o>=</span><span class=p>(</span><span class=n>x_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>),</span>
                    <span class=n>callbacks</span><span class=o>=</span><span class=p>[</span><span class=n>checkpoint_cb</span><span class=p>,</span> <span class=n>early_stopping</span><span class=p>,</span> <span class=n>lr_scheduler</span><span class=p>],</span>
                    <span class=n>epochs</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>best_estimator_</span><span class=o>.</span><span class=n>batch_size</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Epoch 1/1000
[1m24/24[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m11s[0m 249ms/step - Precision: 0.1848 - Recall: 0.9000 - accuracy: 0.8013 - fn: 67.6000 - fp: 2496.9199 - loss: 0.7515 - tn: 9787.3604 - tp: 561.3200 - val_Precision: 0.2011 - val_Recall: 0.9671 - val_accuracy: 0.8120 - val_fn: 16.0000 - val_fp: 1871.0000 - val_loss: 0.4257 - val_tn: 7678.0000 - val_tp: 471.0000 - learning_rate: 0.0010  
...  
Epoch 156/1000
[1m24/24[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 15ms/step - Precision: 0.3215 - Recall: 0.9418 - accuracy: 0.9013 - fn: 36.9600 - fp: 1237.6000 - loss: 0.4189 - tn: 11053.1602 - tp: 585.4800 - val_Precision: 0.3214 - val_Recall: 0.9795 - val_accuracy: 0.8987 - val_fn: 10.0000 - val_fp: 1007.0000 - val_loss: 0.2359 - val_tn: 8542.0000 - val_tp: 477.0000 - learning_rate: 0.0010
Epoch 157/1000
[1m24/24[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 18ms/step - Precision: 0.3173 - Recall: 0.9483 - accuracy: 0.8995 - fn: 34.7600 - fp: 1247.2000 - loss: 0.4196 - tn: 11047.0801 - tp: 584.1600 - val_Precision: 0.3212 - val_Recall: 0.9795 - val_accuracy: 0.8986 - val_fn: 10.0000 - val_fp: 1008.0000 - val_loss: 0.2365 - val_tn: 8541.0000 - val_tp: 477.0000 - learning_rate: 0.0010
Epoch 158/1000
[1m24/24[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 12ms/step - Precision: 0.3330 - Recall: 0.9419 - accuracy: 0.9040 - fn: 35.3600 - fp: 1211.6000 - loss: 0.4260 - tn: 11074.6797 - tp: 591.5600 - val_Precision: 0.3210 - val_Recall: 0.9795 - val_accuracy: 0.8985 - val_fn: 10.0000 - val_fp: 1009.0000 - val_loss: 0.2369 - val_tn: 8540.0000 - val_tp: 477.0000 - learning_rate: 0.0010
Epoch 159/1000
[1m24/24[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 13ms/step - Precision: 0.3331 - Recall: 0.9570 - accuracy: 0.9031 - fn: 27.6000 - fp: 1231.7200 - loss: 0.4086 - tn: 11051.5195 - tp: 602.3600 - val_Precision: 0.3212 - val_Recall: 0.9795 - val_accuracy: 0.8986 - val_fn: 10.0000 - val_fp: 1008.0000 - val_loss: 0.2365 - val_tn: 8541.0000 - val_tp: 477.0000 - learning_rate: 0.0010
Epoch 160/1000
[1m24/24[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 6ms/step - Precision: 0.3231 - Recall: 0.9429 - accuracy: 0.9010 - fn: 31.8000 - fp: 1237.9200 - loss: 0.4298 - tn: 11047.8799 - tp: 595.6000 - val_Precision: 0.3223 - val_Recall: 0.9795 - val_accuracy: 0.8991 - val_fn: 10.0000 - val_fp: 1003.0000 - val_loss: 0.2358 - val_tn: 8546.0000 - val_tp: 477.0000 - learning_rate: 0.0010
</code></pre></div> <p>Accuracy metrics and error</p> <div class=highlight><pre><span></span><code><span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>rnd_search_cv</span><span class=o>.</span><span class=n>best_estimator_</span><span class=o>.</span><span class=n>history_</span><span class=p>),</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>history</span><span class=o>.</span><span class=n>history</span><span class=p>)])</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()[[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;Precision&#39;</span><span class=p>,</span> <span class=s1>&#39;Recall&#39;</span><span class=p>,</span> <span class=s1>&#39;val_accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;val_Precision&#39;</span><span class=p>,</span> <span class=s1>&#39;val_Recall&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
<span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;Epochs&quot;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Accuracy&quot;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&quot;Learning curves&quot;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><img alt=png src=output_44_0.png></p> <div class=highlight><pre><span></span><code><span class=n>y_test_pred</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>model2</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_test</span><span class=p>)</span><span class=o>&lt;</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_test_pred</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Confusion matrix&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_test_pred</span><span class=p>))</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[1m314/314[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 2ms/step
              precision    recall  f1-score   support

           0       1.00      0.89      0.94      9549
           1       0.32      0.98      0.49       487

    accuracy                           0.90     10036
   macro avg       0.66      0.94      0.71     10036
weighted avg       0.97      0.90      0.92     10036

Confusion matrix
[[8546 1003]
 [  10  477]]
</code></pre></div> <p>Loading the best model that is saved</p> <div class=highlight><pre><span></span><code><span class=n>loaded_model</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>models</span><span class=o>.</span><span class=n>load_model</span><span class=p>(</span><span class=s2>&quot;my_optimised_keras_model.keras&quot;</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>y_test_pred</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>loaded_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_test</span><span class=p>)</span><span class=o>&lt;</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_test_pred</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_test_pred</span><span class=p>))</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[1m314/314[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 2ms/step
              precision    recall  f1-score   support

           0       1.00      0.89      0.94      9549
           1       0.32      0.98      0.48       487

    accuracy                           0.90     10036
   macro avg       0.66      0.94      0.71     10036
weighted avg       0.97      0.90      0.92     10036

[[8545 1004]
 [  11  476]]
</code></pre></div> <p>The accuracy of the trained model is very similar to that of the <a href=../ML%20using%20scikit-learn/ >Scikit-Learn model</a>.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <ol> <li>GeÃŒron, A. (2019). Hands-on machine learning with Scikit-Learn, Keras and TensorFlow: concepts, tools, and techniques to build intelligent systems (2<sup>nd</sup> ed.). Oâ€™Reilly. </li> <li>Class notes: Business Analytics &amp; Intelligence (BAI â€“10): Prof Naveen Kumar Bhansali </li> <li><a href=https://github.com/ageron/handson-ml2>https://github.com/ageron/handson-ml2</a> </li> </ol> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../Backpropagation/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Backpropagation" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Backpropagation </div> </div> </a> <a href=../Time%20series%20deep%20learning/ class="md-footer__link md-footer__link--next" aria-label="Next: Time series (python)" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Time series (python) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> <img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/88x31.png> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-contact style="text-align: center; margin: 1rem 0;"> <a href=../../contact title="Contact Me" style="display: inline-flex; align-items: center; gap: 0.5rem; color: rgba(255, 255, 255, 0.7); text-decoration: none;"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24" style="width: 1.2rem; height: 1.2rem; fill: rgba(255, 255, 255, 0.7);"> <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/> </svg> <span>Contact Me</span> </a> </div> <div class=md-footer-social> <a href=https://github.com/HarshaAsh target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/sri-harsha-achyuthuni/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.instagram.com/harshaash_com/ target=_blank rel=noopener title=www.instagram.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=https://www.facebook.com/sri.harsha.achyuthuni/ target=_blank rel=noopener title=www.facebook.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "header.autohide", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56838a2c.min.js></script> </body> </html>