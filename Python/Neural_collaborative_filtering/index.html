<!doctype html><html lang=en class=no-js> <head><!-- Code from google optimiser --><script src="https://www.googleoptimize.com/optimize.js?id=OPT-M98W6LW"></script><!-- Code from Mouseflow --><script type=text/javascript>
      window._mfq = window._mfq || [];
      (function() {
        var mf = document.createElement("script");
        mf.type = "text/javascript"; mf.defer = true;
        mf.src = "//cdn.mouseflow.com/projects/7b4494c9-7974-49f0-9777-d14450db37e6.js";
        document.getElementsByTagName("head")[0].appendChild(mf);
      })();
    </script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Harsha's notes on data science"><meta name=author content="Harsha Achyuthuni"><link href=https://www.harshaash.com/Python/Neural_collaborative_filtering/ rel=canonical><link rel=icon href=../../assets/images/logo.jpg><meta name=generator content="mkdocs-1.5.0, mkdocs-material-7.2.4"><title>Collaborative Filtering (Python) - Data Science with Harsha</title><link rel=stylesheet href=../../assets/stylesheets/main.f7f47774.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../overrides/assets/stylesheets/user_defined.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-65034507-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#neural-collaborative-filtering class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science with Harsha" class="md-header__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science with Harsha </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Collaborative Filtering (Python) </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_1> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_3> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_4> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science with Harsha" class="md-nav__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> Data Science with Harsha </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../resume/ class=md-nav__link> Resume </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Blog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Table_of_Contents/ class=md-nav__link> Table of Contents </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Visualization <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Visualization data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Vizualisation%20using%20python%20Part%201/ class=md-nav__link> Vizualizing tabular data (Python) </a> </li> <li class=md-nav__item> <a href=../Visualization%20for%20predictive%20analytics/ class=md-nav__link> Vizualising for predictive analytics (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Univariate-analysis/ class=md-nav__link> Univariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multivariateAnalysis/ class=md-nav__link> Multivariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multicollinearity/ class=md-nav__link> Multicollinearity (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Statistics basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Statistics basics" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Statistics basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Probability/ class=md-nav__link> Probability (R) </a> </li> <li class=md-nav__item> <a href=../../R/vectors/ class=md-nav__link> Vectors (R) </a> </li> <li class=md-nav__item> <a href=../../R/matrices/ class=md-nav__link> Matrices (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Hypothesis Testing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hypothesis Testing" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Hypothesis Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/attendance_t_test/ class=md-nav__link> z-test and t-test (R) </a> </li> <li class=md-nav__item> <a href=../../R/anova/ class=md-nav__link> ANOVA Test (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-goodness-of-fit/ class=md-nav__link> Chi-Square Goodness of fit (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-test-of-independence/ class=md-nav__link> Chi-Square test of independence (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Factor Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Factor Analysis" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Factor Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Curse-of-Dimensionality/ class=md-nav__link> Curse of dimensionality </a> </li> <li class=md-nav__item> <a href=../../R/EFA/ class=md-nav__link> Exploratory factor analysis (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Prediction algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prediction algorithms" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Prediction algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6_1 type=checkbox id=__nav_3_6_1> <label class=md-nav__link for=__nav_3_6_1> Classification Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Classification Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_6_1> <span class="md-nav__icon md-icon"></span> Classification Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/logistic-regression/ class=md-nav__link> Logistic Regression (R) </a> </li> <li class=md-nav__item> <a href=../../R/CHAID/ class=md-nav__link> CHAID Decision Trees (R) </a> </li> <li class=md-nav__item> <a href=../../R/CART-Classification/ class=md-nav__link> CART Classification (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6_2 type=checkbox id=__nav_3_6_2> <label class=md-nav__link for=__nav_3_6_2> Regression Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Regression Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_6_2> <span class="md-nav__icon md-icon"></span> Regression Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/part-and-partial-corr/ class=md-nav__link> Part and partial correlation </a> </li> <li class=md-nav__item> <a href=../../R/Linear-regression/ class=md-nav__link> Linear Regression (R) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Preprocessing data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preprocessing data" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Preprocessing data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/KNN_Imputation/ class=md-nav__link> Null Value Imputation (R) </a> </li> <li class=md-nav__item> <a href=../Machine%20Learning%20Part%201/ class=md-nav__link> Feature engineering (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Handling-Imbalanced-classes/ class=md-nav__link> Handling Imbalanced Classes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Machine Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Machine Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://harshaachyuthuni.shinyapps.io/Machine_Learning/ class=md-nav__link> Interactive Machine Learning (RShiny) </a> </li> <li class=md-nav__item> <a href=../ML%20using%20scikit-learn/ class=md-nav__link> ML using scikit-learn (Python) </a> </li> <li class=md-nav__item> <a href=../Demonstrating%20online%20learning/ class=md-nav__link> Streaming Machine Learning (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Time Series forecasting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Time Series forecasting" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Time Series forecasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/time-series/ class=md-nav__link> Introduction to stationarity (R) </a> </li> <li class=md-nav__item> <a href=../../R/Stationarity-tests/ class=md-nav__link> Stationary Tests (R) </a> </li> <li class=md-nav__item> <a href=../../R/ARIMA/ class=md-nav__link> ARIMA in R </a> </li> <li class=md-nav__item> <a href=../ARIMA%20Forecasting/ class=md-nav__link> ARIMA in Python </a> </li> <li class=md-nav__item> <a href=../../R/Seasonal-Time-Series/ class=md-nav__link> Seasonal time series (R) </a> </li> <li class=md-nav__item> <a href=../../R/VAR-models/ class=md-nav__link> VAR Models (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Deep learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deep learning" data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Deep learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ANN-1/ class=md-nav__link> Perceptron </a> </li> <li class=md-nav__item> <a href=../Backpropagation/ class=md-nav__link> Backpropagation </a> </li> <li class=md-nav__item> <a href=../DNN/ class=md-nav__link> Tensorflow and Keras </a> </li> <li class=md-nav__item> <a href=../Time%20series%20deep%20learning/ class=md-nav__link> Time series (python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_11 type=checkbox id=__nav_3_11> <label class=md-nav__link for=__nav_3_11> Generative AI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Generative AI" data-md-level=2> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> Generative AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../LLM%20Tokenizers/ class=md-nav__link> LLM Tokenizers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_12 type=checkbox id=__nav_3_12> <label class=md-nav__link for=__nav_3_12> Prescriptive Analytics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prescriptive Analytics" data-md-level=2> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Prescriptive Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Linear-programming/ class=md-nav__link> Linear Programming (R) </a> </li> <li class=md-nav__item> <a href=../../R/adoption_of_new_product/ class=md-nav__link> Adoption of new product (R) </a> </li> <li class=md-nav__item> <a href=../Diffusion%20on%20networks/ class=md-nav__link> Bass Forecasting model (Python) </a> </li> <li class=md-nav__item> <a href=../../Others/AHP/ class=md-nav__link> Analytic Hierarchy Process </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_13 type=checkbox id=__nav_3_13> <label class=md-nav__link for=__nav_3_13> Clustering <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Clustering data-md-level=2> <label class=md-nav__title for=__nav_3_13> <span class="md-nav__icon md-icon"></span> Clustering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/hierarchical_clustering/ class=md-nav__link> Hierarchical Clustering </a> </li> <li class=md-nav__item> <a href=../../R/kMeansClustering/ class=md-nav__link> K-Means Clustering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_14 type=checkbox id=__nav_3_14 checked> <label class=md-nav__link for=__nav_3_14> Reinforcement Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reinforcement Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_14> <span class="md-nav__icon md-icon"></span> Reinforcement Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/CustomerLifetimeValue/ class=md-nav__link> Customer Lifetime Value </a> </li> <li class=md-nav__item> <a href=../../R/recommendation-systems/ class=md-nav__link> Recommendation Systems (R) </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Collaborative Filtering (Python) <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Collaborative Filtering (Python) </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#neural-collaborative-filtering class=md-nav__link> Neural collaborative filtering </a> <nav class=md-nav aria-label="Neural collaborative filtering"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#preprocessing class=md-nav__link> Preprocessing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#model-architecture class=md-nav__link> Model architecture </a> <nav class=md-nav aria-label="Model architecture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#embeddings class=md-nav__link> Embeddings </a> </li> <li class=md-nav__item> <a href=#integrating-continuous-variables class=md-nav__link> Integrating continuous variables </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#evaluating-the-model class=md-nav__link> Evaluating the model </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_15 type=checkbox id=__nav_3_15> <label class=md-nav__link for=__nav_3_15> Networks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networks data-md-level=2> <label class=md-nav__title for=__nav_3_15> <span class="md-nav__icon md-icon"></span> Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Introduction%20to%20Networkx/ class=md-nav__link> Introduction to NetworkX (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Science/ class=md-nav__link> Network Science (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20centrality/ class=md-nav__link> Network Centrality (Python) </a> </li> <li class=md-nav__item> <a href=../Shortest%20path%20problems/ class=md-nav__link> Shortest path using integer programming (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Flow%20problems/ class=md-nav__link> Network flow problems (Python) </a> </li> <li class=md-nav__item> <a href=../Community%20detection/ class=md-nav__link> Community detection (Python) </a> </li> <li class=md-nav__item> <a href=../Bipartite%20matching/ class=md-nav__link> Bipartite matching (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_16 type=checkbox id=__nav_3_16> <label class=md-nav__link for=__nav_3_16> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=2> <label class=md-nav__title for=__nav_3_16> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Machine%20learning%20as%20HTTP%20Request/ class=md-nav__link> ML deployment in Flask (Python) </a> </li> <li class=md-nav__item> <a href=../Saving%20predictions%20in%20database/ class=md-nav__link> Handling databases using python </a> </li> <li class=md-nav__item> <a href=../ORM/ class=md-nav__link> ORM (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_17 type=checkbox id=__nav_3_17> <label class=md-nav__link for=__nav_3_17> Higher education review <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Higher education review" data-md-level=2> <label class=md-nav__title for=__nav_3_17> <span class="md-nav__icon md-icon"></span> Higher education review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/IIMB%20BAI/ class=md-nav__link> IIMB BAI </a> </li> <li class=md-nav__item> <a href=../../Others/part%20time%20data%20science%20masters/ class=md-nav__link> Part-time DS masters </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_18 type=checkbox id=__nav_3_18> <label class=md-nav__link for=__nav_3_18> External blogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="External blogs" data-md-level=2> <label class=md-nav__title for=__nav_3_18> <span class="md-nav__icon md-icon"></span> External blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Imperial%20College%20London/ class=md-nav__link> Imperial college London </a> </li> <li class=md-nav__item> <a href=../../Others/Rolls%20Royce/ class=md-nav__link> Rolls Royce </a> </li> <li class=md-nav__item> <a href=../../Others/Publications/ class=md-nav__link> Publications/conferences </a> </li> <li class=md-nav__item> <a href=../../Others/Deployed%20apps/ class=md-nav__link> Deployed apps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_19 type=checkbox id=__nav_3_19> <label class=md-nav__link for=__nav_3_19> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=__nav_3_19> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/preventive_maintainence/ class=md-nav__link> Preventive maintainence </a> </li> <li class=md-nav__item> <a href=../../Others/competitor%20intelligence/ class=md-nav__link> Competitor intelligence </a> </li> <li class=md-nav__item> <a href=../../Others/Scarecrow/ class=md-nav__link> Intelligent annotation </a> </li> <li class=md-nav__item> <a href=../../Others/bid%20allocation%20model/ class=md-nav__link> Bid Allocation </a> </li> <li class=md-nav__item> <a href=../../Others/IIMB%20project/ class=md-nav__link> Reward and Recognition contests </a> </li> <li class=md-nav__item> <a href=../../Others/supply%20chain%20analytics/ class=md-nav__link> Supply chain analytics </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#neural-collaborative-filtering class=md-nav__link> Neural collaborative filtering </a> <nav class=md-nav aria-label="Neural collaborative filtering"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#preprocessing class=md-nav__link> Preprocessing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#model-architecture class=md-nav__link> Model architecture </a> <nav class=md-nav aria-label="Model architecture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#embeddings class=md-nav__link> Embeddings </a> </li> <li class=md-nav__item> <a href=#integrating-continuous-variables class=md-nav__link> Integrating continuous variables </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#evaluating-the-model class=md-nav__link> Evaluating the model </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Collaborative Filtering (Python)</h1> <h2 id=neural-collaborative-filtering>Neural collaborative filtering<a class=headerlink href=#neural-collaborative-filtering title="Permanent link">&para;</a></h2> <p>Recommending music is common in music-based apps like NetEase or Spotify. This blog uses the data of 10k users (taken randomly) from the NetEase dataset to increase the click-through rate on the music cards (similar to TikTok/Instagram reels) recommended to the users. Recommending trending music to each unique user can decrease the chances of the user being inactive and increases the time spent by a user on the app. </p> <p>Collaborative filtering creates item and user embeddings to understand the behaviour of different users and items. Neural Collaborative Filtering is modified to incorporate these other features as we have additional content-based and user-based features. This approach can use the power of collaborative filtering to create user and item embeddings independently and, simultaneously, use the additional content and user-based features given in the data for building the model.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
<span class=kn>import</span> <span class=nn>datetime</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>import</span> <span class=nn>random</span>
<span class=kn>import</span> <span class=nn>warnings</span>
<span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
</code></pre></div> <p>The data for the most recent day the user has interacted is taken as a test set, while the rest is used for training the data. (The pre-processing of the dataset is not shown in this blog). The description of the data can be found in the paper <a href=https://dx.doi.org/10.2139/ssrn.3554826>NetEase Cloud Music Data</a> and <a href=https://doi.org/10.1145/3481646.3481653>NetEase Cloud Dataset: Active User Identification and Deep Neural Network Based CTR</a>.</p> <div class=highlight><pre><span></span><code><span class=c1># data is taken from end of part 1</span>
<span class=n>train_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;train_data_10k.csv&#39;</span><span class=p>)</span>
<span class=n>test_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;test_data_10k.csv&#39;</span><span class=p>)</span>
</code></pre></div> <p>For building a more robust recommendation system, we consider users with more than one click (already active users) and content with more than one click (popular content).</p> <div class=highlight><pre><span></span><code><span class=n>selected_users</span> <span class=o>=</span> <span class=n>test_data</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>

<span class=n>seen_mlogs</span> <span class=o>=</span> <span class=n>train_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;mlogId&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>nunique</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
<span class=n>selected_mlogs</span> <span class=o>=</span> <span class=n>seen_mlogs</span><span class=p>[</span><span class=n>seen_mlogs</span><span class=o>.</span><span class=n>userId</span><span class=o>&gt;</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>mlogId</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span><span class=o>.</span><span class=n>mlogId</span>

<span class=c1># filtering the data for the selected mlogs that have atleast one view</span>
<span class=n>train_data</span> <span class=o>=</span> <span class=n>train_data</span><span class=p>[</span><span class=n>train_data</span><span class=o>.</span><span class=n>mlogId</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>selected_mlogs</span><span class=p>)]</span>

<span class=n>users_clicked</span> <span class=o>=</span> <span class=n>train_data</span><span class=p>[</span><span class=n>train_data</span><span class=o>.</span><span class=n>isClick</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;userId&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>mlogId</span><span class=o>.</span><span class=n>nunique</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
<span class=n>selected_users</span> <span class=o>=</span> <span class=n>users_clicked</span><span class=p>[</span><span class=n>users_clicked</span><span class=o>.</span><span class=n>mlogId</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span><span class=o>.</span><span class=n>userId</span>
<span class=n>train_data</span> <span class=o>=</span> <span class=n>train_data</span><span class=p>[</span><span class=n>train_data</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>selected_users</span><span class=p>)]</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</code></pre></div> <p>The total number of users considered for the model</p> <div class=highlight><pre><span></span><code><span class=nb>len</span><span class=p>(</span><span class=n>train_data</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>unique</span><span class=p>())</span>
</code></pre></div> <div class=highlight><pre><span></span><code>719
</code></pre></div> <p>Filtering the test data for the same users</p> <div class=highlight><pre><span></span><code><span class=n>test_data</span> <span class=o>=</span> <span class=n>test_data</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>selected_users</span><span class=p>)]</span>
<span class=n>test_data</span> <span class=o>=</span> <span class=n>test_data</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>mlogId</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>selected_mlogs</span><span class=p>)]</span>
<span class=n>test_data</span> <span class=o>=</span> <span class=n>test_data</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</code></pre></div> <p>The following user and content-based features are considered:<br> 1. user_registered_month_count: The number of months since the user has joined 2. user_follow_count: The number of people the user has followed 3. user_level: The activity intensity (0 to 10) of the user 4. user_gender: Gender of the user 5. userImprssionCount: The number of unique users the card was shown 6. userClickCount: The number of users who clicked on the card 7. publishTime: The number of days when the card is published till date 8. creator_registered_month_count: The number of months since the music creator/artist has joined 9. creator_followeds: The number of follows of the music creator 10. creator_level: The activity intensity (0 to 10) of the music creator 11. creator_gender: Gender of the music creator </p> <div class=highlight><pre><span></span><code><span class=n>cont_vars</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;user_registered_month_count&#39;</span><span class=p>,</span> <span class=s1>&#39;user_follow_count&#39;</span><span class=p>,</span>    <span class=s1>&#39;user_level&#39;</span><span class=p>,</span> <span class=s1>&#39;user_gender&#39;</span><span class=p>,</span>    <span class=s1>&#39;userImprssionCount&#39;</span><span class=p>,</span> <span class=s1>&#39;userClickCount&#39;</span><span class=p>,</span>
             <span class=s1>&#39;publishTime&#39;</span><span class=p>,</span> <span class=s1>&#39;creator_registered_month_count&#39;</span><span class=p>,</span>   <span class=s1>&#39;creator_followed&#39;</span><span class=p>,</span> <span class=s1>&#39;creator_level&#39;</span><span class=p>,</span>    <span class=s1>&#39;creator_gender&#39;</span><span class=p>]</span>
</code></pre></div> <p>The data is at user-content level. UserId is the unique key for a user and mlogId is the unique key for content. </p> <div class=highlight><pre><span></span><code><span class=n>train_data</span><span class=p>[[</span><span class=s1>&#39;userId&#39;</span><span class=p>,</span> <span class=s1>&#39;mlogId&#39;</span><span class=p>]</span><span class=o>+</span><span class=n>cont_vars</span><span class=o>+</span><span class=p>[</span><span class=s1>&#39;isClick&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</code></pre></div> <div id=df-106d4d01-8abc-4663-a019-d3bfce0d460e> <div class=colab-df-container> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class="dataframe table"> <thead> <tr style="text-align: right;"> <th></th> <th>userId</th> <th>mlogId</th> <th>user_registered_month_count</th> <th>user_follow_count</th> <th>user_level</th> <th>user_gender</th> <th>userImprssionCount</th> <th>userClickCount</th> <th>publishTime</th> <th>creator_registered_month_count</th> <th>creator_followed</th> <th>creator_level</th> <th>creator_gender</th> <th>isClick</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>PCNCGCGCLCOCOCOCJCGC</td> <td>NCLCPCJCOCGCJC</td> <td>21.0</td> <td>2.0</td> <td>6.0</td> <td>0</td> <td>134326.0</td> <td>5586.0</td> <td>59.0</td> <td>4.0</td> <td>860.0</td> <td>5.0</td> <td>1.0</td> <td>0</td> </tr> <tr> <th>1</th> <td>PCNCGCGCLCOCOCOCJCGC</td> <td>NCLCPCJCOCGCJC</td> <td>21.0</td> <td>2.0</td> <td>6.0</td> <td>0</td> <td>200171.0</td> <td>8524.0</td> <td>59.0</td> <td>4.0</td> <td>860.0</td> <td>5.0</td> <td>1.0</td> <td>0</td> </tr> <tr> <th>2</th> <td>PCNCGCGCLCOCOCOCJCGC</td> <td>NCLCPCJCOCGCJC</td> <td>21.0</td> <td>2.0</td> <td>6.0</td> <td>0</td> <td>161261.0</td> <td>6745.0</td> <td>59.0</td> <td>4.0</td> <td>860.0</td> <td>5.0</td> <td>1.0</td> <td>0</td> </tr> <tr> <th>3</th> <td>PCNCGCGCLCOCOCOCJCGC</td> <td>NCLCPCJCOCGCJC</td> <td>21.0</td> <td>2.0</td> <td>6.0</td> <td>0</td> <td>153874.0</td> <td>6852.0</td> <td>59.0</td> <td>4.0</td> <td>860.0</td> <td>5.0</td> <td>1.0</td> <td>0</td> </tr> <tr> <th>4</th> <td>PCNCGCGCLCOCOCOCJCGC</td> <td>NCLCPCJCOCGCJC</td> <td>21.0</td> <td>2.0</td> <td>6.0</td> <td>0</td> <td>153685.0</td> <td>6711.0</td> <td>59.0</td> <td>4.0</td> <td>860.0</td> <td>5.0</td> <td>1.0</td> <td>0</td> </tr> </tbody> </table> </div> <button class=colab-df-convert onclick="convertToInteractive('df-106d4d01-8abc-4663-a019-d3bfce0d460e')" title="Convert this dataframe to an interactive table." style=display:none;> <svg xmlns=http://www.w3.org/2000/svg height=24px viewbox="0 0 24 24" width=24px> <path fill=none d="M0 0h24v24H0V0z"/> <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/> </svg> </button> <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style> <script>
        const buttonEl =
          document.querySelector('#df-106d4d01-8abc-4663-a019-d3bfce0d460e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-106d4d01-8abc-4663-a019-d3bfce0d460e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script> </div> </div> <h3 id=preprocessing>Preprocessing<a class=headerlink href=#preprocessing title="Permanent link">&para;</a></h3> <p>All the continuous variables are scaled between 0 and 1 using a min-max scalar. Users and items are converted into boolean vectors as shown in James Loy's <a href=https://towardsdatascience.com/deep-learning-based-recommender-systems-3d120201db7ehttps:// >blog</a>. The length of the user and item vectors are the number of unique users and vectors respectively with a boolean representing the user (or item) in a user vector (or item vector). </p> <div class=highlight><pre><span></span><code><span class=n>scaling_max_dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=n>scaling_min_dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=k>def</span> <span class=nf>min_max_scaler</span><span class=p>(</span><span class=n>min_scale_num</span><span class=p>,</span><span class=n>max_scale_num</span><span class=p>,</span><span class=n>var</span><span class=p>,</span> <span class=n>var_name</span><span class=p>):</span>
    <span class=k>if</span><span class=p>(</span><span class=n>var_name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>scaling_max_dict</span><span class=o>.</span><span class=n>keys</span><span class=p>()):</span>
      <span class=n>scaling_max_dict</span><span class=p>[</span><span class=n>var_name</span><span class=p>]</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>var</span><span class=p>)</span>
      <span class=n>scaling_min_dict</span><span class=p>[</span><span class=n>var_name</span><span class=p>]</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>var</span><span class=p>)</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>max_scale_num</span> <span class=o>-</span> <span class=n>min_scale_num</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span> <span class=p>(</span><span class=n>var</span> <span class=o>-</span> <span class=n>scaling_min_dict</span><span class=p>[</span><span class=n>var_name</span><span class=p>])</span> <span class=o>/</span> <span class=p>(</span><span class=n>scaling_max_dict</span><span class=p>[</span><span class=n>var_name</span><span class=p>]</span> <span class=o>-</span> <span class=n>scaling_min_dict</span><span class=p>[</span><span class=n>var_name</span><span class=p>])</span> <span class=p>)</span> <span class=o>+</span> <span class=n>min_scale_num</span>
<span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>cont_vars</span><span class=p>:</span>
  <span class=n>train_data</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>min_max_scaler</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>train_data</span><span class=p>[</span><span class=n>col</span><span class=p>],</span> <span class=n>col</span><span class=p>)</span>
  <span class=n>test_data</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>min_max_scaler</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>test_data</span><span class=p>[</span><span class=n>col</span><span class=p>],</span> <span class=n>col</span><span class=p>)</span>
</code></pre></div> <p>Modifying the data to get into the required format for the model.</p> <div class=highlight><pre><span></span><code><span class=n>selected_users</span> <span class=o>=</span> <span class=n>train_data</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
<span class=n>selected_mlogs</span> <span class=o>=</span> <span class=n>train_data</span><span class=o>.</span><span class=n>mlogId</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># list to store integer labels </span>
<span class=n>users_int_labels</span> <span class=o>=</span> <span class=p>[]</span>
<span class=n>users_dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_users</span><span class=p>)):</span>
    <span class=n>users_dict</span><span class=p>[</span><span class=n>selected_users</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span> <span class=o>=</span> <span class=n>i</span>
    <span class=n>users_int_labels</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>

<span class=n>items_int_labels</span> <span class=o>=</span> <span class=p>[]</span>
<span class=n>items_dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_mlogs</span><span class=p>)):</span>
    <span class=n>items_dict</span><span class=p>[</span><span class=n>selected_mlogs</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span> <span class=o>=</span> <span class=n>i</span>
    <span class=n>items_int_labels</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>users</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>lables</span> <span class=o>=</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[]</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>train_data</span><span class=p>)):</span>
  <span class=n>users</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>users_dict</span><span class=p>[</span><span class=n>train_data</span><span class=o>.</span><span class=n>userId</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
  <span class=n>items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>items_dict</span><span class=p>[</span><span class=n>train_data</span><span class=o>.</span><span class=n>mlogId</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
  <span class=n>lables</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>train_data</span><span class=o>.</span><span class=n>isClick</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>con_var_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>train_data</span><span class=p>[</span><span class=n>cont_vars</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
</code></pre></div> <p>The total number of features considered are:</p> <div class=highlight><pre><span></span><code><span class=nb>len</span><span class=p>(</span><span class=n>con_var_list</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</code></pre></div> <div class=highlight><pre><span></span><code>11
</code></pre></div> <p>The total length of the data is</p> <div class=highlight><pre><span></span><code><span class=nb>len</span><span class=p>(</span><span class=n>train_data</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>2520143
</code></pre></div> <p>The training data is highly unbalanced with only around 9% of the content clicked.</p> <div class=highlight><pre><span></span><code><span class=n>train_data</span><span class=o>.</span><span class=n>isClick</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>*</span><span class=mi>100</span>
</code></pre></div> <div class=highlight><pre><span></span><code>8.70454573411112
</code></pre></div> <h2 id=model-architecture>Model architecture<a class=headerlink href=#model-architecture title="Permanent link">&para;</a></h2> <p>The model contains two types of inputs, embeddings and continuous variables. </p> <h3 id=embeddings>Embeddings<a class=headerlink href=#embeddings title="Permanent link">&para;</a></h3> <p>We create user and content embeddings using neural networks. An embedding is a lower dimensional space that captures the relationships from higher dimensions. Each axis in an embedding could indicate one attribute/trait of the user/content/higher dimension. For example, for the content, one of the axes could represent classical music while the other could represent rock music, and so on. </p> <p>We have considered user and content embeddings of eight dimensions. A larger number of dimensions means more model complexity, but it would also allow us to capture the traits more accurately.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>torch</span>
<span class=kn>from</span> <span class=nn>torch.utils.data</span> <span class=kn>import</span> <span class=n>Dataset</span>

<span class=c1># creating the dataset</span>

<span class=k>class</span> <span class=nc>NetEaseTrainDataset</span><span class=p>(</span><span class=n>Dataset</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;NetEase PyTorch Dataset for Training</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>users</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>lables</span><span class=p>,</span> <span class=n>con_var_list</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>users</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>items</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>lables</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>con_var_list</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset</span><span class=p>(</span><span class=n>users</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>lables</span><span class=p>,</span> <span class=n>con_var_list</span><span class=p>)</span>


    <span class=k>def</span> <span class=fm>__len__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>users</span><span class=p>)</span>

    <span class=k>def</span> <span class=fm>__getitem__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>users</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>items</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>lables</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>con_var_list</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>

    <span class=k>def</span> <span class=nf>get_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>users</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>lables</span><span class=p>,</span> <span class=n>con_var_list</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>users</span><span class=p>),</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>items</span><span class=p>),</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>lables</span><span class=p>),</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>con_var_list</span><span class=p>)</span><span class=o>.</span><span class=n>float</span><span class=p>()</span>
</code></pre></div> <h3 id=integrating-continuous-variables>Integrating continuous variables<a class=headerlink href=#integrating-continuous-variables title="Permanent link">&para;</a></h3> <p>Consider the following training sample to walk through the architecture.</p> <div class=highlight><pre><span></span><code><span class=n>train_data</span><span class=p>[[</span><span class=s1>&#39;userId&#39;</span><span class=p>,</span> <span class=s1>&#39;mlogId&#39;</span><span class=p>]</span><span class=o>+</span><span class=n>cont_vars</span><span class=o>+</span><span class=p>[</span><span class=s1>&#39;isClick&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>userId                            PCNCGCGCLCOCOCOCJCGC
mlogId                                  NCLCPCJCOCGCJC
user_registered_month_count                   0.304348
user_follow_count                              0.00346
user_level                                         0.6
user_gender                                        0.0
userImprssionCount                            0.042437
userClickCount                                0.167085
publishTime                                   0.258216
creator_registered_month_count                    0.05
creator_followed                              0.000004
creator_level                                      0.5
creator_gender                                     1.0
isClick                                              0
Name: 0, dtype: object
</code></pre></div> <p><img alt=image.png src=network_architecture.png></p> <p>In the training sample, we can see the userId converted to a vector (with a length of the number of users and one indicating which user) in the model. This is the input to the user embedding layer, which converts it into a vector of length 4 (user embedding). A similar process happens with the Items also. </p> <p>The scaled user and item features directly input the fully connected layers. The input for the fully connected layers is the concatenation of the user embeddings, item embeddings and user and item features. </p> <p>A sigmoid function is applied at the output layer to obtain the most probable class. In the example, the most probable class is 0.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>torch.nn</span> <span class=k>as</span> <span class=nn>nn</span>
<span class=c1># !pip install pytorch_lightning</span>
<span class=kn>import</span> <span class=nn>pytorch_lightning</span> <span class=k>as</span> <span class=nn>pl</span>
<span class=kn>from</span> <span class=nn>torch.utils.data</span> <span class=kn>import</span> <span class=n>DataLoader</span>

<span class=k>class</span> <span class=nc>NCF</span><span class=p>(</span><span class=n>pl</span><span class=o>.</span><span class=n>LightningModule</span><span class=p>):</span>
    <span class=c1>#  Neural Collaborative Filtering (NCF) Ref: https://towardsdatascience.com/deep-learning-based-recommender-systems-3d120201db7e</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>num_users</span><span class=p>,</span> <span class=n>num_items</span><span class=p>,</span> <span class=n>users</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>lables</span><span class=p>,</span> <span class=n>con_var_list</span><span class=p>):</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>user_embedding</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Embedding</span><span class=p>(</span><span class=n>num_embeddings</span><span class=o>=</span><span class=n>num_users</span><span class=p>,</span> <span class=n>embedding_dim</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>item_embedding</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Embedding</span><span class=p>(</span><span class=n>num_embeddings</span><span class=o>=</span><span class=n>num_items</span><span class=p>,</span> <span class=n>embedding_dim</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>fc1</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>in_features</span><span class=o>=</span><span class=mi>8</span><span class=o>+</span><span class=nb>len</span><span class=p>(</span><span class=n>cont_vars</span><span class=p>),</span> <span class=n>out_features</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>fc2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>in_features</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>out_features</span><span class=o>=</span><span class=mi>16</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>output</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>in_features</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>out_features</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>users</span> <span class=o>=</span> <span class=n>users</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>items</span> <span class=o>=</span> <span class=n>items</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>lables</span> <span class=o>=</span> <span class=n>lables</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>con_var_list</span> <span class=o>=</span> <span class=n>con_var_list</span>

    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_input</span><span class=p>,</span> <span class=n>item_input</span><span class=p>,</span> <span class=n>con_var_input</span><span class=p>):</span>

        <span class=c1># Pass through embedding layers</span>
        <span class=n>user_embedded</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_embedding</span><span class=p>(</span><span class=n>user_input</span><span class=p>)</span>
        <span class=n>item_embedded</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>item_embedding</span><span class=p>(</span><span class=n>item_input</span><span class=p>)</span>

        <span class=c1># Concat the two embedding layers</span>
        <span class=n>vector</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>cat</span><span class=p>([</span><span class=n>user_embedded</span><span class=p>,</span> <span class=n>item_embedded</span><span class=p>,</span> <span class=n>con_var_input</span><span class=p>],</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>

        <span class=c1># Pass through dense layer</span>
        <span class=n>vector</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>ReLU</span><span class=p>()(</span><span class=bp>self</span><span class=o>.</span><span class=n>fc1</span><span class=p>(</span><span class=n>vector</span><span class=p>))</span>
        <span class=n>vector</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>ReLU</span><span class=p>()(</span><span class=bp>self</span><span class=o>.</span><span class=n>fc2</span><span class=p>(</span><span class=n>vector</span><span class=p>))</span>

        <span class=c1># Output layer</span>
        <span class=n>pred</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Sigmoid</span><span class=p>()(</span><span class=bp>self</span><span class=o>.</span><span class=n>output</span><span class=p>(</span><span class=n>vector</span><span class=p>))</span>

        <span class=k>return</span> <span class=n>pred</span>

    <span class=k>def</span> <span class=nf>training_step</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch</span><span class=p>,</span> <span class=n>batch_idx</span><span class=p>):</span>
        <span class=n>user_input</span><span class=p>,</span> <span class=n>item_input</span><span class=p>,</span> <span class=n>labels</span><span class=p>,</span> <span class=n>con_var_list</span> <span class=o>=</span> <span class=n>batch</span>
        <span class=n>predicted_labels</span> <span class=o>=</span> <span class=bp>self</span><span class=p>(</span><span class=n>user_input</span><span class=p>,</span> <span class=n>item_input</span><span class=p>,</span> <span class=n>con_var_list</span><span class=p>)</span>
        <span class=n>loss</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>BCELoss</span><span class=p>()(</span><span class=n>predicted_labels</span><span class=p>,</span> <span class=n>labels</span><span class=o>.</span><span class=n>view</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>float</span><span class=p>())</span>
        <span class=k>return</span> <span class=n>loss</span>

    <span class=k>def</span> <span class=nf>configure_optimizers</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>optim</span><span class=o>.</span><span class=n>Adam</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>parameters</span><span class=p>())</span>

    <span class=k>def</span> <span class=nf>train_dataloader</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>DataLoader</span><span class=p>(</span><span class=n>NetEaseTrainDataset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>users</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>items</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>lables</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>con_var_list</span><span class=p>),</span>
                          <span class=n>batch_size</span><span class=o>=</span><span class=mi>512</span><span class=p>,</span> <span class=n>num_workers</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</code></pre></div> <p>This model is trained for fifty epochs.</p> <div class=highlight><pre><span></span><code><span class=n>num_users</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_users</span><span class=p>)</span>
<span class=n>num_items</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_mlogs</span><span class=p>)</span>

<span class=n>model</span> <span class=o>=</span> <span class=n>NCF</span><span class=p>(</span><span class=n>num_users</span><span class=p>,</span> <span class=n>num_items</span><span class=p>,</span> <span class=n>users</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>lables</span><span class=p>,</span> <span class=n>con_var_list</span><span class=p>)</span>

<span class=n>trainer</span> <span class=o>=</span> <span class=n>pl</span><span class=o>.</span><span class=n>Trainer</span><span class=p>(</span><span class=n>max_epochs</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=n>trainer</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>INFO:pytorch_lightning.utilities.rank_zero:GPU available: False, used: False
INFO:pytorch_lightning.utilities.rank_zero:TPU available: False, using: 0 TPU cores
INFO:pytorch_lightning.utilities.rank_zero:IPU available: False, using: 0 IPUs
INFO:pytorch_lightning.utilities.rank_zero:HPU available: False, using: 0 HPUs
INFO:pytorch_lightning.callbacks.model_summary:
  | Name           | Type      | Params
---------------------------------------------
0 | user_embedding | Embedding | 2.9 K 
1 | item_embedding | Embedding | 48.1 K
2 | fc1            | Linear    | 640   
3 | fc2            | Linear    | 528   
4 | output         | Linear    | 17    
---------------------------------------------
52.2 K    Trainable params
0         Non-trainable params
52.2 K    Total params
0.209     Total estimated model params size (MB)



Training: 0it [00:00, ?it/s]


INFO:pytorch_lightning.utilities.rank_zero:`Trainer.fit` stopped: `max_epochs=50` reached.
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>trainer</span><span class=o>.</span><span class=n>save_checkpoint</span><span class=p>(</span><span class=s2>&quot;final_model.ckpt&quot;</span><span class=p>)</span>
</code></pre></div> <h2 id=evaluating-the-model>Evaluating the model<a class=headerlink href=#evaluating-the-model title="Permanent link">&para;</a></h2> <p>Running the model on the test data, we get an accuracy of 74%.</p> <div class=highlight><pre><span></span><code><span class=c1># need to evaluate the model</span>
<span class=n>test_data</span> <span class=o>=</span> <span class=n>test_data</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>userId</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>selected_users</span><span class=p>)]</span>
<span class=n>test_data</span> <span class=o>=</span> <span class=n>test_data</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>mlogId</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>selected_mlogs</span><span class=p>)]</span>
<span class=n>test_data</span> <span class=o>=</span> <span class=n>test_data</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>

<span class=n>users_test</span><span class=p>,</span> <span class=n>items_test</span><span class=p>,</span> <span class=n>lables_test</span> <span class=o>=</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[]</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>test_data</span><span class=p>)):</span>
    <span class=n>users_test</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>users_dict</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>userId</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
    <span class=n>items_test</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>items_dict</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>mlogId</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
    <span class=n>lables_test</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>test_data</span><span class=o>.</span><span class=n>isClick</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
<span class=n>con_var_list_test</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>test_data</span><span class=p>[</span><span class=n>cont_vars</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
</code></pre></div> <p>The probability of clicking on the card for the top 20 user specific cards is shown:</p> <div class=highlight><pre><span></span><code><span class=c1># Calculating the probability in the test data</span>
<span class=n>test_data</span><span class=p>[</span><span class=s1>&#39;pred_prob&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>model</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>users_test</span><span class=p>),</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>items_test</span><span class=p>),</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>con_var_list_test</span><span class=p>)</span><span class=o>.</span><span class=n>float</span><span class=p>())</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>())</span>
<span class=n>test_data</span><span class=p>[[</span><span class=s1>&#39;isClick&#39;</span><span class=p>,</span> <span class=s1>&#39;pred_prob&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>sort_values</span><span class=p>([</span><span class=s1>&#39;isClick&#39;</span><span class=p>,</span><span class=s1>&#39;pred_prob&#39;</span><span class=p>],</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)[</span><span class=mi>0</span><span class=p>:</span><span class=mi>20</span><span class=p>]</span>
</code></pre></div> <div id=df-c032a926-4192-4d9d-873c-a2d5c25028ef> <div class=colab-df-container> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class="dataframe table"> <thead> <tr style="text-align: right;"> <th></th> <th>isClick</th> <th>pred_prob</th> </tr> </thead> <tbody> <tr> <th>176772</th> <td>1</td> <td>0.998197</td> </tr> <tr> <th>176774</th> <td>1</td> <td>0.998197</td> </tr> <tr> <th>176794</th> <td>1</td> <td>0.998197</td> </tr> <tr> <th>176780</th> <td>1</td> <td>0.998196</td> </tr> <tr> <th>176773</th> <td>1</td> <td>0.998196</td> </tr> <tr> <th>176778</th> <td>1</td> <td>0.998196</td> </tr> <tr> <th>176787</th> <td>1</td> <td>0.998196</td> </tr> <tr> <th>176783</th> <td>1</td> <td>0.998196</td> </tr> <tr> <th>176786</th> <td>1</td> <td>0.998196</td> </tr> <tr> <th>176767</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176784</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176785</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176791</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176788</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176775</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176782</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176766</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176776</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176781</th> <td>1</td> <td>0.998195</td> </tr> <tr> <th>176790</th> <td>1</td> <td>0.998195</td> </tr> </tbody> </table> </div> <button class=colab-df-convert onclick="convertToInteractive('df-c032a926-4192-4d9d-873c-a2d5c25028ef')" title="Convert this dataframe to an interactive table." style=display:none;> <svg xmlns=http://www.w3.org/2000/svg height=24px viewbox="0 0 24 24" width=24px> <path fill=none d="M0 0h24v24H0V0z"/> <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/> </svg> </button> <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style> <script>
        const buttonEl =
          document.querySelector('#df-c032a926-4192-4d9d-873c-a2d5c25028ef button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c032a926-4192-4d9d-873c-a2d5c25028ef');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script> </div> </div> <p>As the data is unbalanced, we want to find the optimal probability cutoff for showing a card to a user. We identified the point where a weighted true positivity rate is high, and the weighted false positivity rate is low. The weight indicates the importance given to the positive class.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>roc_curve</span><span class=p>,</span> <span class=n>auc</span>
<span class=kn>import</span> <span class=nn>pylab</span> <span class=k>as</span> <span class=nn>pl</span>
<span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>thresholds</span> <span class=o>=</span><span class=n>roc_curve</span><span class=p>(</span><span class=n>test_data</span><span class=o>.</span><span class=n>isClick</span><span class=p>,</span> <span class=n>test_data</span><span class=o>.</span><span class=n>pred_prob</span><span class=p>)</span>
<span class=n>roc_auc</span> <span class=o>=</span> <span class=n>auc</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Area under the ROC curve : </span><span class=si>%f</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=n>roc_auc</span><span class=p>)</span>

<span class=c1>####################################</span>
<span class=c1># The optimal cut off would be where tpr is high and fpr is low</span>
<span class=c1># tpr - (1-fpr) is zero or near to zero is the optimal cut off point</span>
<span class=c1>####################################</span>
<span class=n>i</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>tpr</span><span class=p>))</span> <span class=c1># index for df</span>
<span class=n>roc</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;fpr&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=n>i</span><span class=p>),</span><span class=s1>&#39;tpr&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>tpr</span><span class=p>,</span> <span class=n>index</span> <span class=o>=</span> <span class=n>i</span><span class=p>),</span> <span class=s1>&#39;1-fpr&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>fpr</span><span class=p>,</span> <span class=n>index</span> <span class=o>=</span> <span class=n>i</span><span class=p>),</span> <span class=s1>&#39;tf&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>tpr</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>fpr</span><span class=p>),</span> <span class=n>index</span> <span class=o>=</span> <span class=n>i</span><span class=p>),</span> <span class=s1>&#39;thresholds&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>thresholds</span><span class=p>,</span> <span class=n>index</span> <span class=o>=</span> <span class=n>i</span><span class=p>)})</span>
<span class=n>roc</span><span class=o>.</span><span class=n>iloc</span><span class=p>[(</span><span class=n>roc</span><span class=o>.</span><span class=n>tf</span><span class=o>-</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>abs</span><span class=p>()</span><span class=o>.</span><span class=n>argsort</span><span class=p>()[:</span><span class=mi>1</span><span class=p>]]</span>

<span class=c1># Plot tpr vs 1-fpr</span>
<span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>pl</span><span class=o>.</span><span class=n>subplots</span><span class=p>()</span>
<span class=n>pl</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>roc</span><span class=p>[</span><span class=s1>&#39;tpr&#39;</span><span class=p>])</span>
<span class=n>pl</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>roc</span><span class=p>[</span><span class=s1>&#39;1-fpr&#39;</span><span class=p>],</span> <span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;red&#39;</span><span class=p>)</span>
<span class=n>pl</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;1-False Positive Rate&#39;</span><span class=p>)</span>
<span class=n>pl</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;True Positive Rate&#39;</span><span class=p>)</span>
<span class=n>pl</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Receiver operating characteristic&#39;</span><span class=p>)</span>
<span class=n>ax</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([])</span>
<span class=n>pl</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Area under the ROC curve : 0.552476
</code></pre></div> <p><img alt=png src=output_42_1.png></p> <div class=highlight><pre><span></span><code><span class=n>cutoff_weight</span> <span class=o>=</span> <span class=mi>3</span><span class=o>/</span><span class=mi>4</span>
<span class=k>def</span> <span class=nf>Find_Optimal_Cutoff</span><span class=p>(</span><span class=n>target</span><span class=p>,</span> <span class=n>predicted</span><span class=p>):</span>
    <span class=c1># reference https://stackoverflow.com/a/32482924</span>
    <span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>threshold</span> <span class=o>=</span> <span class=n>roc_curve</span><span class=p>(</span><span class=n>target</span><span class=p>,</span> <span class=n>predicted</span><span class=p>)</span>
    <span class=n>i</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>tpr</span><span class=p>))</span> 
    <span class=n>roc</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;tf&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>((</span><span class=n>cutoff_weight</span><span class=p>)</span><span class=o>*</span><span class=n>tpr</span><span class=o>-</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>cutoff_weight</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>fpr</span><span class=p>),</span> <span class=n>index</span><span class=o>=</span><span class=n>i</span><span class=p>),</span> <span class=s1>&#39;threshold&#39;</span> <span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>threshold</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=n>i</span><span class=p>)})</span>
    <span class=n>roc_t</span> <span class=o>=</span> <span class=n>roc</span><span class=o>.</span><span class=n>iloc</span><span class=p>[(</span><span class=n>roc</span><span class=o>.</span><span class=n>tf</span><span class=o>-</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>abs</span><span class=p>()</span><span class=o>.</span><span class=n>argsort</span><span class=p>()[:</span><span class=mi>1</span><span class=p>]]</span>

    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>roc_t</span><span class=p>[</span><span class=s1>&#39;threshold&#39;</span><span class=p>])</span> 

<span class=c1># Find optimal probability threshold</span>
<span class=n>threshold</span> <span class=o>=</span> <span class=n>Find_Optimal_Cutoff</span><span class=p>(</span><span class=n>test_data</span><span class=o>.</span><span class=n>isClick</span><span class=p>,</span> <span class=n>test_data</span><span class=o>.</span><span class=n>pred_prob</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>threshold</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[0.17772053182125092]
</code></pre></div> <p>The accuracy metrics on the test data are:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>confusion_matrix</span>
<span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>test_data</span><span class=o>.</span><span class=n>isClick</span><span class=p>,</span> <span class=n>test_data</span><span class=o>.</span><span class=n>pred_prob</span><span class=o>&gt;</span><span class=mf>0.17</span><span class=p>))</span>
<span class=c1># confusion_matrix(test_data.isClick, test_data.pred_prob&gt;0.17)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>              precision    recall  f1-score   support

           0       0.92      0.79      0.85    220506
           1       0.11      0.28      0.15     20327

    accuracy                           0.74    240833
   macro avg       0.51      0.53      0.50    240833
weighted avg       0.85      0.74      0.79    240833
</code></pre></div> <p>The alternate way of evaluating the model is by using the Hit Ratio. The user does not need to interact with every single item in the list of recommendations but needs to interact with at least one from all the cards shown. We will consider a user to be "hit" if the user clicks at least one item from the top ten that the user is recommended.</p> <div class=highlight><pre><span></span><code><span class=n>test_data</span><span class=p>[</span><span class=s1>&#39;ranking&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>test_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;userId&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>pred_prob</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>test_data</span><span class=p>[</span><span class=n>test_data</span><span class=o>.</span><span class=n>ranking</span><span class=o>&lt;</span><span class=mi>10</span><span class=p>]</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;userId&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>pred_prob</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span><span class=o>.</span><span class=n>pred_prob</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code>0.42861176
</code></pre></div> <p>The Hit ratio at 10 is 42.8% (from a 9% hit rate without the recommendation system). </p> <p>Parts of this work was first used as assignment by Harsha A, Vaibhav D, Akhtar P and Rada G as part of Advanced Machine Learning module at Imperial College London</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../R/recommendation-systems/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Recommendation Systems (R)" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Recommendation Systems (R) </div> </div> </a> <a href=../Introduction%20to%20Networkx/ class="md-footer__link md-footer__link--next" aria-label="Next: Introduction to NetworkX (Python)" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Introduction to NetworkX (Python) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> <img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/88x31.png> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/HarshaAsh target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/sri-harsha-achyuthuni/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.instagram.com/harshaash_com/ target=_blank rel=noopener title=www.instagram.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=https://www.facebook.com/sri.harsha.achyuthuni/ target=_blank rel=noopener title=www.facebook.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "header.autohide", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56838a2c.min.js></script> </body> </html>