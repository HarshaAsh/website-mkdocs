<!doctype html><html lang=en class=no-js> <head><!-- Code from google optimiser --><script src="https://www.googleoptimize.com/optimize.js?id=OPT-M98W6LW"></script><!-- Code from Mouseflow --><script type=text/javascript>
      window._mfq = window._mfq || [];
      (function() {
        var mf = document.createElement("script");
        mf.type = "text/javascript"; mf.defer = true;
        mf.src = "//cdn.mouseflow.com/projects/7b4494c9-7974-49f0-9777-d14450db37e6.js";
        document.getElementsByTagName("head")[0].appendChild(mf);
      })();
    </script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Harsha's notes on data science"><meta name=author content="Harsha Achyuthuni"><link href=https://www.harshaash.com/Python/Backpropagation/ rel=canonical><link rel=icon href=../../assets/images/logo.jpg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-7.2.4"><title>Backpropagation - Data Science with Harsha</title><link rel=stylesheet href=../../assets/stylesheets/main.f7f47774.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../overrides/assets/stylesheets/user_defined.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-65034507-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#introduction class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science with Harsha" class="md-header__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science with Harsha </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Backpropagation </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_1> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_3> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_4> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science with Harsha" class="md-nav__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> Data Science with Harsha </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../resume/ class=md-nav__link> Resume </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Blog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Table_of_Contents/ class=md-nav__link> Table of Contents </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Visualization <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Visualization data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Vizualisation%20using%20python%20Part%201/ class=md-nav__link> Vizualizing tabular data (Python) </a> </li> <li class=md-nav__item> <a href=../Visualization%20for%20predictive%20analytics/ class=md-nav__link> Vizualising for predictive analytics (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Univariate-analysis/ class=md-nav__link> Univariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multivariateAnalysis/ class=md-nav__link> Multivariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multicollinearity/ class=md-nav__link> Multicollinearity (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Statistics basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Statistics basics" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Statistics basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Statistics%20basics/ class=md-nav__link> Statistics Basics (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Probability/ class=md-nav__link> Probability (R) </a> </li> <li class=md-nav__item> <a href=../../R/vectors/ class=md-nav__link> Vectors (R) </a> </li> <li class=md-nav__item> <a href=../../R/matrices/ class=md-nav__link> Matrices (R) </a> </li> <li class=md-nav__item> <a href=../Call%20center%20distributions/ class=md-nav__link> Call center distributions (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Hypothesis Testing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hypothesis Testing" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Hypothesis Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/attendance_t_test/ class=md-nav__link> z-test and t-test (R) </a> </li> <li class=md-nav__item> <a href=../../R/anova/ class=md-nav__link> ANOVA Test (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-goodness-of-fit/ class=md-nav__link> Chi-Square Goodness of fit (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-test-of-independence/ class=md-nav__link> Chi-Square test of independence (R) </a> </li> <li class=md-nav__item> <a href=../Hypothesis_Testing_Python/ class=md-nav__link> Hypothesis testing using Python </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Factor Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Factor Analysis" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Factor Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Curse-of-Dimensionality/ class=md-nav__link> Curse of dimensionality </a> </li> <li class=md-nav__item> <a href=../../R/EFA/ class=md-nav__link> Exploratory factor analysis (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Preprocessing data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preprocessing data" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Preprocessing data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/KNN_Imputation/ class=md-nav__link> Null Value Imputation (R) </a> </li> <li class=md-nav__item> <a href=../Machine%20Learning%20Part%201/ class=md-nav__link> Feature engineering (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Handling-Imbalanced-classes/ class=md-nav__link> Handling Imbalanced Classes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Prediction algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prediction algorithms" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Prediction algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7_1 type=checkbox id=__nav_3_7_1> <label class=md-nav__link for=__nav_3_7_1> Classification Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Classification Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_7_1> <span class="md-nav__icon md-icon"></span> Classification Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/logistic-regression/ class=md-nav__link> Logistic Regression (R) </a> </li> <li class=md-nav__item> <a href=../../R/CHAID/ class=md-nav__link> CHAID Decision Trees (R) </a> </li> <li class=md-nav__item> <a href=../../R/CART-Classification/ class=md-nav__link> CART Classification (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7_2 type=checkbox id=__nav_3_7_2> <label class=md-nav__link for=__nav_3_7_2> Regression Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Regression Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_7_2> <span class="md-nav__icon md-icon"></span> Regression Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/part-and-partial-corr/ class=md-nav__link> Part and partial correlation </a> </li> <li class=md-nav__item> <a href=../../R/Linear-regression/ class=md-nav__link> Linear Regression (R) </a> </li> <li class=md-nav__item> <a href=../Linear%20regression%20usecase%20mpg%20prediction/ class=md-nav__link> Lasso and Ridge regression (Python) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Machine Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Machine Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://harshaachyuthuni.shinyapps.io/Machine_Learning/ class=md-nav__link> Interactive Machine Learning (RShiny) </a> </li> <li class=md-nav__item> <a href=../ML%20using%20scikit-learn/ class=md-nav__link> Multi models (Python) </a> </li> <li class=md-nav__item> <a href=../Explainable%20models%20using%20Heart%20Failure/ class=md-nav__link> Explainable ML (Python) </a> </li> <li class=md-nav__item> <a href=../Demonstrating%20online%20learning/ class=md-nav__link> Streaming Machine Learning (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Time Series forecasting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Time Series forecasting" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Time Series forecasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/time-series/ class=md-nav__link> Introduction to stationarity (R) </a> </li> <li class=md-nav__item> <a href=../../R/Stationarity-tests/ class=md-nav__link> Stationary Tests (R) </a> </li> <li class=md-nav__item> <a href=../../R/ARIMA/ class=md-nav__link> ARIMA in R </a> </li> <li class=md-nav__item> <a href=../ARIMA%20Forecasting/ class=md-nav__link> ARIMA in Python </a> </li> <li class=md-nav__item> <a href=../../R/Seasonal-Time-Series/ class=md-nav__link> Seasonal time series (R) </a> </li> <li class=md-nav__item> <a href=../../R/VAR-models/ class=md-nav__link> VAR Models (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10 checked> <label class=md-nav__link for=__nav_3_10> Deep learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deep learning" data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Deep learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ANN-1/ class=md-nav__link> Perceptron </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Backpropagation <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Backpropagation </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#multi-layer-perceptron class=md-nav__link> Multi-layer perceptron </a> </li> <li class=md-nav__item> <a href=#perceptron class=md-nav__link> Perceptron </a> </li> <li class=md-nav__item> <a href=#training class=md-nav__link> Training </a> <nav class=md-nav aria-label=Training> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nomenclature class=md-nav__link> Nomenclature </a> </li> <li class=md-nav__item> <a href=#initialising class=md-nav__link> Initialising </a> </li> <li class=md-nav__item> <a href=#feedforward-loop class=md-nav__link> Feedforward loop </a> <nav class=md-nav aria-label="Feedforward loop"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#input-layer class=md-nav__link> Input layer </a> </li> <li class=md-nav__item> <a href=#hidden-layer class=md-nav__link> Hidden layer </a> </li> <li class=md-nav__item> <a href=#output-layer class=md-nav__link> Output layer </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#backpropagation-of-error class=md-nav__link> Backpropagation of error </a> <nav class=md-nav aria-label="Backpropagation of error"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-layer_1 class=md-nav__link> Output layer </a> </li> <li class=md-nav__item> <a href=#hidden-layer_1 class=md-nav__link> Hidden layer </a> </li> <li class=md-nav__item> <a href=#update-weights-and-biases class=md-nav__link> Update weights and biases </a> </li> <li class=md-nav__item> <a href=#gradient-descent-and-training class=md-nav__link> Gradient descent and training </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prediction-and-accuracy class=md-nav__link> Prediction and accuracy </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#derivation-of-learning-rules class=md-nav__link> Derivation of learning rules </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../DNN/ class=md-nav__link> Tensorflow and Keras </a> </li> <li class=md-nav__item> <a href=../Time%20series%20deep%20learning/ class=md-nav__link> Time series (python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_11 type=checkbox id=__nav_3_11> <label class=md-nav__link for=__nav_3_11> Generative AI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Generative AI" data-md-level=2> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> Generative AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../LLM%20Tokenizers/ class=md-nav__link> LLM Tokenizers </a> </li> <li class=md-nav__item> <a href=../prompt_engineering_techniques/ class=md-nav__link> Prompt Engineering </a> </li> <li class=md-nav__item> <a href=../Agentic%20AI/ class=md-nav__link> Agentic AI </a> </li> <li class=md-nav__item> <a href=../RAG/ class=md-nav__link> RAG </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_12 type=checkbox id=__nav_3_12> <label class=md-nav__link for=__nav_3_12> Prescriptive Analytics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prescriptive Analytics" data-md-level=2> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Prescriptive Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Linear-programming/ class=md-nav__link> Linear Programming (R) </a> </li> <li class=md-nav__item> <a href=../../Others/integer_programming_blog/ class=md-nav__link> Integer Programming tricks </a> </li> <li class=md-nav__item> <a href=../inventory_optimization_eoq_ortools/ class=md-nav__link> Inventory Optimisation (Python) </a> </li> <li class=md-nav__item> <a href=../../R/adoption_of_new_product/ class=md-nav__link> Adoption of new product (R) </a> </li> <li class=md-nav__item> <a href=../Diffusion%20on%20networks/ class=md-nav__link> Bass Forecasting model (Python) </a> </li> <li class=md-nav__item> <a href=../../Others/AHP/ class=md-nav__link> Analytic Hierarchy Process </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_13 type=checkbox id=__nav_3_13> <label class=md-nav__link for=__nav_3_13> Clustering <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Clustering data-md-level=2> <label class=md-nav__title for=__nav_3_13> <span class="md-nav__icon md-icon"></span> Clustering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/hierarchical_clustering/ class=md-nav__link> Hierarchical Clustering </a> </li> <li class=md-nav__item> <a href=../../R/kMeansClustering/ class=md-nav__link> K-Means Clustering </a> </li> <li class=md-nav__item> <a href=../train_delays/ class=md-nav__link> DBSCAN Clustering (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_14 type=checkbox id=__nav_3_14> <label class=md-nav__link for=__nav_3_14> Reinforcement Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reinforcement Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_14> <span class="md-nav__icon md-icon"></span> Reinforcement Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/CustomerLifetimeValue/ class=md-nav__link> Customer Lifetime Value </a> </li> <li class=md-nav__item> <a href=../../R/recommendation-systems/ class=md-nav__link> Recommendation Systems (R) </a> </li> <li class=md-nav__item> <a href=../Neural_collaborative_filtering/ class=md-nav__link> Collaborative Filtering (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_15 type=checkbox id=__nav_3_15> <label class=md-nav__link for=__nav_3_15> Networks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networks data-md-level=2> <label class=md-nav__title for=__nav_3_15> <span class="md-nav__icon md-icon"></span> Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Introduction%20to%20Networkx/ class=md-nav__link> Introduction to NetworkX (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Science/ class=md-nav__link> Network Science (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20centrality/ class=md-nav__link> Network Centrality (Python) </a> </li> <li class=md-nav__item> <a href=../Shortest%20path%20problems/ class=md-nav__link> Shortest path using integer programming (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Flow%20problems/ class=md-nav__link> Network flow problems (Python) </a> </li> <li class=md-nav__item> <a href=../Community%20detection/ class=md-nav__link> Community detection (Python) </a> </li> <li class=md-nav__item> <a href=../Bipartite%20matching/ class=md-nav__link> Bipartite matching (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_16 type=checkbox id=__nav_3_16> <label class=md-nav__link for=__nav_3_16> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=2> <label class=md-nav__title for=__nav_3_16> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Machine%20learning%20as%20HTTP%20Request/ class=md-nav__link> ML deployment in Flask (Python) </a> </li> <li class=md-nav__item> <a href=../Saving%20predictions%20in%20database/ class=md-nav__link> Handling databases using python </a> </li> <li class=md-nav__item> <a href=../ORM/ class=md-nav__link> ORM (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_17 type=checkbox id=__nav_3_17> <label class=md-nav__link for=__nav_3_17> Higher education review <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Higher education review" data-md-level=2> <label class=md-nav__title for=__nav_3_17> <span class="md-nav__icon md-icon"></span> Higher education review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/IIMB%20BAI/ class=md-nav__link> IIMB BAI </a> </li> <li class=md-nav__item> <a href=../../Others/part%20time%20data%20science%20masters/ class=md-nav__link> Part-time DS masters </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_18 type=checkbox id=__nav_3_18> <label class=md-nav__link for=__nav_3_18> External blogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="External blogs" data-md-level=2> <label class=md-nav__title for=__nav_3_18> <span class="md-nav__icon md-icon"></span> External blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Imperial%20College%20London/ class=md-nav__link> Imperial college London </a> </li> <li class=md-nav__item> <a href=../../Others/Rolls%20Royce/ class=md-nav__link> Rolls Royce </a> </li> <li class=md-nav__item> <a href=../../Others/Publications/ class=md-nav__link> Publications/conferences </a> </li> <li class=md-nav__item> <a href=../../Others/Deployed%20apps/ class=md-nav__link> Deployed apps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_19 type=checkbox id=__nav_3_19> <label class=md-nav__link for=__nav_3_19> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=__nav_3_19> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/preventive_maintainence/ class=md-nav__link> Preventive maintainence </a> </li> <li class=md-nav__item> <a href=../../Others/Contract%20Intelligence%20tool/ class=md-nav__link> Contract Intelligence </a> </li> <li class=md-nav__item> <a href=../../Others/competitor%20intelligence/ class=md-nav__link> Competitor intelligence </a> </li> <li class=md-nav__item> <a href=../../Others/Scarecrow/ class=md-nav__link> Intelligent annotation </a> </li> <li class=md-nav__item> <a href=../../Others/Demand%20Forecasting/ class=md-nav__link> Demand Forecasting </a> </li> <li class=md-nav__item> <a href=../../Others/bid%20allocation%20model/ class=md-nav__link> Bid Allocation </a> </li> <li class=md-nav__item> <a href=../../Others/IIMB%20project/ class=md-nav__link> Reward and Recognition contests </a> </li> <li class=md-nav__item> <a href=../../Others/supply%20chain%20analytics/ class=md-nav__link> Supply chain analytics </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#multi-layer-perceptron class=md-nav__link> Multi-layer perceptron </a> </li> <li class=md-nav__item> <a href=#perceptron class=md-nav__link> Perceptron </a> </li> <li class=md-nav__item> <a href=#training class=md-nav__link> Training </a> <nav class=md-nav aria-label=Training> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nomenclature class=md-nav__link> Nomenclature </a> </li> <li class=md-nav__item> <a href=#initialising class=md-nav__link> Initialising </a> </li> <li class=md-nav__item> <a href=#feedforward-loop class=md-nav__link> Feedforward loop </a> <nav class=md-nav aria-label="Feedforward loop"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#input-layer class=md-nav__link> Input layer </a> </li> <li class=md-nav__item> <a href=#hidden-layer class=md-nav__link> Hidden layer </a> </li> <li class=md-nav__item> <a href=#output-layer class=md-nav__link> Output layer </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#backpropagation-of-error class=md-nav__link> Backpropagation of error </a> <nav class=md-nav aria-label="Backpropagation of error"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-layer_1 class=md-nav__link> Output layer </a> </li> <li class=md-nav__item> <a href=#hidden-layer_1 class=md-nav__link> Hidden layer </a> </li> <li class=md-nav__item> <a href=#update-weights-and-biases class=md-nav__link> Update weights and biases </a> </li> <li class=md-nav__item> <a href=#gradient-descent-and-training class=md-nav__link> Gradient descent and training </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prediction-and-accuracy class=md-nav__link> Prediction and accuracy </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#derivation-of-learning-rules class=md-nav__link> Derivation of learning rules </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Backpropagation</h1> <script type=text/javascript src=https://cdn.mathjax.org/mathjax/latest/MathJax.js>
MathJax.Hub.Config({
 extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
 jax: ["input/TeX", "output/HTML-CSS"],
 tex2jax: {
     inlineMath: [ ['$','$'], ["\\(","\\)"] ],
     displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
 },
 "HTML-CSS": { availableFonts: ["TeX"] }
});
</script> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>This is the second in a series of blogs about <a href=../ANN-1/ >neural networks</a>. In this blog, we will discuss and implement the backpropagation algorithm from scratch. In the previous blog, we have seen how a single perceptron works when the data is linearly separable. In this blog, we will look at the workings of a multi-layered perceptron (with theory) and understand the maths behind backpropagation. </p> <h2 id=multi-layer-perceptron>Multi-layer perceptron<a class=headerlink href=#multi-layer-perceptron title="Permanent link">&para;</a></h2> <p>An MLP is composed of one input layer, one or more layers of perceptrons called hidden layers, and one final perceptron layer called the output layer. Every layer except the input layer is connected with a bias neuron and is fully connected to the next layer. </p> <h2 id=perceptron>Perceptron<a class=headerlink href=#perceptron title="Permanent link">&para;</a></h2> <p>In the previous blog, we saw a perceptron with a single TLU. A Perceptron with two inputs and three outputs is shown below. Generally, an extra bias feature is added as input. It represents a particular type of neuron called a bias neuron. A bias neuron outputs one all the time. This layer of TLUs is called a perceptron. </p> <p><img alt=image.png src=../ANN-2/download1.png></p> <p>In the above perceptron, the inputs are x1 and x2. The outputs are y1, y2 and y3. Θ (or f) is the activation function. In the last blog, the step function is taken as the activation function. There are other activation functions such as:<br> <strong>Sigmoid function</strong>: It is S-shaped, continuous and differentiable where the output ranges from 0 to 1.<br> $$ f(z)=\frac{1}{1+e^{-z}} $$<br> <strong>Hyperbolic Tangent function</strong>: It is S-shaped, continuous and differentiable where the output ranges from -1 to 1. $$ f\left(z\right)=Tanh\left(z\right) $$ </p> <p><strong>ReLU</strong>: Rectified Linear Unit function or ReLU is continuous but not differentiable at z=0. It can be defined as max(z,0), so it is zero for all negative values of z, and linear for all positive values. $$ f(z) = max(z,0) $$</p> <h2 id=training>Training<a class=headerlink href=#training title="Permanent link">&para;</a></h2> <p>Training a network in ANN has three stages, feedforward of input training pattern, backpropagation of the error and adjustment of weights. Let us understand it using a simple example. Consider a simple two-layered perceptron as shown: </p> <p><img alt=image-2.png src=../ANN-2/download2.png></p> <h3 id=nomenclature>Nomenclature<a class=headerlink href=#nomenclature title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Symbol</th> <th>Meaning</th> <th>Symbol</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td><span class=arithmatex>\(X_i\)</span></td> <td>Input neuron</td> <td><span class=arithmatex>\(Y_k\)</span></td> <td>Output neuron</td> </tr> <tr> <td><span class=arithmatex>\(x_i\)</span></td> <td>Input value</td> <td><span class=arithmatex>\(y_k\)</span> or <span class=arithmatex>\(y_{actual}\)</span></td> <td>Output value</td> </tr> <tr> <td><span class=arithmatex>\(Z_j\)</span></td> <td>Hidden neuron</td> <td><span class=arithmatex>\(z_j\)</span></td> <td>The output of a hidden neuron</td> </tr> <tr> <td><span class=arithmatex>\(w_{jk}\)</span></td> <td>Weight of j to k</td> <td><span class=arithmatex>\(v_{ij}\)</span></td> <td>weight of i to j</td> </tr> <tr> <td><span class=arithmatex>\(\theta_k\)</span></td> <td>Error propagating from <span class=arithmatex>\(Y_k\)</span> to <span class=arithmatex>\(Z_k\)</span></td> <td><span class=arithmatex>\(\theta_j\)</span></td> <td>Error propagating from <span class=arithmatex>\(Z_k\)</span> to <span class=arithmatex>\(X_k\)</span></td> </tr> <tr> <td><span class=arithmatex>\(\delta_k\)</span></td> <td>The portion of error correction for weight <span class=arithmatex>\(w_{jk}\)</span></td> <td><span class=arithmatex>\(\delta_j\)</span></td> <td>The portion of error correction for weight <span class=arithmatex>\(v_{ij}\)</span></td> </tr> <tr> <td><span class=arithmatex>\(\alpha\)</span></td> <td>Learning rate</td> <td><span class=arithmatex>\(t_j\)</span> or <span class=arithmatex>\(y_{pred}\)</span></td> <td>Predicted output</td> </tr> <tr> <td>f</td> <td>Activation function</td> <td>--</td> <td>--</td> </tr> </tbody> </table> <h3 id=initialising>Initialising<a class=headerlink href=#initialising title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=n>num_inputs</span> <span class=o>=</span> <span class=mi>50</span>
<span class=n>input_dimension</span> <span class=o>=</span> <span class=mi>2</span>
<span class=n>hidden_layer_dimension</span> <span class=o>=</span> <span class=mi>2</span>
<span class=n>output_dimension</span> <span class=o>=</span> <span class=mi>2</span>
<span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span>
</code></pre></div> <p>Let us consider the sigmoid function as an activation function and create input and output values.</p> <div class=highlight><pre><span></span><code><span class=c1># Sigmoid function</span>
<span class=k>def</span><span class=w> </span><span class=nf>sigmoid</span><span class=p>(</span><span class=n>model_output</span><span class=p>):</span>
    <span class=k>return</span> <span class=mi>1</span><span class=o>/</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>model_output</span><span class=p>))</span>

<span class=c1># Creating random input values</span>
<span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>(),</span> <span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_inputs</span><span class=p>)])</span>

<span class=c1># Creating output values</span>
<span class=n>y_actual</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>sigmoid</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>+</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mf>0.1</span><span class=p>)</span><span class=o>+</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mf>0.1</span>

<span class=c1># The first input to the model is</span>
<span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([0.17988842, 0.42611707])
</code></pre></div> <p>Adding a bias neuron</p> <div class=highlight><pre><span></span><code><span class=n>bias</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>num_inputs</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
<span class=n>x_bias</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias</span><span class=p>,</span> <span class=n>x</span><span class=p>))</span>

<span class=c1># Adding the bias, the input becomes</span>
<span class=n>x_bias</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([1.        , 0.17988842, 0.42611707])
</code></pre></div> <p>Creating the hidden layer and initialising weights with random numbers</p> <div class=highlight><pre><span></span><code><span class=n>v</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>input_dimension</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=n>hidden_layer_dimension</span><span class=p>)</span>

<span class=c1># Inital weights are</span>
<span class=n>v</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([[ 0.49671415, -0.1382643 ],
       [ 0.64768854,  1.52302986],
       [-0.23415337, -0.23413696]])
</code></pre></div> <p>Creating the output layer and initialising weights with random numbers</p> <div class=highlight><pre><span></span><code><span class=n>w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>hidden_layer_dimension</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=n>output_dimension</span><span class=p>)</span>

<span class=c1># Hidden layer weights are</span>
<span class=n>w</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([[ 1.57921282,  0.76743473],
       [-0.46947439,  0.54256004],
       [-0.46341769, -0.46572975]])
</code></pre></div> <h3 id=feedforward-loop>Feedforward loop<a class=headerlink href=#feedforward-loop title="Permanent link">&para;</a></h3> <p>During feedforward, each input unit <span class=arithmatex>\(X_i\)</span> receives input and broadcasts the signal to each of the hidden units <span class=arithmatex>\(Z_1\ldots Z_j\)</span>. Each hidden unit then computes its activation and sends its signal (<span class=arithmatex>\(z_j\)</span>) to each output unit. Each output unit <span class=arithmatex>\(Y_k\)</span> computes its activation (<span class=arithmatex>\(y_k\)</span>) to form the response to the input pattern. </p> <h4 id=input-layer>Input layer<a class=headerlink href=#input-layer title="Permanent link">&para;</a></h4> <p>Step 1. Each input unit (<span class=arithmatex>\(X_i\)</span>) receives the input <span class=arithmatex>\(x_i\)</span> and broadcasts this signal to all units to the hidden layers <span class=arithmatex>\(Z_j\)</span>. </p> <h4 id=hidden-layer>Hidden layer<a class=headerlink href=#hidden-layer title="Permanent link">&para;</a></h4> <p>Step 2. Each hidden unit (<span class=arithmatex>\(Z_j\)</span>) sums its weighted input signals <span class=arithmatex>\(z\_in_j=v_{0j}+\sum_{i} x_i\times v_{ij}\)</span> </p> <div class=highlight><pre><span></span><code><span class=n>Z_input</span> <span class=o>=</span> <span class=n>x_bias</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>

<span class=c1># Input to the hidden layer</span>
<span class=n>Z_input</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([0.51344907, 0.03594138])
</code></pre></div> <p>Step 3. The activation function is applied to this weighted sum to get the output. <span class=arithmatex>\(z_j=f\left(z\_in_j\right)\)</span> (where f is the activation function). </p> <div class=highlight><pre><span></span><code><span class=n>z</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>Z_input</span><span class=p>)</span>
<span class=n>z_bias</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias</span><span class=p>,</span> <span class=n>z</span><span class=p>))</span>

<span class=c1># Output in the hidden layer</span>
<span class=n>z_bias</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([1.        , 0.62561467, 0.50898438])
</code></pre></div> <p>Step 4. Each hidden layer sends this signal (<span class=arithmatex>\(z_j\)</span>) to the output layers. </p> <h4 id=output-layer>Output layer<a class=headerlink href=#output-layer title="Permanent link">&para;</a></h4> <p>step 5. Each output unit (<span class=arithmatex>\(Y_k\)</span>) sums its weighted input signals <span class=arithmatex>\(y\_in_k=w_{0k}+\sum_{j}z_j\times w_{jk}\)</span> </p> <div class=highlight><pre><span></span><code><span class=n>Y_input</span> <span class=o>=</span> <span class=n>z_bias</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>

<span class=c1># Input to output layer</span>
<span class=n>Y_input</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([1.04963039, 0.86981908])
</code></pre></div> <p>Step 6. The activation function is applied to this weighted sum to get the output. <span class=arithmatex>\(y_k=f\left(y\_in_k\right)\)</span> (where f is the activation function). </p> <div class=highlight><pre><span></span><code><span class=n>y_pred</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>Y_input</span><span class=p>)</span>

<span class=c1># Predicted output</span>
<span class=n>y_pred</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([0.74070392, 0.70470805])
</code></pre></div> <h3 id=backpropagation-of-error>Backpropagation of error<a class=headerlink href=#backpropagation-of-error title="Permanent link">&para;</a></h3> <p>During training, each output unit <span class=arithmatex>\(Y_k\)</span> compares its predicted output <span class=arithmatex>\(y_k\)</span> with its actual output <span class=arithmatex>\(t_k\)</span> to determine the error associated with that unit. Based on this error, <span class=arithmatex>\(\delta_k\)</span> is computed. This <span class=arithmatex>\(\delta_k\)</span> is used to distribute the error at the output unit back to all input units in the previous layers. Similarly, <span class=arithmatex>\(\delta_j\)</span> is computed for all hidden layers <span class=arithmatex>\(Z_j\)</span> which is propagated to the input layer. </p> <h4 id=output-layer_1>Output layer<a class=headerlink href=#output-layer_1 title="Permanent link">&para;</a></h4> <p>Step 7. The error information term (<span class=arithmatex>\(\theta_k\)</span>) is computed at every output unit (<span class=arithmatex>\(Y_k\)</span>). $$ \theta_k=\left(t_k-y_k\right)f’ $$ $$ \delta_k=\left(t_k-y_k\right)f’ y_in_k $$</p> <p>Note: <span class=arithmatex>\(f’(z) = \frac{d}{dz}(\frac{1}{1+e^{-z}}) = f(z)\times(1-f(z))\)</span></p> <div class=highlight><pre><span></span><code><span class=n>theta_k</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_actual</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>y_pred</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>y_pred</span><span class=p>))</span>
<span class=n>delta_k</span> <span class=o>=</span> <span class=n>z_bias</span><span class=o>.</span><span class=n>T</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>theta_k</span><span class=p>)</span>

<span class=c1># Error that has to backpropogated in output layer</span>
<span class=n>delta_k</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([0.54340751, 0.28015272])
</code></pre></div> <p>Step 8. This error is propagated back to the hidden layer. (later weights will be updated using this <span class=arithmatex>\(\delta\)</span>) </p> <h4 id=hidden-layer_1>Hidden layer<a class=headerlink href=#hidden-layer_1 title="Permanent link">&para;</a></h4> <p>Step 9. Each hidden unit (<span class=arithmatex>\(Z_j\)</span>) sums its weighted error from the output layer $$ \theta_in_j=\sum_{k}\theta_k\times w_{jk} $$</p> <div class=highlight><pre><span></span><code><span class=n>theta_in_j</span> <span class=o>=</span> <span class=n>theta_k</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>

<span class=c1># Error split across weights</span>
<span class=n>theta_in_j</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([-0.01210996,  0.00547047])
</code></pre></div> <p>Step 10. The derivative of the activation function is multiplied by this weighted sum to get the weighted error information term at the hidden layer. $$ \theta_j=\theta_in_j \times f^\prime $$ $$ \delta_j=\delta_in_j \times f^\prime\left(z_in_j\right) $$</p> <div class=highlight><pre><span></span><code><span class=n>theta_j</span> <span class=o>=</span> <span class=n>theta_in_j</span><span class=o>*</span><span class=p>(</span><span class=n>z</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>z</span><span class=p>))</span>
<span class=n>delta_j</span> <span class=o>=</span> <span class=n>x_bias</span><span class=o>.</span><span class=n>T</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>theta_j</span><span class=p>)</span>


<span class=c1># Error that has to be backpropogated in hidden layer</span>
<span class=n>delta_j</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([-0.08582196,  0.03962274])
</code></pre></div> <p>Step 11. This error is propagated back to the initial layer. </p> <h4 id=update-weights-and-biases>Update weights and biases<a class=headerlink href=#update-weights-and-biases title="Permanent link">&para;</a></h4> <p>The <span class=arithmatex>\(\delta_k\)</span> and <span class=arithmatex>\(\delta_j\)</span> are used to update the weights <span class=arithmatex>\(w_{jk}\)</span> and <span class=arithmatex>\(v_{ij}\)</span> respectively. The weight adjustment is based on gradient descent and is dependent on error gradient (<span class=arithmatex>\(\delta\)</span>), learning rate (<span class=arithmatex>\(\alpha\)</span>) and input to the neuron. </p> <p>Step 12. The weights are updated based on the error information terms $$ w_{jk}\left(new\right)=w_{jk}\left(old\right)+\Delta w_{jk} $$ where $ \Delta w_{jk}=\alpha\times\delta_k\times z_j $ <br> $$ v_{ij}\left(new\right)=v_{ij}\left(old\right)+\Delta v_{ij} $$ where $ \Delta v_{ij}=\alpha\times\delta_j\times x_i $ </p> <div class=highlight><pre><span></span><code><span class=c1># Updating weights</span>
<span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>-</span> <span class=n>alpha</span><span class=o>*</span><span class=n>delta_k</span>
<span class=n>v</span> <span class=o>=</span> <span class=n>v</span> <span class=o>-</span> <span class=n>alpha</span><span class=o>*</span><span class=n>delta_j</span>
</code></pre></div> <h4 id=gradient-descent-and-training>Gradient descent and training<a class=headerlink href=#gradient-descent-and-training title="Permanent link">&para;</a></h4> <p>Gradient descent is an iterative optimization algorithm for finding the minimum of a function; in our case, we want to minimize the error function. To find a local minimum of a function using gradient descent, one takes steps proportional to the negative of the gradient of the function at the current point. This means training steps 1-12 are done for each training epoch until a stopping criterion is met. </p> <p>Stopping criterion: Difference in error between the previous epoch and current epoch is at least greater than 0.00001</p> <div class=highlight><pre><span></span><code><span class=c1># Repeat for 10000 iterations or stop at stopping criterion</span>
<span class=n>error</span> <span class=o>=</span> <span class=n>y_actual</span> <span class=o>-</span> <span class=n>y_pred</span>
<span class=n>rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>((</span><span class=n>error</span><span class=o>**</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
<span class=n>error_array</span> <span class=o>=</span> <span class=p>[</span><span class=n>rmse</span><span class=p>]</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>):</span>
    <span class=c1># Feedforward loop</span>
    <span class=n>Z_input</span> <span class=o>=</span> <span class=n>x_bias</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
    <span class=n>z</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>Z_input</span><span class=p>)</span>
    <span class=n>z_bias</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias</span><span class=p>,</span> <span class=n>z</span><span class=p>))</span>
    <span class=n>Y_input</span> <span class=o>=</span> <span class=n>z_bias</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>Y_input</span><span class=p>)</span>

    <span class=c1># Backpropogation</span>
    <span class=n>theta_k</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_actual</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>y_pred</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>y_pred</span><span class=p>))</span>
    <span class=n>delta_k</span> <span class=o>=</span> <span class=n>z_bias</span><span class=o>.</span><span class=n>T</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>theta_k</span><span class=p>)</span>
    <span class=n>theta_in_j</span> <span class=o>=</span> <span class=n>theta_k</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
    <span class=n>theta_j</span> <span class=o>=</span> <span class=n>theta_in_j</span><span class=o>*</span><span class=p>(</span><span class=n>z</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>z</span><span class=p>))</span>
    <span class=n>delta_j</span> <span class=o>=</span> <span class=n>x_bias</span><span class=o>.</span><span class=n>T</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>theta_j</span><span class=p>)</span>
    <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>-</span> <span class=n>alpha</span><span class=o>*</span><span class=n>delta_k</span>
    <span class=n>v</span> <span class=o>=</span> <span class=n>v</span> <span class=o>-</span> <span class=n>alpha</span><span class=o>*</span><span class=n>delta_j</span>

    <span class=c1># Calculating error</span>
    <span class=n>error</span> <span class=o>=</span> <span class=n>y_actual</span> <span class=o>-</span> <span class=n>y_pred</span>
    <span class=n>rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>((</span><span class=n>error</span><span class=o>**</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
<span class=c1>#     print(i, rmse)</span>

    <span class=n>error_array</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rmse</span><span class=p>)</span>
    <span class=k>if</span><span class=p>((</span><span class=n>i</span><span class=o>&gt;</span><span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>rmse</span><span class=o>-</span><span class=n>error_array</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>])</span><span class=o>&lt;</span><span class=mf>0.000001</span><span class=p>)):</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>error_array</span><span class=p>))),</span> <span class=n>error_array</span><span class=p>)</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;RMSE across epochs&#39;</span><span class=p>)</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Number of epochs&#39;</span><span class=p>)</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;RMSE&#39;</span><span class=p>)</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>();</span>
        <span class=k>break</span>
</code></pre></div> <p><img alt=png src=../ANN-2/output_27_0.png></p> <h3 id=prediction-and-accuracy>Prediction and accuracy<a class=headerlink href=#prediction-and-accuracy title="Permanent link">&para;</a></h3> <p>Using the updated weights, we can predict the values for any new data point.</p> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>prediction</span><span class=p>(</span><span class=n>x_pred</span><span class=p>):</span>
    <span class=n>bias_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>x_pred</span><span class=p>),</span> <span class=mi>1</span><span class=p>))</span>
    <span class=k>return</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_</span><span class=p>,</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_</span><span class=p>,</span> <span class=n>x_pred</span><span class=p>))</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>v</span><span class=p>))))</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>))</span>
<span class=n>prediction</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>1</span><span class=p>])</span>
</code></pre></div> <div class=highlight><pre><span></span><code>array([[0.65845299, 0.67733945]])
</code></pre></div> <p>Actual vs predicted variables are also plotted below</p> <div class=highlight><pre><span></span><code><span class=n>fs</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>gridspec_kw</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;height_ratios&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>]},</span> <span class=n>constrained_layout</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y_actual</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y_pred</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>

<span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>y_actual</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Actual&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>y_pred</span><span class=o>.</span><span class=n>T</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Predicted&#39;</span><span class=p>)</span>

<span class=c1># plt.title(&#39;Actual vs prediction&#39;)</span>

<span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Y1&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;X1&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Relationship between X1 and Y1&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;X2&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Y2&#39;</span><span class=p>)</span>
<span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Relationship between X2 and Y2&#39;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>&#39;lower right&#39;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>();</span>
</code></pre></div> <p><img alt=png src=../ANN-2/output_31_1.png></p> <p>The final network along with its weights can be plotted using <a href=../Network%20Science/ >networkx</a>.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>networkx</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>nx</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=n>g</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>()</span>
<span class=n>edgelist_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;node1&#39;</span><span class=p>:[</span><span class=s1>&#39;B1&#39;</span><span class=p>,</span> <span class=s1>&#39;B1&#39;</span><span class=p>,</span> <span class=s1>&#39;X1&#39;</span><span class=p>,</span> <span class=s1>&#39;X1&#39;</span><span class=p>,</span> <span class=s1>&#39;X2&#39;</span><span class=p>,</span> <span class=s1>&#39;X2&#39;</span><span class=p>,</span> <span class=s1>&#39;B2&#39;</span><span class=p>,</span> <span class=s1>&#39;B2&#39;</span><span class=p>,</span> <span class=s1>&#39;Z1&#39;</span><span class=p>,</span> <span class=s1>&#39;Z1&#39;</span><span class=p>,</span> <span class=s1>&#39;Z2&#39;</span><span class=p>,</span> <span class=s1>&#39;Z2&#39;</span><span class=p>],</span> 
    <span class=s1>&#39;node2&#39;</span><span class=p>:[</span><span class=s1>&#39;Z1&#39;</span><span class=p>,</span> <span class=s1>&#39;Z2&#39;</span><span class=p>,</span> <span class=s1>&#39;Z1&#39;</span><span class=p>,</span> <span class=s1>&#39;Z2&#39;</span><span class=p>,</span> <span class=s1>&#39;Z1&#39;</span><span class=p>,</span> <span class=s1>&#39;Z2&#39;</span><span class=p>,</span> <span class=s1>&#39;Y1&#39;</span><span class=p>,</span> <span class=s1>&#39;Y2&#39;</span><span class=p>,</span> <span class=s1>&#39;Y1&#39;</span><span class=p>,</span> <span class=s1>&#39;Y2&#39;</span><span class=p>,</span> <span class=s1>&#39;Y1&#39;</span><span class=p>,</span> <span class=s1>&#39;Y2&#39;</span><span class=p>],</span> 
    <span class=s1>&#39;weights&#39;</span><span class=p>:[</span> <span class=s1>&#39;</span><span class=si>%.2f</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>elem</span> <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>v</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span> <span class=p>,</span><span class=n>w</span><span class=o>.</span><span class=n>flatten</span><span class=p>()))],</span>
    <span class=s1>&#39;width&#39;</span><span class=p>:</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>v</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span> <span class=p>,</span><span class=n>w</span><span class=o>.</span><span class=n>flatten</span><span class=p>())),</span>
    <span class=s1>&#39;color&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;green&#39;</span> <span class=k>if</span> <span class=n>val</span><span class=o>&gt;</span><span class=mi>0</span> <span class=k>else</span> <span class=s1>&#39;red&#39;</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>v</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span> <span class=p>,</span><span class=n>w</span><span class=o>.</span><span class=n>flatten</span><span class=p>()))]</span>
                           <span class=p>})</span>
<span class=n>g</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>()</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>elrow</span> <span class=ow>in</span> <span class=n>edgelist_df</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
    <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>elrow</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>elrow</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>weight</span><span class=o>=</span><span class=n>elrow</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=n>elrow</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=n>elrow</span><span class=p>[</span><span class=mi>4</span><span class=p>])</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;X1&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;X2&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;B1&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>3</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;Z1&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;Z2&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;B2&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;Y1&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s1>&#39;Y2&#39;</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>1</span><span class=p>))</span>
<span class=n>g</span><span class=o>.</span><span class=n>nodes</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># This function gets the weights for the edges </span>
<span class=n>weight</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>get_edge_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;weight&#39;</span><span class=p>)</span>
<span class=n>pos</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>)</span>
<span class=n>width</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>get_edge_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;width&#39;</span><span class=p>)</span>
<span class=n>color</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>get_edge_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;color&#39;</span><span class=p>)</span>
<span class=n>color</span> <span class=o>=</span> <span class=p>[</span><span class=n>color</span><span class=p>[</span><span class=n>val</span><span class=p>]</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>color</span><span class=p>]</span>
<span class=n>width</span> <span class=o>=</span> <span class=p>[</span><span class=nb>abs</span><span class=p>(</span><span class=n>width</span><span class=p>[</span><span class=n>val</span><span class=p>])</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>width</span><span class=p>]</span>

<span class=c1># nx.draw(g,pos, with_labels=True, edge_color= color, width=abs(np.hstack((v.flatten() ,w.flatten()))))</span>
<span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=n>pos</span><span class=p>,</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>edge_color</span> <span class=o>=</span> <span class=n>color</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=n>width</span><span class=p>)</span>
<span class=n>nx</span><span class=o>.</span><span class=n>draw_networkx_edge_labels</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=n>pos</span><span class=p>,</span><span class=n>edge_labels</span> <span class=o>=</span> <span class=n>weight</span><span class=p>,</span> <span class=n>label_pos</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Final Network after backpropagation&#39;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><img alt=png src=../ANN-2/output_33_0.png></p> <h2 id=derivation-of-learning-rules>Derivation of learning rules<a class=headerlink href=#derivation-of-learning-rules title="Permanent link">&para;</a></h2> <p>In every loop while training, we change the weights (<span class=arithmatex>\(v_{ij}\)</span> and <span class=arithmatex>\(w_{jk}\)</span>) to find the optimal solution. What we want to do is to find the effect of changing the weights on the error, and minimise the error using gradient descent.<br> The error gradient that has to be minimised is given by: $$ E=\frac{1}{2}\sum_{k}\left(t_k-y_k\right)^2 $$ The effect of changing an outer layer weight (<span class=arithmatex>\(w_{jk}\)</span>) on the error is given by: $$ \frac{\partial E}{\partial w_{jk}}=\frac{\partial}{\partial w_{jk}}\frac{1}{2}\sum_{k}\left(t_k-y_k\right)^2 $$ $$ =\left(y_k-t_k\right)\frac{\partial}{\partial w_{jk}}f\left(y_in_k\right) $$ $$ =\left(y_k-t_k\right)\times z_j\times f'\left(y_in_k\right) $$ Therefore $$ \Delta w_{jk}=\alpha\frac{\partial E}{\partial w_{jk}}=\alpha\times\left(y_k-t_k\right)\times z_j\times f^\prime\left(y_in_k\right)={\alpha\times\delta}_k\times z_j $$ </p> <p>The effect of changing the weight of a hidden layer weight (<span class=arithmatex>\(v_{ij}\)</span>) on the error is given by:<br> $$ \frac{\partial E}{\partial v_{ij}}=\sum_{k}{\left(y_k-t_k\right)\frac{\partial}{\partial v_{ij}}f\left(y_k\right)} $$ $$ =\sum_{k}\left(y_k-t_k\right)f^\prime\left(y_in_k\right)\frac{\partial}{\partial v_{ij}}f\left(y_k\right) $$ $$ =\sum_{k}\delta_kf^\prime\left(z_in_j\right)\left[x_i\right] =\delta_j\times x_i $$ Therefore $$ \Delta v_{ij}=\alpha\frac{\partial E}{\partial v_{ij}}={\alpha\times\delta}_j\times x_i $$ This way, for any number of layers, we can find the error information terms. Using gradient descent, we can minimise the error and find optimal weights for the ANN. In the next blog, we will discuss <a href=../DNN/ >tensorflow and keras</a>.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <ol> <li>Fausett, L., 1994. Fundamentals of neural networks: architectures, algorithms, and applications. Prentice-Hall, Inc. </li> <li><a href=https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/ >https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/</a> </li> <li>GeÌron, A. (2019). Hands-on machine learning with Scikit-Learn, Keras and TensorFlow: concepts, tools, and techniques to build intelligent systems (2<sup>nd</sup> ed.). O’Reilly. </li> <li>Class notes: Business Analytics &amp; Intelligence (BAI –10): Prof Naveen Kumar Bhansali </li> </ol> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ANN-1/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Perceptron" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Perceptron </div> </div> </a> <a href=../DNN/ class="md-footer__link md-footer__link--next" aria-label="Next: Tensorflow and Keras" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Tensorflow and Keras </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> <img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/88x31.png> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/HarshaAsh target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/sri-harsha-achyuthuni/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.instagram.com/harshaash_com/ target=_blank rel=noopener title=www.instagram.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=https://www.facebook.com/sri.harsha.achyuthuni/ target=_blank rel=noopener title=www.facebook.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "header.autohide", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56838a2c.min.js></script> </body> </html>