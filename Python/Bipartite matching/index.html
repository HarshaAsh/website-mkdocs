<!doctype html><html lang=en class=no-js> <head><!-- Code from google optimiser --><script src="https://www.googleoptimize.com/optimize.js?id=OPT-M98W6LW"></script><!-- Code from Mouseflow --><script type=text/javascript>
      window._mfq = window._mfq || [];
      (function() {
        var mf = document.createElement("script");
        mf.type = "text/javascript"; mf.defer = true;
        mf.src = "//cdn.mouseflow.com/projects/7b4494c9-7974-49f0-9777-d14450db37e6.js";
        document.getElementsByTagName("head")[0].appendChild(mf);
      })();
    </script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Harsha's blog on data science"><meta name=author content="Harsha Achyuthuni"><link href=https://www.harshaash.com/Python/Bipartite%20matching/ rel=canonical><link rel=icon href=../../assets/images/logo.jpg><meta name=generator content="mkdocs-1.3.1, mkdocs-material-7.2.4"><title>Bipartite matching (Python) - Data Science with Harsha</title><link rel=stylesheet href=../../assets/stylesheets/main.f7f47774.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../overrides/assets/stylesheets/user_defined.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-65034507-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#matching-algorithms class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science with Harsha" class="md-header__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science with Harsha </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Bipartite matching (Python) </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_1> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme data-md-color-primary data-md-color-accent aria-hidden=true type=radio name=__palette id=__palette_3> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_4> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science with Harsha" class="md-nav__button md-logo" aria-label="Data Science with Harsha" data-md-component=logo> <img src=../../assets/images/logo.jpg alt=logo> </a> Data Science with Harsha </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../resume/ class=md-nav__link> Resume </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Blog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_1 type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1> Visualization <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Visualization data-md-level=2> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Vizualisation%20using%20python%20Part%201/ class=md-nav__link> Vizualizing tabular data (Python) </a> </li> <li class=md-nav__item> <a href=../Visualization%20for%20predictive%20analytics/ class=md-nav__link> Vizualising for predictive analytics (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Univariate-analysis/ class=md-nav__link> Univariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multivariateAnalysis/ class=md-nav__link> Multivariate Analysis (R) </a> </li> <li class=md-nav__item> <a href=../../R/multicollinearity/ class=md-nav__link> Multicollinearity (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Statistics basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Statistics basics" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Statistics basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Probability/ class=md-nav__link> Probability (R) </a> </li> <li class=md-nav__item> <a href=../../R/vectors/ class=md-nav__link> Vectors (R) </a> </li> <li class=md-nav__item> <a href=../../R/matrices/ class=md-nav__link> Matrices (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Hypothesis Testing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hypothesis Testing" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Hypothesis Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/attendance_t_test/ class=md-nav__link> z-test and t-test (R) </a> </li> <li class=md-nav__item> <a href=../../R/anova/ class=md-nav__link> ANOVA Test (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-goodness-of-fit/ class=md-nav__link> Chi-Square Goodness of fit (R) </a> </li> <li class=md-nav__item> <a href=../../R/chi-sq-test-of-independence/ class=md-nav__link> Chi-Square test of independence (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Factor Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Factor Analysis" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Factor Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Curse-of-Dimensionality/ class=md-nav__link> Curse of dimensionality </a> </li> <li class=md-nav__item> <a href=../../R/EFA/ class=md-nav__link> Exploratory factor analysis (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Prediction algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prediction algorithms" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Prediction algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5_1 type=checkbox id=__nav_3_5_1> <label class=md-nav__link for=__nav_3_5_1> Classification Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Classification Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_5_1> <span class="md-nav__icon md-icon"></span> Classification Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/logistic-regression/ class=md-nav__link> Logistic Regression (R) </a> </li> <li class=md-nav__item> <a href=../../R/CHAID/ class=md-nav__link> CHAID Decision Trees (R) </a> </li> <li class=md-nav__item> <a href=../../R/CART-Classification/ class=md-nav__link> CART Classification (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5_2 type=checkbox id=__nav_3_5_2> <label class=md-nav__link for=__nav_3_5_2> Regression Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Regression Algorithms" data-md-level=3> <label class=md-nav__title for=__nav_3_5_2> <span class="md-nav__icon md-icon"></span> Regression Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/part-and-partial-corr/ class=md-nav__link> Part and partial correlation </a> </li> <li class=md-nav__item> <a href=../../R/Linear-regression/ class=md-nav__link> Linear Regression (R) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Preprocessing data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preprocessing data" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Preprocessing data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/KNN_Imputation/ class=md-nav__link> Null Value Imputation (R) </a> </li> <li class=md-nav__item> <a href=../Machine%20Learning%20Part%201/ class=md-nav__link> Feature engineering (Python) </a> </li> <li class=md-nav__item> <a href=../../R/Handling-Imbalanced-classes/ class=md-nav__link> Handling Imbalanced Classes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Machine Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Machine Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://harshaachyuthuni.shinyapps.io/Machine_Learning/ class=md-nav__link> Interactive Machine Learning (RShiny) </a> </li> <li class=md-nav__item> <a href=../ML%20using%20scikit-learn/ class=md-nav__link> ML using scikit-learn (Python) </a> </li> <li class=md-nav__item> <a href=../Demonstrating%20online%20learning/ class=md-nav__link> Streaming Machine Learning (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Time Series forecasting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Time Series forecasting" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Time Series forecasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/time-series/ class=md-nav__link> Introduction to stationarity (R) </a> </li> <li class=md-nav__item> <a href=../../R/Stationarity-tests/ class=md-nav__link> Stationary Tests (R) </a> </li> <li class=md-nav__item> <a href=../../R/ARIMA/ class=md-nav__link> ARIMA in R </a> </li> <li class=md-nav__item> <a href=../ARIMA%20Forecasting/ class=md-nav__link> ARIMA in Python </a> </li> <li class=md-nav__item> <a href=../../R/Seasonal-Time-Series/ class=md-nav__link> Seasonal time series (R) </a> </li> <li class=md-nav__item> <a href=../../R/VAR-models/ class=md-nav__link> VAR Models (R) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Deep learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deep learning" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Deep learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/ANN-1/ class=md-nav__link> Artificial Neural Network (Theory) </a> </li> <li class=md-nav__item> <a href=../../R/ANN2/ class=md-nav__link> The math behind ANN </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Prescriptive Analytics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Prescriptive Analytics" data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Prescriptive Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/Linear-programming/ class=md-nav__link> Linear Programming (R) </a> </li> <li class=md-nav__item> <a href=../../R/adoption_of_new_product/ class=md-nav__link> Adoption of new product (R) </a> </li> <li class=md-nav__item> <a href=../Diffusion%20on%20networks/ class=md-nav__link> Bass Forecasting model (Python) </a> </li> <li class=md-nav__item> <a href=../../Others/AHP/ class=md-nav__link> Analytic Hierarchy Process </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_11 type=checkbox id=__nav_3_11> <label class=md-nav__link for=__nav_3_11> Clustering <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Clustering data-md-level=2> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> Clustering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/hierarchical_clustering/ class=md-nav__link> Hierarchical Clustering </a> </li> <li class=md-nav__item> <a href=../../R/kMeansClustering/ class=md-nav__link> K-Means Clustering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_12 type=checkbox id=__nav_3_12> <label class=md-nav__link for=__nav_3_12> Reinforcement Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reinforcement Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Reinforcement Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../R/CustomerLifetimeValue/ class=md-nav__link> Customer Lifetime Value </a> </li> <li class=md-nav__item> <a href=../../R/recommendation-systems/ class=md-nav__link> Recommendation Systems </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_13 type=checkbox id=__nav_3_13 checked> <label class=md-nav__link for=__nav_3_13> Networks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networks data-md-level=2> <label class=md-nav__title for=__nav_3_13> <span class="md-nav__icon md-icon"></span> Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Introduction%20to%20Networkx/ class=md-nav__link> Introduction to NetworkX (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Science/ class=md-nav__link> Network Science (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20centrality/ class=md-nav__link> Network Centrality (Python) </a> </li> <li class=md-nav__item> <a href=../Shortest%20path%20problems/ class=md-nav__link> Shortest path using integer programming (Python) </a> </li> <li class=md-nav__item> <a href=../Network%20Flow%20problems/ class=md-nav__link> Network flow problems (Python) </a> </li> <li class=md-nav__item> <a href=../Community%20detection/ class=md-nav__link> Community detection (Python) </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Bipartite matching (Python) <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Bipartite matching (Python) </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#unweighted-bipartite-mapping class=md-nav__link> Unweighted bipartite mapping </a> <nav class=md-nav aria-label="Unweighted bipartite mapping"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#halls-theorem class=md-nav__link> Halls theorem </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#weighted-bipartite-mapping class=md-nav__link> Weighted bipartite mapping </a> </li> <li class=md-nav__item> <a href=#matching-with-preferences class=md-nav__link> Matching with preferences </a> <nav class=md-nav aria-label="Matching with preferences"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gale-shapley-algorithm class=md-nav__link> Gale Shapley Algorithm </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_14 type=checkbox id=__nav_3_14> <label class=md-nav__link for=__nav_3_14> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=2> <label class=md-nav__title for=__nav_3_14> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Machine%20learning%20as%20HTTP%20Request/ class=md-nav__link> ML deployment in Flask (Python) </a> </li> <li class=md-nav__item> <a href=../Saving%20predictions%20in%20database/ class=md-nav__link> Handling databases using python </a> </li> <li class=md-nav__item> <a href=../ORM/ class=md-nav__link> ORM (Python) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_15 type=checkbox id=__nav_3_15> <label class=md-nav__link for=__nav_3_15> Higher education review <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Higher education review" data-md-level=2> <label class=md-nav__title for=__nav_3_15> <span class="md-nav__icon md-icon"></span> Higher education review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/IIMB%20BAI/ class=md-nav__link> IIMB BAI </a> </li> <li class=md-nav__item> <a href=../../Others/part%20time%20data%20science%20masters/ class=md-nav__link> Part-time DS masters </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_16 type=checkbox id=__nav_3_16> <label class=md-nav__link for=__nav_3_16> External blogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="External blogs" data-md-level=2> <label class=md-nav__title for=__nav_3_16> <span class="md-nav__icon md-icon"></span> External blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Imperial%20College%20London/ class=md-nav__link> Imperial college London </a> </li> <li class=md-nav__item> <a href=../../Others/Rolls%20Royce/ class=md-nav__link> Rolls Royce </a> </li> <li class=md-nav__item> <a href=../../Others/Publications/ class=md-nav__link> Publications/conferences </a> </li> <li class=md-nav__item> <a href=../../Others/Deployed%20apps/ class=md-nav__link> Deployed apps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_17 type=checkbox id=__nav_3_17> <label class=md-nav__link for=__nav_3_17> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=__nav_3_17> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/Scarecrow/ class=md-nav__link> Scarecrow </a> </li> <li class=md-nav__item> <a href=../../Others/bid%20allocation%20model/ class=md-nav__link> Bid Allocation </a> </li> <li class=md-nav__item> <a href=../../Others/IIMB%20project/ class=md-nav__link> Reward and Recognition contests </a> </li> <li class=md-nav__item> <a href=../../Others/supply%20chain%20analytics/ class=md-nav__link> Supply chain analytics </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#unweighted-bipartite-mapping class=md-nav__link> Unweighted bipartite mapping </a> <nav class=md-nav aria-label="Unweighted bipartite mapping"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#halls-theorem class=md-nav__link> Halls theorem </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#weighted-bipartite-mapping class=md-nav__link> Weighted bipartite mapping </a> </li> <li class=md-nav__item> <a href=#matching-with-preferences class=md-nav__link> Matching with preferences </a> <nav class=md-nav aria-label="Matching with preferences"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gale-shapley-algorithm class=md-nav__link> Gale Shapley Algorithm </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=matching-algorithms>Matching algorithms<a class=headerlink href=#matching-algorithms title="Permanent link">&para;</a></h1> <p><strong>Author: Achyuthuni Sri Harsha</strong> <br> Stock markets, housing and labour markets, dating and so forth are examples of matching tasks. Let us take suppliers buyers as an example. In a matching problem, our job is to match the suppliers to buyers so that both sides/ either side are satisfied. </p> <p>Matching problems can be considered as network problems. In network terms, matching is a subset of edges where every node in one group goes through only one node in the other group. There should be only one edge from each node. </p> <div class=highlight><pre><span></span><code><span class=c1># Import networkx library and rename it as nx. </span>
<span class=kn>import</span> <span class=nn>networkx</span> <span class=k>as</span> <span class=nn>nx</span>

<span class=c1># Other packages required</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
<span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</code></pre></div> <h2 id=unweighted-bipartite-mapping>Unweighted bipartite mapping<a class=headerlink href=#unweighted-bipartite-mapping title="Permanent link">&para;</a></h2> <p>Let us take a simple example of mapping students and dorm rooms. In this problem, students give a list of rooms they are willing to stay at. We represent students on side as nodes of a bipartite graph and rooms on the other side as nodes, and we put an edge between students and rooms as per this list. </p> <p>We want to map students and rooms. Furthermore, we want to identify a subset where we match one student to exactly one other room (no roommates). The students give what rooms are acceptable, and many solutions are possible. Consider the below problem where we have students (A, B, C and D) and we want to match them to rooms (1,2,3,4). The list of acceptable rooms for each student is given below.</p> <div class=highlight><pre><span></span><code><span class=n>edgelist_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;node1&#39;</span><span class=p>:[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>],</span> <span class=s1>&#39;node2&#39;</span><span class=p>:[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>1</span><span class=p>]})</span>
<span class=n>edgelist_df</span>
</code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>node1</th> <th>node2</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>A</td> <td>1</td> </tr> <tr> <th>1</th> <td>A</td> <td>2</td> </tr> <tr> <th>2</th> <td>B</td> <td>2</td> </tr> <tr> <th>3</th> <td>B</td> <td>3</td> </tr> <tr> <th>4</th> <td>C</td> <td>3</td> </tr> <tr> <th>5</th> <td>C</td> <td>4</td> </tr> <tr> <th>6</th> <td>D</td> <td>4</td> </tr> <tr> <th>7</th> <td>D</td> <td>1</td> </tr> </tbody> </table> </div> <p>This can be represented as a bipartite graph as follows</p> <div class=highlight><pre><span></span><code><span class=n>g</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>Graph</span><span class=p>()</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>elrow</span> <span class=ow>in</span> <span class=n>edgelist_df</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
    <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>elrow</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>elrow</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>

<span class=c1># Make two sets in bipartite and get positions for the same</span>
<span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>bipartite</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>g</span><span class=p>)</span>

<span class=n>pos</span> <span class=o>=</span> <span class=p>{}</span>
<span class=c1># Update position for node from each group</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>left</span><span class=p>))):</span>
    <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>i</span><span class=p>))</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>right</span><span class=p>))):</span>
    <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>i</span><span class=p>))</span>

<span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>pos</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>),</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><img alt=png src=output_5_0.png></p> <p>Visually, we can find a couple of solutions, for example:<br> - A:1, B:2, C:3, D:4<br> - A:2, B:3, C:4, D:1 </p> <p>In large graphs visual analysis might be difficult, and in such situations Halls theorem is useful to identify if matching is possible. </p> <h3 id=halls-theorem>Halls theorem<a class=headerlink href=#halls-theorem title="Permanent link">&para;</a></h3> <p>But before Halls theorem, let us look at constricted set. <br> <strong>Constricted set</strong>: A constricted set is a subset of edges (on either side) whose neighbours are smaller than the subset. For example, if we have two students (subset of students) who give only one room (same room) in the list, then the size of the students is 2 and the size of the rooms is one, and no matching can be done.<br> Halls theorem states that for a mapping to exist, there should be no constricted set. </p> <p><strong>Augmenting paths</strong> 1. Select any random matching of unmatched nodes.<br> 2. Switch to the augmented paths if it exists. If it doesn't exist, then we have a constricted set, and we cannot do matching. <br> 3. Repeat until all left nodes are matched to one right node. </p> <p>This is implemented in NetworkX as follows:</p> <div class=highlight><pre><span></span><code><span class=c1># Select random edges</span>
<span class=n>selected_edges</span> <span class=o>=</span> <span class=p>[]</span>
<span class=k>for</span> <span class=n>left_node</span> <span class=ow>in</span> <span class=n>left</span><span class=p>:</span>
    <span class=c1># For a left node, select a random node in the right</span>
    <span class=n>list_of_nodes</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>edges</span><span class=p>(</span><span class=n>left_node</span><span class=p>))</span>
    <span class=n>random_node</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>list_of_nodes</span><span class=p>))</span>
    <span class=n>selected_edges</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>list_of_nodes</span><span class=p>[</span><span class=n>random_node</span><span class=p>])</span> 
<span class=n>selected_edges</span>
</code></pre></div> <div class=highlight><pre><span></span><code>[(&#39;D&#39;, 4), (&#39;C&#39;, 4), (&#39;A&#39;, 2), (&#39;B&#39;, 3)]
</code></pre></div> <p>Selected edges are shown in green</p> <div class=highlight><pre><span></span><code><span class=k>for</span> <span class=n>edge</span> <span class=ow>in</span> <span class=n>g</span><span class=o>.</span><span class=n>edges</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>edge</span> <span class=ow>in</span> <span class=n>selected_edges</span> <span class=ow>or</span> <span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=ow>in</span> <span class=n>selected_edges</span><span class=p>:</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;g&#39;</span><span class=p>,</span><span class=n>weight</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span><span class=n>weight</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
<span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>pos</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>),</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> 
        <span class=n>edge_color</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_edge_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;color&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</code></pre></div> <p><img alt=png src=output_9_0.png></p> <p>We can see that this is not matching as node C and D are mapped to 4. This can be resolved by moving through the augmented paths for the C-4 node. For the C-4 node, moving through the augmented path selects the C-3 and D-4 node. Following the same process with B-3 and A-3 nodes, we get: </p> <div class=highlight><pre><span></span><code><span class=n>selected_edges</span> <span class=o>=</span> <span class=p>{(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;A&#39;</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>),</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>),</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=s1>&#39;D&#39;</span><span class=p>)}</span>
<span class=k>for</span> <span class=n>edge</span> <span class=ow>in</span> <span class=n>g</span><span class=o>.</span><span class=n>edges</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>edge</span> <span class=ow>in</span> <span class=n>selected_edges</span> <span class=ow>or</span> <span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=ow>in</span> <span class=n>selected_edges</span><span class=p>:</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;g&#39;</span><span class=p>,</span><span class=n>weight</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span><span class=n>weight</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
<span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>pos</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>),</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> 
        <span class=n>edge_color</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_edge_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;color&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</code></pre></div> <p><img alt=png src=output_11_0.png></p> <p>The final mapping is shown in green</p> <div class=highlight><pre><span></span><code><span class=n>nx</span><span class=o>.</span><span class=n>algorithms</span><span class=o>.</span><span class=n>bipartite</span><span class=o>.</span><span class=n>matching</span><span class=o>.</span><span class=n>hopcroft_karp_matching</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>top_nodes</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>edgelist_df</span><span class=o>.</span><span class=n>node1</span><span class=p>)))</span>
</code></pre></div> <div class=highlight><pre><span></span><code>{&#39;D&#39;: 4, &#39;C&#39;: 3, &#39;B&#39;: 2, &#39;A&#39;: 1, 1: &#39;A&#39;, 2: &#39;B&#39;, 3: &#39;C&#39;, 4: &#39;D&#39;}
</code></pre></div> <h2 id=weighted-bipartite-mapping>Weighted bipartite mapping<a class=headerlink href=#weighted-bipartite-mapping title="Permanent link">&para;</a></h2> <p>In the previous problem, we tried to find a perfect matching in an unweighted graph. What if every edge in the graph has certain weight attached to it. The weights could be quality index (for student-dorm matching) or valuations in a market etc. Consider the suppliers-buyers example for a housing market as shown below. We have three suppliers, A, B and C and three buyers (x, y and z). The valuation for each of the sellers is also given. For example, buyer x values house A with 12, house B with 4 and house C with 2.</p> <div class=highlight><pre><span></span><code><span class=n>sellers</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>]</span>
<span class=n>buyers</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>]</span>
<span class=n>valuations_for_buyers</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>12</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>8</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>]]</span>
<span class=n>sellers_price</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>g</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>Graph</span><span class=p>()</span>
<span class=n>pos</span> <span class=o>=</span> <span class=p>{}</span>
<span class=c1># Update position for node from each group</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sellers</span><span class=p>):</span>
    <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>sellers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>buyers</span><span class=p>):</span>
    <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>

<span class=c1># Plot text for the buyers</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>buyer</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>buyers</span><span class=p>):</span>
    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>1.1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=o>=</span><span class=n>valuations_for_buyers</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>horizontalalignment</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>

<span class=c1># Plot text for the sellers</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>buyer</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>buyers</span><span class=p>):</span>
    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=o>=</span><span class=n>sellers_price</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>horizontalalignment</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>

<span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>pos</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>),</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><img alt=png src=output_16_0.png></p> <p>What we want to achieve is clearing of the market. Clearing happens when all houses are sold to one buyer, and every buyer bought one house. This can be done using an auction algorithm.<br> 1. Sellers quote a price <br> 2. Buyers calculate utility: Net valuation (payoff) = Gross Valuation - Price charged by seller<br> 3. Buyers select the object that has the highest payoff<br> 4. If the market is not cleared, the sellers who have more than one offer (overdetermined) will increase the price by one unit, and the process is repeated.</p> <div class=highlight><pre><span></span><code><span class=c1># Function to pick the supplier with the maximumm utility</span>
<span class=k>def</span> <span class=nf>match_to_maximum_utility</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>buyers</span><span class=p>,</span> <span class=n>valuation</span><span class=p>,</span> <span class=n>price</span><span class=p>):</span>
    <span class=n>max_utility_sellers</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>buyer_index</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)):</span>
        <span class=n>max_utility</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>for</span> <span class=n>seller_index</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>sellers</span><span class=p>)):</span>
            <span class=k>if</span><span class=p>(</span><span class=n>max_utility</span> <span class=o>&lt;</span> <span class=n>valuation</span><span class=p>[</span><span class=n>buyer_index</span><span class=p>][</span><span class=n>seller_index</span><span class=p>]</span> <span class=o>-</span> <span class=n>price</span><span class=p>[</span><span class=n>seller_index</span><span class=p>]):</span>
                <span class=n>max_utility</span> <span class=o>=</span> <span class=n>valuation</span><span class=p>[</span><span class=n>buyer_index</span><span class=p>][</span><span class=n>seller_index</span><span class=p>]</span><span class=o>-</span> <span class=n>price</span><span class=p>[</span><span class=n>seller_index</span><span class=p>]</span>
                <span class=n>max_utility_sellers</span><span class=p>[</span><span class=n>buyers</span><span class=p>[</span><span class=n>buyer_index</span><span class=p>]]</span> <span class=o>=</span> <span class=p>[</span><span class=n>sellers</span><span class=p>[</span><span class=n>seller_index</span><span class=p>]]</span>
            <span class=k>elif</span><span class=p>(</span><span class=n>max_utility</span> <span class=o>==</span> <span class=n>valuation</span><span class=p>[</span><span class=n>buyer_index</span><span class=p>][</span><span class=n>seller_index</span><span class=p>]</span> <span class=o>-</span> <span class=n>price</span><span class=p>[</span><span class=n>seller_index</span><span class=p>]):</span>
                <span class=n>max_utility_sellers</span><span class=p>[</span><span class=n>buyers</span><span class=p>[</span><span class=n>buyer_index</span><span class=p>]]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sellers</span><span class=p>[</span><span class=n>seller_index</span><span class=p>])</span>
    <span class=k>return</span> <span class=n>max_utility_sellers</span>
</code></pre></div> <p>Assuming that the initial price set by the seller is zero (scaled to zero - displayed beside the node), buyer <em>x</em> calculates the following utility:<br> - For A: 12-0 = 12<br> - For B: 4-0 = 4<br> - For C: 2-0 = 2<br> As the utility of A is the highest, <em>x</em> will choose A. Similarly, B and C will also choose A.</p> <div class=highlight><pre><span></span><code><span class=n>max_util</span> <span class=o>=</span> <span class=n>match_to_maximum_utility</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>buyers</span><span class=p>,</span> <span class=n>valuations_for_buyers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>)</span>
<span class=n>max_util</span>
</code></pre></div> <div class=highlight><pre><span></span><code>{&#39;x&#39;: [&#39;A&#39;], &#39;y&#39;: [&#39;A&#39;], &#39;z&#39;: [&#39;A&#39;]}
</code></pre></div> <p>Plotting the selection, we see that A is overdetermined.</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>plot_max_utility_graph</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>buyers</span><span class=p>,</span> <span class=n>valuations_for_buyers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>,</span> <span class=n>max_util</span><span class=p>):</span>
    <span class=n>g</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>Graph</span><span class=p>()</span>
    <span class=n>pos</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=c1># Update position for node from each group</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sellers</span><span class=p>):</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>sellers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>buyers</span><span class=p>):</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>

    <span class=c1># Make edges</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>values</span> <span class=ow>in</span> <span class=n>max_util</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>values</span><span class=p>:</span>
            <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=n>value</span><span class=p>)</span>

    <span class=c1># Plot text for the buyers</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>buyer</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>buyers</span><span class=p>):</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>1.1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=o>=</span><span class=n>valuations_for_buyers</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>horizontalalignment</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>

    <span class=c1># Plot text for the sellers</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>buyer</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>buyers</span><span class=p>):</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>buyers</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=o>=</span><span class=n>sellers_price</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>horizontalalignment</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>

    <span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>pos</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>),</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>plot_max_utility_graph</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>buyers</span><span class=p>,</span> <span class=n>valuations_for_buyers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>,</span> <span class=n>max_util</span><span class=p>)</span>
</code></pre></div> <p><img alt=png src=output_23_0.png></p> <p>For the overdetermined edge A, we increase the price by one unit.</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>get_overdetermined_edge_and_increase_price</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>,</span> <span class=n>max_util</span><span class=p>):</span>
    <span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
    <span class=n>counts</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>Counter</span><span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>max_util</span><span class=o>.</span><span class=n>values</span><span class=p>(),</span> <span class=p>[])))</span>
    <span class=n>over_determined_list</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>if</span><span class=p>(</span><span class=n>value</span><span class=o>&gt;</span><span class=mi>1</span><span class=p>):</span>
            <span class=n>over_determined_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
            <span class=n>sellers_price</span><span class=p>[</span><span class=n>sellers</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>key</span><span class=p>)]</span> <span class=o>+=</span> <span class=mi>1</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Nodes&#39;</span><span class=p>,</span> <span class=n>over_determined_list</span><span class=p>,</span> <span class=s1>&#39;are over determined. Added 1 to the price for the suppliers&#39;</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>counts</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>get_overdetermined_edge_and_increase_price</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>,</span> <span class=n>max_util</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Nodes [&#39;A&#39;] are over determined. Added 1 to the price for the suppliers





{&#39;A&#39;: 3}
</code></pre></div> <p>We then continue this process until the market is cleared.</p> <div class=highlight><pre><span></span><code><span class=n>no_of_sellers_selected</span> <span class=o>=</span> <span class=mi>0</span>
<span class=k>while</span><span class=p>(</span><span class=n>no_of_sellers_selected</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=n>sellers</span><span class=p>)):</span>
    <span class=n>max_util</span> <span class=o>=</span> <span class=n>match_to_maximum_utility</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>buyers</span><span class=p>,</span> <span class=n>valuations_for_buyers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>)</span>
    <span class=n>plot_max_utility_graph</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>buyers</span><span class=p>,</span> <span class=n>valuations_for_buyers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>,</span> <span class=n>max_util</span><span class=p>)</span>
    <span class=n>counts</span> <span class=o>=</span> <span class=n>get_overdetermined_edge_and_increase_price</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>sellers_price</span><span class=p>,</span> <span class=n>max_util</span><span class=p>)</span>
    <span class=n>no_of_sellers_selected</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>counts</span><span class=p>)</span> <span class=c1># need not always be the case, check    </span>
</code></pre></div> <p><img alt=png src=output_28_0.png></p> <div class=highlight><pre><span></span><code>Nodes [&#39;A&#39;] are over determined. Added 1 to the price for the suppliers
</code></pre></div> <p><img alt=png src=output_28_2.png></p> <div class=highlight><pre><span></span><code>Nodes [&#39;A&#39;, &#39;B&#39;] are over determined. Added 1 to the price for the suppliers
</code></pre></div> <p><img alt=png src=output_28_4.png></p> <div class=highlight><pre><span></span><code>Nodes [&#39;A&#39;, &#39;B&#39;] are over determined. Added 1 to the price for the suppliers
</code></pre></div> <p>We can see that for costs (A:3, B:1, C:0), the market can be cleared with buyer x choosing A, y choosing C and z choosing B. This is the maximum weight perfect matching.</p> <h2 id=matching-with-preferences>Matching with preferences<a class=headerlink href=#matching-with-preferences title="Permanent link">&para;</a></h2> <p>In the previous scenario, we had weights on the edges which indicated the utility. In this case we will look at matching where we have preferences in a ranked order. This is more natural way in many scenarios, like students' preference to universities/universities selecting students, dating scenarios etc. This was originally implemented by Al Roth for matching hospitals and residency. Our goal is to clear the market, but also have a stable matching. So, what is a stable matching? </p> <p><strong>Stable matching</strong>: Stability is an equilibrium when no pair on ether side has an incentive to deviate from the mapping. Let us understand this using an example. </p> <p>Take the dating scenario for example. On the left-hand side we have men and on the right-hand side we have women. All men rank women in strict order and all women rank men in strict order. In a stable matching, no pair of nodes (male-female) prefers each other to their currently assigned partners. </p> <h3 id=gale-shapley-algorithm>Gale Shapley Algorithm<a class=headerlink href=#gale-shapley-algorithm title="Permanent link">&para;</a></h3> <p>Let us say that are <em>n</em> players on both sides with males(m) on one side and women(w) on another side. The algorithm is as follows: <br> 1. Every unmatched male (m) proposes to their first preference available. <br> 2. If the proposed women (w) is unmatched, w accepts. If the women is already matched and the m has higher preference for w, w switches. Else, previous mapping remains.<br> 3. This process continues until there is stability </p> <p>Let's take an example with three males and three females. The preferences are mentioned at the side of the node in a list. For example, m2 has a preference w2, followed by w3 and then w1. Similarly, w2 has a preference of m3, followed by m1 and then m2.</p> <div class=highlight><pre><span></span><code><span class=n>males</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;m1&#39;</span><span class=p>,</span> <span class=s1>&#39;m2&#39;</span><span class=p>,</span> <span class=s1>&#39;m3&#39;</span><span class=p>]</span>
<span class=n>females</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;w1&#39;</span><span class=p>,</span> <span class=s1>&#39;w2&#39;</span><span class=p>,</span> <span class=s1>&#39;w3&#39;</span><span class=p>]</span>

<span class=n>male_preferences</span> <span class=o>=</span> <span class=p>[[</span><span class=s1>&#39;w1&#39;</span><span class=p>,</span> <span class=s1>&#39;w2&#39;</span><span class=p>,</span> <span class=s1>&#39;w3&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;w2&#39;</span><span class=p>,</span> <span class=s1>&#39;w3&#39;</span><span class=p>,</span> <span class=s1>&#39;w1&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;w2&#39;</span><span class=p>,</span> <span class=s1>&#39;w3&#39;</span><span class=p>,</span> <span class=s1>&#39;w1&#39;</span><span class=p>]]</span>
<span class=n>female_preferences</span> <span class=o>=</span> <span class=p>[[</span><span class=s1>&#39;m2&#39;</span><span class=p>,</span> <span class=s1>&#39;m3&#39;</span><span class=p>,</span> <span class=s1>&#39;m1&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;m3&#39;</span><span class=p>,</span> <span class=s1>&#39;m1&#39;</span><span class=p>,</span> <span class=s1>&#39;m2&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;m1&#39;</span><span class=p>,</span> <span class=s1>&#39;m2&#39;</span><span class=p>,</span> <span class=s1>&#39;m3&#39;</span><span class=p>]]</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>match_next_male</span><span class=p>(</span><span class=n>male_index</span><span class=p>,</span> <span class=n>males</span><span class=p>,</span> <span class=n>females</span><span class=p>,</span> <span class=n>male_preferences</span><span class=p>,</span> <span class=n>female_preferences</span><span class=p>):</span>
    <span class=k>for</span> <span class=n>female</span> <span class=ow>in</span> <span class=n>male_preferences</span><span class=p>[</span><span class=n>male_index</span><span class=p>]:</span>
        <span class=k>if</span><span class=p>(</span><span class=n>female</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>current_mapping</span><span class=o>.</span><span class=n>values</span><span class=p>()):</span>
            <span class=n>current_mapping</span><span class=p>[</span><span class=n>males</span><span class=p>[</span><span class=n>male_index</span><span class=p>]]</span> <span class=o>=</span> <span class=n>female</span>
            <span class=k>return</span> <span class=n>current_mapping</span>
        <span class=k>elif</span><span class=p>(</span><span class=n>female</span> <span class=ow>in</span> <span class=n>current_mapping</span><span class=o>.</span><span class=n>values</span><span class=p>()):</span>
            <span class=n>current_mapping_inverse</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>current_mapping</span><span class=o>.</span><span class=n>values</span><span class=p>(),</span><span class=n>current_mapping</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
            <span class=n>current_male_for_the_female</span> <span class=o>=</span> <span class=n>current_mapping_inverse</span><span class=p>[</span><span class=n>female</span><span class=p>]</span>
            <span class=k>if</span><span class=p>(</span><span class=n>female_preferences</span><span class=p>[</span><span class=n>males</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>current_male_for_the_female</span><span class=p>)]</span> <span class=o>&gt;</span> <span class=n>female_preferences</span><span class=p>[</span><span class=n>male_index</span><span class=p>]):</span>
                <span class=n>current_mapping</span><span class=p>[</span><span class=n>males</span><span class=p>[</span><span class=n>male_index</span><span class=p>]]</span> <span class=o>=</span> <span class=n>female</span>
                <span class=n>current_mapping</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>current_male_for_the_female</span><span class=p>)</span>
                <span class=k>return</span> <span class=n>current_mapping</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>plot_max_utility_graph</span><span class=p>(</span><span class=n>males</span><span class=p>,</span> <span class=n>females</span><span class=p>,</span> <span class=n>male_preferences</span><span class=p>,</span> <span class=n>female_preferences</span><span class=p>,</span> <span class=n>current_mapping</span><span class=p>):</span>
    <span class=n>g</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>Graph</span><span class=p>()</span>
    <span class=n>pos</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=c1># Update position for node from each group</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>males</span><span class=p>):</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>males</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>females</span><span class=p>):</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>node</span><span class=p>,</span><span class=n>pos</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>females</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>

    <span class=c1># Make edges</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>current_mapping</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>g</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=n>value</span><span class=p>)</span>

    <span class=c1># Plot text for the males</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>male</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>males</span><span class=p>):</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>males</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=o>=</span><span class=n>male_preferences</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>horizontalalignment</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>

    <span class=c1># Plot text for the females</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>female</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>females</span><span class=p>):</span>
        <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>1.1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>females</span><span class=p>)</span><span class=o>-</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=o>=</span><span class=n>female_preferences</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>horizontalalignment</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>

    <span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>pos</span><span class=o>=</span><span class=n>nx</span><span class=o>.</span><span class=n>get_node_attributes</span><span class=p>(</span><span class=n>g</span><span class=p>,</span><span class=s1>&#39;pos&#39;</span><span class=p>),</span> <span class=n>with_labels</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;_____________________________________________________________________________&#39;</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>current_mapping</span> <span class=o>=</span> <span class=p>{}</span>
<span class=k>while</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>current_mapping</span><span class=p>)</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=n>males</span><span class=p>)):</span>
    <span class=k>for</span> <span class=n>male_index</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>males</span><span class=p>)):</span>
        <span class=k>if</span><span class=p>(</span><span class=n>current_mapping</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>males</span><span class=p>[</span><span class=n>male_index</span><span class=p>])</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>):</span>
            <span class=n>current_mapping</span> <span class=o>=</span> <span class=n>match_next_male</span><span class=p>(</span><span class=n>male_index</span><span class=p>,</span> <span class=n>males</span><span class=p>,</span> <span class=n>females</span><span class=p>,</span> <span class=n>male_preferences</span><span class=p>,</span> <span class=n>female_preferences</span><span class=p>)</span>
            <span class=n>plot_max_utility_graph</span><span class=p>(</span><span class=n>males</span><span class=p>,</span> <span class=n>females</span><span class=p>,</span> <span class=n>male_preferences</span><span class=p>,</span> <span class=n>female_preferences</span><span class=p>,</span> <span class=n>current_mapping</span><span class=p>)</span>
</code></pre></div> <p><img alt=png src=output_34_0.png></p> <div class=highlight><pre><span></span><code>_____________________________________________________________________________
</code></pre></div> <p><img alt=png src=output_34_2.png></p> <div class=highlight><pre><span></span><code>_____________________________________________________________________________
</code></pre></div> <p><img alt=png src=output_34_4.png></p> <div class=highlight><pre><span></span><code>_____________________________________________________________________________
</code></pre></div> <p><img alt=png src=output_34_6.png></p> <div class=highlight><pre><span></span><code>_____________________________________________________________________________
</code></pre></div> <p>The process goes on as follows:<br> 1. m1 proposes to w1 as w1 has maximum rank and as w1 is unselected, w1 accepts. We create an edge between them. <br> 2. m2 proposes to w2 as w2 has maximum rank, and as w2 is unselected, w2 accepts. We create an edge between them. <br> 3. m3 also proposes to w2. As w2 is already selected, it checks the preference of the current selection (m2) to m3. As m3 has better preference, w2 switches from m2 to m3. The edge between m2 and w2 is removed and a new edge between m3 and w2 is created.<br> 4. m2 is currently unmapped, and selects the next best preference, which is w3. As w3 is unselected, w3 accepts.<br> 5. This clears the market and the process stops. This is stable mapping (from the men's side). </p> <p>These are the common matching techniques that exist.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <ol> <li>Markets and matching, Network Analytics module, Kalyan Talluri, MSc Business analytics, Imperial College London, Class 2020-22 </li> </ol> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../Community%20detection/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Community detection (Python)" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Community detection (Python) </div> </div> </a> <a href=../Machine%20learning%20as%20HTTP%20Request/ class="md-footer__link md-footer__link--next" aria-label="Next: ML deployment in Flask (Python)" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> ML deployment in Flask (Python) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2016 - 2021 Martin Donath </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/HarshaAsh target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/sri-harsha-achyuthuni/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.instagram.com/harsha_uni/ target=_blank rel=noopener title=www.instagram.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=https://www.facebook.com/sri.harsha.achyuthuni/ target=_blank rel=noopener title=www.facebook.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "header.autohide", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56838a2c.min.js></script> </body> </html>